<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>modm_data.pdf API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */@media (prefers-color-scheme:dark){pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}}</style>
    <style>/*! theme.css */@media (prefers-color-scheme:dark){:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../modm_data.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;modm_data</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#pdf-content-accessors">PDF Content Accessors</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#annotate_debug_info">annotate_debug_info</a>
            </li>
            <li>
                    <a class="class" href="#Document">Document</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Document.__init__">Document</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.destinations">destinations</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.toc">toc</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.identifier_permanent">identifier_permanent</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.identifier_changing">identifier_changing</a>
                        </li>
                        <li>
                                <a class="variable" href="#Document.page_count">page_count</a>
                        </li>
                        <li>
                                <a class="function" href="#Document.page">page</a>
                        </li>
                        <li>
                                <a class="function" href="#Document.pages">pages</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Page">Page</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Page.__init__">Page</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.index">index</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.number">number</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.width">width</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.height">height</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.rotation">rotation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.bbox">bbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.char_count">char_count</a>
                        </li>
                        <li>
                                <a class="function" href="#Page.char">char</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.chars">chars</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.objlinks">objlinks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.weblinks">weblinks</a>
                        </li>
                        <li>
                                <a class="function" href="#Page.chars_in_area">chars_in_area</a>
                        </li>
                        <li>
                                <a class="function" href="#Page.text_in_area">text_in_area</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.structures">structures</a>
                        </li>
                        <li>
                                <a class="function" href="#Page.find">find</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.paths">paths</a>
                        </li>
                        <li>
                                <a class="variable" href="#Page.images">images</a>
                        </li>
                        <li>
                                <a class="function" href="#Page.graphic_clusters">graphic_clusters</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Character">Character</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Character.__init__">Character</a>
                        </li>
                        <li>
                                <a class="class" href="#Character.RenderMode">Character.RenderMode</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.UNKNOWN">UNKNOWN</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.FILL">FILL</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.STROKE">STROKE</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.FILL_STROKE">FILL_STROKE</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.INVISIBLE">INVISIBLE</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.FILL_CLIP">FILL_CLIP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.STROKE_CLIP">STROKE_CLIP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.FILL_STROKE_CLIP">FILL_STROKE_CLIP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Character.RenderMode.CLIP">CLIP</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#Character.unicode">unicode</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.objlink">objlink</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.weblink">weblink</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.char">char</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.origin">origin</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.width">width</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.height">height</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.tbbox">tbbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.bbox">bbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.twidth">twidth</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.theight">theight</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.render_mode">render_mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.rotation">rotation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.size">size</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.weight">weight</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.fill">fill</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.stroke">stroke</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.font">font</a>
                        </li>
                        <li>
                                <a class="variable" href="#Character.flags">flags</a>
                        </li>
                        <li>
                                <a class="function" href="#Character.descr">descr</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Path">Path</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Path.__init__">Path</a>
                        </li>
                        <li>
                                <a class="class" href="#Path.Type">Path.Type</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="variable" href="#Path.Type.LINE">LINE</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Type.BEZIER">BEZIER</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Type.MOVE">MOVE</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#Path.Cap">Path.Cap</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="variable" href="#Path.Cap.BUTT">BUTT</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Cap.ROUND">ROUND</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Cap.PROJECTING_SQUARE">PROJECTING_SQUARE</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#Path.Join">Path.Join</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="variable" href="#Path.Join.MITER">MITER</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Join.ROUND">ROUND</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Path.Join.BEVEL">BEVEL</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#Path.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.matrix">matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.count">count</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.fill">fill</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.stroke">stroke</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.width">width</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.cap">cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.join">join</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.bbox">bbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.points">points</a>
                        </li>
                        <li>
                                <a class="variable" href="#Path.lines">lines</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Image">Image</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Image.__init__">Image</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.count">count</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.stroke">stroke</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.fill">fill</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.width">width</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.matrix">matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.bbox">bbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.points">points</a>
                        </li>
                        <li>
                                <a class="variable" href="#Image.lines">lines</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ObjLink">ObjLink</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ObjLink.__init__">ObjLink</a>
                        </li>
                        <li>
                                <a class="variable" href="#ObjLink.bbox">bbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#ObjLink.page_index">page_index</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WebLink">WebLink</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WebLink.__init__">WebLink</a>
                        </li>
                        <li>
                                <a class="variable" href="#WebLink.bbox_count">bbox_count</a>
                        </li>
                        <li>
                                <a class="variable" href="#WebLink.bboxes">bboxes</a>
                        </li>
                        <li>
                                <a class="variable" href="#WebLink.range">range</a>
                        </li>
                        <li>
                                <a class="variable" href="#WebLink.url">url</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Structure">Structure</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Structure.__init__">Structure</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.parent">parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.title">title</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.actual_text">actual_text</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.alt_text">alt_text</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.obj_type">obj_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.language">language</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.marked_ids">marked_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.attributes">attributes</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.child">child</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.children">children</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.descr">descr</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../modm_data.html">modm_data</a><wbr>.pdf    </h1>

                        <div class="docstring"><h1 id="pdf-content-accessors">PDF Content Accessors</h1>

<p>This module extends the pypdfium2 Python API with low-level accessors for
characters and graphics. Note that these modules support read-only access to
PDFs, since a lot of caching is used to speed up commonly accessed properties.</p>

<p>This module only contains formatting independent PDF access which is then
specialized in the vendor-specific <code><a href="pdf2html.html">modm_data.pdf2html</a></code> modules.</p>
</div>

                        <input id="mod-pdf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pdf-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="c1"># Copyright 2022, Niklas Hauser</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="c1"># SPDX-License-Identifier: MPL-2.0</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd"># PDF Content Accessors</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">This module extends the pypdfium2 Python API with low-level accessors for</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">characters and graphics. Note that these modules support read-only access to</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">PDFs, since a lot of caching is used to speed up commonly accessed properties.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">This module only contains formatting independent PDF access which is then</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">specialized in the vendor-specific `modm_data.pdf2html` modules.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="kn">from</span> <span class="nn">.document</span> <span class="kn">import</span> <span class="n">Document</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="kn">from</span> <span class="nn">.page</span> <span class="kn">import</span> <span class="n">Page</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span> <span class="nn">.character</span> <span class="kn">import</span> <span class="n">Character</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span> <span class="nn">.link</span> <span class="kn">import</span> <span class="n">ObjLink</span><span class="p">,</span> <span class="n">WebLink</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">from</span> <span class="nn">.path</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span> <span class="nn">.image</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span> <span class="nn">.render</span> <span class="kn">import</span> <span class="n">annotate_debug_info</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span> <span class="nn">.structure</span> <span class="kn">import</span> <span class="n">Structure</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="s2">&quot;annotate_debug_info&quot;</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="s2">&quot;Document&quot;</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="s2">&quot;Page&quot;</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="s2">&quot;Character&quot;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="s2">&quot;Path&quot;</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="s2">&quot;Image&quot;</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="s2">&quot;ObjLink&quot;</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="s2">&quot;WebLink&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;Structure&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="annotate_debug_info">
                            <input id="annotate_debug_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">annotate_debug_info</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">page</span><span class="p">:</span> <span class="n"><a href="#Page">Page</a></span>,</span><span class="param">	<span class="n">new_doc</span><span class="p">:</span> <span class="n">pypdfium2</span><span class="o">.</span><span class="n">_helpers</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">PdfDocument</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n">pypdfium2</span><span class="o">.</span><span class="n">_helpers</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">PdfDocument</span>:</span></span>

                <label class="view-source-button" for="annotate_debug_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#annotate_debug_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="annotate_debug_info-52"><a href="#annotate_debug_info-52"><span class="linenos"> 52</span></a><span class="k">def</span> <span class="nf">annotate_debug_info</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">,</span> <span class="n">new_doc</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfDocument</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfDocument</span><span class="p">:</span>
</span><span id="annotate_debug_info-53"><a href="#annotate_debug_info-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="annotate_debug_info-54"><a href="#annotate_debug_info-54"><span class="linenos"> 54</span></a><span class="sd">    Copies each page into a new or existing PDF document and overlays the internal information on top of the content.</span>
</span><span id="annotate_debug_info-55"><a href="#annotate_debug_info-55"><span class="linenos"> 55</span></a><span class="sd">    - Renders the bounding boxes in RED and origins in BLACK of all characters.</span>
</span><span id="annotate_debug_info-56"><a href="#annotate_debug_info-56"><span class="linenos"> 56</span></a><span class="sd">    - Renders the bounding boxes of web links in BLUE GREEN.</span>
</span><span id="annotate_debug_info-57"><a href="#annotate_debug_info-57"><span class="linenos"> 57</span></a><span class="sd">    - Renders the bounding boxes of object links in YELLOW GREEN.</span>
</span><span id="annotate_debug_info-58"><a href="#annotate_debug_info-58"><span class="linenos"> 58</span></a><span class="sd">    - Renders all graphics paths in BLUE.</span>
</span><span id="annotate_debug_info-59"><a href="#annotate_debug_info-59"><span class="linenos"> 59</span></a><span class="sd">    - Renders the bounding boxes of computed graphics clusters in CYAN.</span>
</span><span id="annotate_debug_info-60"><a href="#annotate_debug_info-60"><span class="linenos"> 60</span></a>
</span><span id="annotate_debug_info-61"><a href="#annotate_debug_info-61"><span class="linenos"> 61</span></a><span class="sd">    :param page: The page to be annotated.</span>
</span><span id="annotate_debug_info-62"><a href="#annotate_debug_info-62"><span class="linenos"> 62</span></a><span class="sd">    :param new_doc: The PDF document to copy the page to. If not provided, a new document is created.</span>
</span><span id="annotate_debug_info-63"><a href="#annotate_debug_info-63"><span class="linenos"> 63</span></a><span class="sd">    :param index: The index of the page in the new document.</span>
</span><span id="annotate_debug_info-64"><a href="#annotate_debug_info-64"><span class="linenos"> 64</span></a><span class="sd">    :return: The new document with the annotated page added.</span>
</span><span id="annotate_debug_info-65"><a href="#annotate_debug_info-65"><span class="linenos"> 65</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="annotate_debug_info-66"><a href="#annotate_debug_info-66"><span class="linenos"> 66</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">height</span>
</span><span id="annotate_debug_info-67"><a href="#annotate_debug_info-67"><span class="linenos"> 67</span></a>
</span><span id="annotate_debug_info-68"><a href="#annotate_debug_info-68"><span class="linenos"> 68</span></a>    <span class="k">if</span> <span class="n">new_doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="annotate_debug_info-69"><a href="#annotate_debug_info-69"><span class="linenos"> 69</span></a>        <span class="n">new_doc</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_CreateNewDocument</span><span class="p">()</span>
</span><span id="annotate_debug_info-70"><a href="#annotate_debug_info-70"><span class="linenos"> 70</span></a>    <span class="c1"># copy page over to new doc</span>
</span><span id="annotate_debug_info-71"><a href="#annotate_debug_info-71"><span class="linenos"> 71</span></a>    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_ImportPages</span><span class="p">(</span><span class="n">new_doc</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">),</span> <span class="n">index</span><span class="p">)</span>
</span><span id="annotate_debug_info-72"><a href="#annotate_debug_info-72"><span class="linenos"> 72</span></a>    <span class="n">new_page</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LoadPage</span><span class="p">(</span><span class="n">new_doc</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="annotate_debug_info-73"><a href="#annotate_debug_info-73"><span class="linenos"> 73</span></a>    <span class="n">rotation</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">rotation</span>
</span><span id="annotate_debug_info-74"><a href="#annotate_debug_info-74"><span class="linenos"> 74</span></a>
</span><span id="annotate_debug_info-75"><a href="#annotate_debug_info-75"><span class="linenos"> 75</span></a>    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
</span><span id="annotate_debug_info-76"><a href="#annotate_debug_info-76"><span class="linenos"> 76</span></a>        <span class="n">p0</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="annotate_debug_info-77"><a href="#annotate_debug_info-77"><span class="linenos"> 77</span></a>        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
</span><span id="annotate_debug_info-78"><a href="#annotate_debug_info-78"><span class="linenos"> 78</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_CreateNewPath</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="annotate_debug_info-79"><a href="#annotate_debug_info-79"><span class="linenos"> 79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="annotate_debug_info-80"><a href="#annotate_debug_info-80"><span class="linenos"> 80</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_CreateNewPath</span><span class="p">(</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="annotate_debug_info-81"><a href="#annotate_debug_info-81"><span class="linenos"> 81</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_SetStrokeColor</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">)</span>
</span><span id="annotate_debug_info-82"><a href="#annotate_debug_info-82"><span class="linenos"> 82</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_SetStrokeWidth</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
</span><span id="annotate_debug_info-83"><a href="#annotate_debug_info-83"><span class="linenos"> 83</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_SetLineJoin</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINEJOIN_ROUND</span><span class="p">)</span>
</span><span id="annotate_debug_info-84"><a href="#annotate_debug_info-84"><span class="linenos"> 84</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_SetLineCap</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINECAP_ROUND</span><span class="p">)</span>
</span><span id="annotate_debug_info-85"><a href="#annotate_debug_info-85"><span class="linenos"> 85</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_SetDrawMode</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="annotate_debug_info-86"><a href="#annotate_debug_info-86"><span class="linenos"> 86</span></a>        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span><span id="annotate_debug_info-87"><a href="#annotate_debug_info-87"><span class="linenos"> 87</span></a>            <span class="k">if</span> <span class="n">point</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">MOVE</span><span class="p">:</span>
</span><span id="annotate_debug_info-88"><a href="#annotate_debug_info-88"><span class="linenos"> 88</span></a>                <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
</span><span id="annotate_debug_info-89"><a href="#annotate_debug_info-89"><span class="linenos"> 89</span></a>                    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_MoveTo</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="annotate_debug_info-90"><a href="#annotate_debug_info-90"><span class="linenos"> 90</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="annotate_debug_info-91"><a href="#annotate_debug_info-91"><span class="linenos"> 91</span></a>                    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_MoveTo</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="annotate_debug_info-92"><a href="#annotate_debug_info-92"><span class="linenos"> 92</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="annotate_debug_info-93"><a href="#annotate_debug_info-93"><span class="linenos"> 93</span></a>                <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
</span><span id="annotate_debug_info-94"><a href="#annotate_debug_info-94"><span class="linenos"> 94</span></a>                    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_LineTo</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="annotate_debug_info-95"><a href="#annotate_debug_info-95"><span class="linenos"> 95</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="annotate_debug_info-96"><a href="#annotate_debug_info-96"><span class="linenos"> 96</span></a>                    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_LineTo</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="annotate_debug_info-97"><a href="#annotate_debug_info-97"><span class="linenos"> 97</span></a>        <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPage_InsertObject</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
</span><span id="annotate_debug_info-98"><a href="#annotate_debug_info-98"><span class="linenos"> 98</span></a>
</span><span id="annotate_debug_info-99"><a href="#annotate_debug_info-99"><span class="linenos"> 99</span></a>    <span class="k">for</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">graphic_clusters</span><span class="p">():</span>
</span><span id="annotate_debug_info-100"><a href="#annotate_debug_info-100"><span class="linenos">100</span></a>        <span class="n">_rect</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mh">0x00FFFF</span><span class="p">)</span>
</span><span id="annotate_debug_info-101"><a href="#annotate_debug_info-101"><span class="linenos">101</span></a>
</span><span id="annotate_debug_info-102"><a href="#annotate_debug_info-102"><span class="linenos">102</span></a>    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">objlinks</span><span class="p">:</span>
</span><span id="annotate_debug_info-103"><a href="#annotate_debug_info-103"><span class="linenos">103</span></a>        <span class="n">_rect</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mh">0x9ACD32</span><span class="p">)</span>
</span><span id="annotate_debug_info-104"><a href="#annotate_debug_info-104"><span class="linenos">104</span></a>
</span><span id="annotate_debug_info-105"><a href="#annotate_debug_info-105"><span class="linenos">105</span></a>    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">weblinks</span><span class="p">:</span>
</span><span id="annotate_debug_info-106"><a href="#annotate_debug_info-106"><span class="linenos">106</span></a>        <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">link</span><span class="o">.</span><span class="n">bboxes</span><span class="p">:</span>
</span><span id="annotate_debug_info-107"><a href="#annotate_debug_info-107"><span class="linenos">107</span></a>            <span class="n">_rect</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mh">0x00FF00</span><span class="p">)</span>
</span><span id="annotate_debug_info-108"><a href="#annotate_debug_info-108"><span class="linenos">108</span></a>
</span><span id="annotate_debug_info-109"><a href="#annotate_debug_info-109"><span class="linenos">109</span></a>    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">chars</span><span class="p">:</span>
</span><span id="annotate_debug_info-110"><a href="#annotate_debug_info-110"><span class="linenos">110</span></a>        <span class="n">color</span> <span class="o">=</span> <span class="mh">0x0000FF</span>
</span><span id="annotate_debug_info-111"><a href="#annotate_debug_info-111"><span class="linenos">111</span></a>        <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">:</span>
</span><span id="annotate_debug_info-112"><a href="#annotate_debug_info-112"><span class="linenos">112</span></a>            <span class="n">_rect</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mh">0xFF0000</span><span class="p">)</span>
</span><span id="annotate_debug_info-113"><a href="#annotate_debug_info-113"><span class="linenos">113</span></a>            <span class="n">_vline</span><span class="p">(</span>
</span><span id="annotate_debug_info-114"><a href="#annotate_debug_info-114"><span class="linenos">114</span></a>                <span class="n">new_page</span><span class="p">,</span>
</span><span id="annotate_debug_info-115"><a href="#annotate_debug_info-115"><span class="linenos">115</span></a>                <span class="n">rotation</span><span class="p">,</span>
</span><span id="annotate_debug_info-116"><a href="#annotate_debug_info-116"><span class="linenos">116</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="annotate_debug_info-117"><a href="#annotate_debug_info-117"><span class="linenos">117</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="annotate_debug_info-118"><a href="#annotate_debug_info-118"><span class="linenos">118</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="annotate_debug_info-119"><a href="#annotate_debug_info-119"><span class="linenos">119</span></a>                <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="annotate_debug_info-120"><a href="#annotate_debug_info-120"><span class="linenos">120</span></a>                <span class="n">stroke</span><span class="o">=</span><span class="mh">0xFF0000</span><span class="p">,</span>
</span><span id="annotate_debug_info-121"><a href="#annotate_debug_info-121"><span class="linenos">121</span></a>            <span class="p">)</span>
</span><span id="annotate_debug_info-122"><a href="#annotate_debug_info-122"><span class="linenos">122</span></a>            <span class="n">_hline</span><span class="p">(</span>
</span><span id="annotate_debug_info-123"><a href="#annotate_debug_info-123"><span class="linenos">123</span></a>                <span class="n">new_page</span><span class="p">,</span>
</span><span id="annotate_debug_info-124"><a href="#annotate_debug_info-124"><span class="linenos">124</span></a>                <span class="n">rotation</span><span class="p">,</span>
</span><span id="annotate_debug_info-125"><a href="#annotate_debug_info-125"><span class="linenos">125</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="annotate_debug_info-126"><a href="#annotate_debug_info-126"><span class="linenos">126</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="annotate_debug_info-127"><a href="#annotate_debug_info-127"><span class="linenos">127</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="annotate_debug_info-128"><a href="#annotate_debug_info-128"><span class="linenos">128</span></a>                <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="annotate_debug_info-129"><a href="#annotate_debug_info-129"><span class="linenos">129</span></a>                <span class="n">stroke</span><span class="o">=</span><span class="mh">0xFF0000</span><span class="p">,</span>
</span><span id="annotate_debug_info-130"><a href="#annotate_debug_info-130"><span class="linenos">130</span></a>            <span class="p">)</span>
</span><span id="annotate_debug_info-131"><a href="#annotate_debug_info-131"><span class="linenos">131</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="mh">0x000000</span>
</span><span id="annotate_debug_info-132"><a href="#annotate_debug_info-132"><span class="linenos">132</span></a>        <span class="n">_vline</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="annotate_debug_info-133"><a href="#annotate_debug_info-133"><span class="linenos">133</span></a>        <span class="n">_hline</span><span class="p">(</span><span class="n">new_page</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="annotate_debug_info-134"><a href="#annotate_debug_info-134"><span class="linenos">134</span></a>
</span><span id="annotate_debug_info-135"><a href="#annotate_debug_info-135"><span class="linenos">135</span></a>    <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPage_GenerateContent</span><span class="p">(</span><span class="n">new_page</span><span class="p">)</span>
</span><span id="annotate_debug_info-136"><a href="#annotate_debug_info-136"><span class="linenos">136</span></a>    <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_ClosePage</span><span class="p">(</span><span class="n">new_page</span><span class="p">)</span>
</span><span id="annotate_debug_info-137"><a href="#annotate_debug_info-137"><span class="linenos">137</span></a>    <span class="k">return</span> <span class="n">new_doc</span>
</span></pre></div>


            <div class="docstring"><p>Copies each page into a new or existing PDF document and overlays the internal information on top of the content.</p>

<ul>
<li>Renders the bounding boxes in RED and origins in BLACK of all characters.</li>
<li>Renders the bounding boxes of web links in BLUE GREEN.</li>
<li>Renders the bounding boxes of object links in YELLOW GREEN.</li>
<li>Renders all graphics paths in BLUE.</li>
<li>Renders the bounding boxes of computed graphics clusters in CYAN.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>page</strong>:  The page to be annotated.</li>
<li><strong>new_doc</strong>:  The PDF document to copy the page to. If not provided, a new document is created.</li>
<li><strong>index</strong>:  The index of the page in the new document.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The new document with the annotated page added.</p>
</blockquote>
</div>


                </section>
                <section id="Document">
                            <input id="Document-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Document</span><wbr>(<span class="base">pypdfium2._helpers.document.PdfDocument</span>):

                <label class="view-source-button" for="Document-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document-31"><a href="#Document-31"><span class="linenos"> 31</span></a><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfDocument</span><span class="p">):</span>
</span><span id="Document-32"><a href="#Document-32"><span class="linenos"> 32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document-33"><a href="#Document-33"><span class="linenos"> 33</span></a><span class="sd">    The PDF document is the root of the entire data structure and provides</span>
</span><span id="Document-34"><a href="#Document-34"><span class="linenos"> 34</span></a><span class="sd">    access to PDF metadata, the table of contents, as well as individual</span>
</span><span id="Document-35"><a href="#Document-35"><span class="linenos"> 35</span></a><span class="sd">    pages.</span>
</span><span id="Document-36"><a href="#Document-36"><span class="linenos"> 36</span></a>
</span><span id="Document-37"><a href="#Document-37"><span class="linenos"> 37</span></a><span class="sd">    You should extend from this class for a specific vendor to provide the</span>
</span><span id="Document-38"><a href="#Document-38"><span class="linenos"> 38</span></a><span class="sd">    correct page class from `page()` function.</span>
</span><span id="Document-39"><a href="#Document-39"><span class="linenos"> 39</span></a>
</span><span id="Document-40"><a href="#Document-40"><span class="linenos"> 40</span></a><span class="sd">    This class is a convenience wrapper with caching around the high-level APIs</span>
</span><span id="Document-41"><a href="#Document-41"><span class="linenos"> 41</span></a><span class="sd">    of pypdfium.</span>
</span><span id="Document-42"><a href="#Document-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Document-43"><a href="#Document-43"><span class="linenos"> 43</span></a>
</span><span id="Document-44"><a href="#Document-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">autoclose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Document-45"><a href="#Document-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document-46"><a href="#Document-46"><span class="linenos"> 46</span></a><span class="sd">        :param path: Path to the PDF to open.</span>
</span><span id="Document-47"><a href="#Document-47"><span class="linenos"> 47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document-48"><a href="#Document-48"><span class="linenos"> 48</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Document-49"><a href="#Document-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stem</span>
</span><span id="Document-50"><a href="#Document-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stem of the document file name&quot;&quot;&quot;</span>
</span><span id="Document-51"><a href="#Document-51"><span class="linenos"> 51</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="n">autoclose</span><span class="p">)</span>
</span><span id="Document-52"><a href="#Document-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="Document-53"><a href="#Document-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_cache</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="Document-54"><a href="#Document-54"><span class="linenos"> 54</span></a>        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Document-55"><a href="#Document-55"><span class="linenos"> 55</span></a>
</span><span id="Document-56"><a href="#Document-56"><span class="linenos"> 56</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document-57"><a href="#Document-57"><span class="linenos"> 57</span></a>    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Document-58"><a href="#Document-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PDF metadata dictionary.&quot;&quot;&quot;</span>
</span><span id="Document-59"><a href="#Document-59"><span class="linenos"> 59</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_dict</span><span class="p">()</span>
</span><span id="Document-60"><a href="#Document-60"><span class="linenos"> 60</span></a>
</span><span id="Document-61"><a href="#Document-61"><span class="linenos"> 61</span></a>    <span class="nd">@property</span>
</span><span id="Document-62"><a href="#Document-62"><span class="linenos"> 62</span></a>    <span class="k">def</span> <span class="nf">destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span id="Document-63"><a href="#Document-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yields (page 0-index, named destination) of the whole document.&quot;&quot;&quot;</span>
</span><span id="Document-64"><a href="#Document-64"><span class="linenos"> 64</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_CountNamedDests</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
</span><span id="Document-65"><a href="#Document-65"><span class="linenos"> 65</span></a>            <span class="n">length</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetNamedDest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Document-66"><a href="#Document-66"><span class="linenos"> 66</span></a>            <span class="n">clength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="Document-67"><a href="#Document-67"><span class="linenos"> 67</span></a>            <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Document-68"><a href="#Document-68"><span class="linenos"> 68</span></a>            <span class="n">dest</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetNamedDest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">cbuffer</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Document-69"><a href="#Document-69"><span class="linenos"> 69</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">cbuffer</span><span class="o">.</span><span class="n">raw</span><span class="p">[:</span> <span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Document-70"><a href="#Document-70"><span class="linenos"> 70</span></a>            <span class="n">page</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFDest_GetDestPageIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
</span><span id="Document-71"><a href="#Document-71"><span class="linenos"> 71</span></a>            <span class="k">yield</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="Document-72"><a href="#Document-72"><span class="linenos"> 72</span></a>
</span><span id="Document-73"><a href="#Document-73"><span class="linenos"> 73</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document-74"><a href="#Document-74"><span class="linenos"> 74</span></a>    <span class="k">def</span> <span class="nf">toc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfOutlineItem</span><span class="p">]:</span>
</span><span id="Document-75"><a href="#Document-75"><span class="linenos"> 75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document-76"><a href="#Document-76"><span class="linenos"> 76</span></a><span class="sd">        The table of content as a sorted list of outline items ensuring item has</span>
</span><span id="Document-77"><a href="#Document-77"><span class="linenos"> 77</span></a><span class="sd">        a page index by reusing the last one.</span>
</span><span id="Document-78"><a href="#Document-78"><span class="linenos"> 78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document-79"><a href="#Document-79"><span class="linenos"> 79</span></a>        <span class="n">tocs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Document-80"><a href="#Document-80"><span class="linenos"> 80</span></a>        <span class="c1"># Sometimes the TOC contains duplicates so we must use a set</span>
</span><span id="Document-81"><a href="#Document-81"><span class="linenos"> 81</span></a>        <span class="n">last_page_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Document-82"><a href="#Document-82"><span class="linenos"> 82</span></a>        <span class="k">for</span> <span class="n">toc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span>
</span><span id="Document-83"><a href="#Document-83"><span class="linenos"> 83</span></a>            <span class="n">outline</span> <span class="o">=</span> <span class="n">_OutlineItem</span><span class="p">(</span>
</span><span id="Document-84"><a href="#Document-84"><span class="linenos"> 84</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">level</span><span class="p">,</span>
</span><span id="Document-85"><a href="#Document-85"><span class="linenos"> 85</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="Document-86"><a href="#Document-86"><span class="linenos"> 86</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">is_closed</span><span class="p">,</span>
</span><span id="Document-87"><a href="#Document-87"><span class="linenos"> 87</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">n_kids</span><span class="p">,</span>
</span><span id="Document-88"><a href="#Document-88"><span class="linenos"> 88</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">page_index</span> <span class="ow">or</span> <span class="n">last_page_index</span><span class="p">,</span>
</span><span id="Document-89"><a href="#Document-89"><span class="linenos"> 89</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">view_mode</span><span class="p">,</span>
</span><span id="Document-90"><a href="#Document-90"><span class="linenos"> 90</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">view_pos</span><span class="p">,</span>
</span><span id="Document-91"><a href="#Document-91"><span class="linenos"> 91</span></a>            <span class="p">)</span>
</span><span id="Document-92"><a href="#Document-92"><span class="linenos"> 92</span></a>            <span class="n">last_page_index</span> <span class="o">=</span> <span class="n">toc</span><span class="o">.</span><span class="n">page_index</span> <span class="ow">or</span> <span class="n">last_page_index</span>
</span><span id="Document-93"><a href="#Document-93"><span class="linenos"> 93</span></a>            <span class="n">tocs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">outline</span><span class="p">)</span>
</span><span id="Document-94"><a href="#Document-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tocs</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">page_index</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">title</span><span class="p">)))</span>
</span><span id="Document-95"><a href="#Document-95"><span class="linenos"> 95</span></a>
</span><span id="Document-96"><a href="#Document-96"><span class="linenos"> 96</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document-97"><a href="#Document-97"><span class="linenos"> 97</span></a>    <span class="k">def</span> <span class="nf">identifier_permanent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Document-98"><a href="#Document-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The permanent file identifier.&quot;&quot;&quot;</span>
</span><span id="Document-99"><a href="#Document-99"><span class="linenos"> 99</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FILEIDTYPE_PERMANENT</span><span class="p">)</span>
</span><span id="Document-100"><a href="#Document-100"><span class="linenos">100</span></a>
</span><span id="Document-101"><a href="#Document-101"><span class="linenos">101</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document-102"><a href="#Document-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">identifier_changing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Document-103"><a href="#Document-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The changing file identifier.&quot;&quot;&quot;</span>
</span><span id="Document-104"><a href="#Document-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FILEIDTYPE_CHANGING</span><span class="p">)</span>
</span><span id="Document-105"><a href="#Document-105"><span class="linenos">105</span></a>
</span><span id="Document-106"><a href="#Document-106"><span class="linenos">106</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document-107"><a href="#Document-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="nf">page_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Document-108"><a href="#Document-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of pages in the document.&quot;&quot;&quot;</span>
</span><span id="Document-109"><a href="#Document-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetPageCount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Document-110"><a href="#Document-110"><span class="linenos">110</span></a>
</span><span id="Document-111"><a href="#Document-111"><span class="linenos">111</span></a>    <span class="nd">@cache</span>
</span><span id="Document-112"><a href="#Document-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
</span><span id="Document-113"><a href="#Document-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document-114"><a href="#Document-114"><span class="linenos">114</span></a><span class="sd">        :param index: 0-indexed page number.</span>
</span><span id="Document-115"><a href="#Document-115"><span class="linenos">115</span></a><span class="sd">        :return: the page object for the index.</span>
</span><span id="Document-116"><a href="#Document-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document-117"><a href="#Document-117"><span class="linenos">117</span></a>        <span class="k">assert</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_count</span>
</span><span id="Document-118"><a href="#Document-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="n">Page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="Document-119"><a href="#Document-119"><span class="linenos">119</span></a>
</span><span id="Document-120"><a href="#Document-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Page</span><span class="p">]:</span>
</span><span id="Document-121"><a href="#Document-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document-122"><a href="#Document-122"><span class="linenos">122</span></a><span class="sd">        :param numbers: an iterable range of page numbers (0-indexed!).</span>
</span><span id="Document-123"><a href="#Document-123"><span class="linenos">123</span></a><span class="sd">                        If `None`, then the whole page range is used.</span>
</span><span id="Document-124"><a href="#Document-124"><span class="linenos">124</span></a><span class="sd">        :return: yields each page in the range.</span>
</span><span id="Document-125"><a href="#Document-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document-126"><a href="#Document-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">numbers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Document-127"><a href="#Document-127"><span class="linenos">127</span></a>            <span class="n">numbers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span>
</span><span id="Document-128"><a href="#Document-128"><span class="linenos">128</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
</span><span id="Document-129"><a href="#Document-129"><span class="linenos">129</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_count</span><span class="p">:</span>
</span><span id="Document-130"><a href="#Document-130"><span class="linenos">130</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span><span id="Document-131"><a href="#Document-131"><span class="linenos">131</span></a>
</span><span id="Document-132"><a href="#Document-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Document-133"><a href="#Document-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Doc(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The PDF document is the root of the entire data structure and provides
access to PDF metadata, the table of contents, as well as individual
pages.</p>

<p>You should extend from this class for a specific vendor to provide the
correct page class from <code><a href="#Document.page">page()</a></code> function.</p>

<p>This class is a convenience wrapper with caching around the high-level APIs
of pypdfium.</p>
</div>


                            <div id="Document.__init__" class="classattr">
                                        <input id="Document.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Document</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>, </span><span class="param"><span class="n">autoclose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="Document.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.__init__-44"><a href="#Document.__init__-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">autoclose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Document.__init__-45"><a href="#Document.__init__-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document.__init__-46"><a href="#Document.__init__-46"><span class="linenos">46</span></a><span class="sd">        :param path: Path to the PDF to open.</span>
</span><span id="Document.__init__-47"><a href="#Document.__init__-47"><span class="linenos">47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document.__init__-48"><a href="#Document.__init__-48"><span class="linenos">48</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Document.__init__-49"><a href="#Document.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stem</span>
</span><span id="Document.__init__-50"><a href="#Document.__init__-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stem of the document file name&quot;&quot;&quot;</span>
</span><span id="Document.__init__-51"><a href="#Document.__init__-51"><span class="linenos">51</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="n">autoclose</span><span class="p">)</span>
</span><span id="Document.__init__-52"><a href="#Document.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="Document.__init__-53"><a href="#Document.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_cache</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="Document.__init__-54"><a href="#Document.__init__-54"><span class="linenos">54</span></a>        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>path</strong>:  Path to the PDF to open.</li>
</ul>
</div>


                            </div>
                            <div id="Document.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Document.name"></a>
    
            <div class="docstring"><p>Stem of the document file name</p>
</div>


                            </div>
                            <div id="Document.metadata" class="classattr">
                                        <input id="Document.metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">metadata</span><span class="annotation">: dict[str, str]</span>

                <label class="view-source-button" for="Document.metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.metadata-56"><a href="#Document.metadata-56"><span class="linenos">56</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document.metadata-57"><a href="#Document.metadata-57"><span class="linenos">57</span></a>    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Document.metadata-58"><a href="#Document.metadata-58"><span class="linenos">58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PDF metadata dictionary.&quot;&quot;&quot;</span>
</span><span id="Document.metadata-59"><a href="#Document.metadata-59"><span class="linenos">59</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_dict</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The PDF metadata dictionary.</p>
</div>


                            </div>
                            <div id="Document.destinations" class="classattr">
                                        <input id="Document.destinations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">destinations</span><span class="annotation">: Iterator[tuple[int, str]]</span>

                <label class="view-source-button" for="Document.destinations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.destinations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.destinations-61"><a href="#Document.destinations-61"><span class="linenos">61</span></a>    <span class="nd">@property</span>
</span><span id="Document.destinations-62"><a href="#Document.destinations-62"><span class="linenos">62</span></a>    <span class="k">def</span> <span class="nf">destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span id="Document.destinations-63"><a href="#Document.destinations-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yields (page 0-index, named destination) of the whole document.&quot;&quot;&quot;</span>
</span><span id="Document.destinations-64"><a href="#Document.destinations-64"><span class="linenos">64</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_CountNamedDests</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
</span><span id="Document.destinations-65"><a href="#Document.destinations-65"><span class="linenos">65</span></a>            <span class="n">length</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetNamedDest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Document.destinations-66"><a href="#Document.destinations-66"><span class="linenos">66</span></a>            <span class="n">clength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="Document.destinations-67"><a href="#Document.destinations-67"><span class="linenos">67</span></a>            <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Document.destinations-68"><a href="#Document.destinations-68"><span class="linenos">68</span></a>            <span class="n">dest</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetNamedDest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">cbuffer</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Document.destinations-69"><a href="#Document.destinations-69"><span class="linenos">69</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">cbuffer</span><span class="o">.</span><span class="n">raw</span><span class="p">[:</span> <span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Document.destinations-70"><a href="#Document.destinations-70"><span class="linenos">70</span></a>            <span class="n">page</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFDest_GetDestPageIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
</span><span id="Document.destinations-71"><a href="#Document.destinations-71"><span class="linenos">71</span></a>            <span class="k">yield</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Yields (page 0-index, named destination) of the whole document.</p>
</div>


                            </div>
                            <div id="Document.toc" class="classattr">
                                        <input id="Document.toc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">toc</span><span class="annotation">: list[pypdfium2._helpers.document.PdfOutlineItem]</span>

                <label class="view-source-button" for="Document.toc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.toc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.toc-73"><a href="#Document.toc-73"><span class="linenos">73</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document.toc-74"><a href="#Document.toc-74"><span class="linenos">74</span></a>    <span class="k">def</span> <span class="nf">toc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfOutlineItem</span><span class="p">]:</span>
</span><span id="Document.toc-75"><a href="#Document.toc-75"><span class="linenos">75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document.toc-76"><a href="#Document.toc-76"><span class="linenos">76</span></a><span class="sd">        The table of content as a sorted list of outline items ensuring item has</span>
</span><span id="Document.toc-77"><a href="#Document.toc-77"><span class="linenos">77</span></a><span class="sd">        a page index by reusing the last one.</span>
</span><span id="Document.toc-78"><a href="#Document.toc-78"><span class="linenos">78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document.toc-79"><a href="#Document.toc-79"><span class="linenos">79</span></a>        <span class="n">tocs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Document.toc-80"><a href="#Document.toc-80"><span class="linenos">80</span></a>        <span class="c1"># Sometimes the TOC contains duplicates so we must use a set</span>
</span><span id="Document.toc-81"><a href="#Document.toc-81"><span class="linenos">81</span></a>        <span class="n">last_page_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Document.toc-82"><a href="#Document.toc-82"><span class="linenos">82</span></a>        <span class="k">for</span> <span class="n">toc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span>
</span><span id="Document.toc-83"><a href="#Document.toc-83"><span class="linenos">83</span></a>            <span class="n">outline</span> <span class="o">=</span> <span class="n">_OutlineItem</span><span class="p">(</span>
</span><span id="Document.toc-84"><a href="#Document.toc-84"><span class="linenos">84</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">level</span><span class="p">,</span>
</span><span id="Document.toc-85"><a href="#Document.toc-85"><span class="linenos">85</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
</span><span id="Document.toc-86"><a href="#Document.toc-86"><span class="linenos">86</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">is_closed</span><span class="p">,</span>
</span><span id="Document.toc-87"><a href="#Document.toc-87"><span class="linenos">87</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">n_kids</span><span class="p">,</span>
</span><span id="Document.toc-88"><a href="#Document.toc-88"><span class="linenos">88</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">page_index</span> <span class="ow">or</span> <span class="n">last_page_index</span><span class="p">,</span>
</span><span id="Document.toc-89"><a href="#Document.toc-89"><span class="linenos">89</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">view_mode</span><span class="p">,</span>
</span><span id="Document.toc-90"><a href="#Document.toc-90"><span class="linenos">90</span></a>                <span class="n">toc</span><span class="o">.</span><span class="n">view_pos</span><span class="p">,</span>
</span><span id="Document.toc-91"><a href="#Document.toc-91"><span class="linenos">91</span></a>            <span class="p">)</span>
</span><span id="Document.toc-92"><a href="#Document.toc-92"><span class="linenos">92</span></a>            <span class="n">last_page_index</span> <span class="o">=</span> <span class="n">toc</span><span class="o">.</span><span class="n">page_index</span> <span class="ow">or</span> <span class="n">last_page_index</span>
</span><span id="Document.toc-93"><a href="#Document.toc-93"><span class="linenos">93</span></a>            <span class="n">tocs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">outline</span><span class="p">)</span>
</span><span id="Document.toc-94"><a href="#Document.toc-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tocs</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">page_index</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">title</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>The table of content as a sorted list of outline items ensuring item has
a page index by reusing the last one.</p>
</div>


                            </div>
                            <div id="Document.identifier_permanent" class="classattr">
                                        <input id="Document.identifier_permanent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">identifier_permanent</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Document.identifier_permanent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.identifier_permanent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.identifier_permanent-96"><a href="#Document.identifier_permanent-96"><span class="linenos">96</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document.identifier_permanent-97"><a href="#Document.identifier_permanent-97"><span class="linenos">97</span></a>    <span class="k">def</span> <span class="nf">identifier_permanent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Document.identifier_permanent-98"><a href="#Document.identifier_permanent-98"><span class="linenos">98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The permanent file identifier.&quot;&quot;&quot;</span>
</span><span id="Document.identifier_permanent-99"><a href="#Document.identifier_permanent-99"><span class="linenos">99</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FILEIDTYPE_PERMANENT</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The permanent file identifier.</p>
</div>


                            </div>
                            <div id="Document.identifier_changing" class="classattr">
                                        <input id="Document.identifier_changing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">identifier_changing</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Document.identifier_changing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.identifier_changing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.identifier_changing-101"><a href="#Document.identifier_changing-101"><span class="linenos">101</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document.identifier_changing-102"><a href="#Document.identifier_changing-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">identifier_changing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Document.identifier_changing-103"><a href="#Document.identifier_changing-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The changing file identifier.&quot;&quot;&quot;</span>
</span><span id="Document.identifier_changing-104"><a href="#Document.identifier_changing-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FILEIDTYPE_CHANGING</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The changing file identifier.</p>
</div>


                            </div>
                            <div id="Document.page_count" class="classattr">
                                        <input id="Document.page_count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">page_count</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Document.page_count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.page_count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.page_count-106"><a href="#Document.page_count-106"><span class="linenos">106</span></a>    <span class="nd">@cached_property</span>
</span><span id="Document.page_count-107"><a href="#Document.page_count-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="nf">page_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Document.page_count-108"><a href="#Document.page_count-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of pages in the document.&quot;&quot;&quot;</span>
</span><span id="Document.page_count-109"><a href="#Document.page_count-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_GetPageCount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The number of pages in the document.</p>
</div>


                            </div>
                            <div id="Document.page" class="classattr">
                                        <input id="Document.page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cache</div>

        <span class="def">def</span>
        <span class="name">page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Page">Page</a></span>:</span></span>

                <label class="view-source-button" for="Document.page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.page-111"><a href="#Document.page-111"><span class="linenos">111</span></a>    <span class="nd">@cache</span>
</span><span id="Document.page-112"><a href="#Document.page-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Page</span><span class="p">:</span>
</span><span id="Document.page-113"><a href="#Document.page-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document.page-114"><a href="#Document.page-114"><span class="linenos">114</span></a><span class="sd">        :param index: 0-indexed page number.</span>
</span><span id="Document.page-115"><a href="#Document.page-115"><span class="linenos">115</span></a><span class="sd">        :return: the page object for the index.</span>
</span><span id="Document.page-116"><a href="#Document.page-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document.page-117"><a href="#Document.page-117"><span class="linenos">117</span></a>        <span class="k">assert</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_count</span>
</span><span id="Document.page-118"><a href="#Document.page-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="n">Page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>index</strong>:  0-indexed page number.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>the page object for the index.</p>
</blockquote>
</div>


                            </div>
                            <div id="Document.pages" class="classattr">
                                        <input id="Document.pages-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pages</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">numbers</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Iterator</span><span class="p">[</span><span class="n"><a href="#Page">Page</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Document.pages-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Document.pages"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Document.pages-120"><a href="#Document.pages-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Page</span><span class="p">]:</span>
</span><span id="Document.pages-121"><a href="#Document.pages-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Document.pages-122"><a href="#Document.pages-122"><span class="linenos">122</span></a><span class="sd">        :param numbers: an iterable range of page numbers (0-indexed!).</span>
</span><span id="Document.pages-123"><a href="#Document.pages-123"><span class="linenos">123</span></a><span class="sd">                        If `None`, then the whole page range is used.</span>
</span><span id="Document.pages-124"><a href="#Document.pages-124"><span class="linenos">124</span></a><span class="sd">        :return: yields each page in the range.</span>
</span><span id="Document.pages-125"><a href="#Document.pages-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Document.pages-126"><a href="#Document.pages-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">numbers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Document.pages-127"><a href="#Document.pages-127"><span class="linenos">127</span></a>            <span class="n">numbers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span>
</span><span id="Document.pages-128"><a href="#Document.pages-128"><span class="linenos">128</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
</span><span id="Document.pages-129"><a href="#Document.pages-129"><span class="linenos">129</span></a>            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_count</span><span class="p">:</span>
</span><span id="Document.pages-130"><a href="#Document.pages-130"><span class="linenos">130</span></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>numbers</strong>:  an iterable range of page numbers (0-indexed!).
If <code>None</code>, then the whole page range is used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>yields each page in the range.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pypdfium2._helpers.document.PdfDocument</dt>
                                <dd id="Document.formenv" class="variable">formenv</dd>
                <dd id="Document.parent" class="variable">parent</dd>
                <dd id="Document.new" class="function">new</dd>
                <dd id="Document.init_forms" class="function">init_forms</dd>
                <dd id="Document.get_formtype" class="function">get_formtype</dd>
                <dd id="Document.get_pagemode" class="function">get_pagemode</dd>
                <dd id="Document.is_tagged" class="function">is_tagged</dd>
                <dd id="Document.save" class="function">save</dd>
                <dd id="Document.get_identifier" class="function">get_identifier</dd>
                <dd id="Document.get_version" class="function">get_version</dd>
                <dd id="Document.get_metadata_value" class="function">get_metadata_value</dd>
                <dd id="Document.METADATA_KEYS" class="variable">METADATA_KEYS</dd>
                <dd id="Document.get_metadata_dict" class="function">get_metadata_dict</dd>
                <dd id="Document.count_attachments" class="function">count_attachments</dd>
                <dd id="Document.get_attachment" class="function">get_attachment</dd>
                <dd id="Document.new_attachment" class="function">new_attachment</dd>
                <dd id="Document.del_attachment" class="function">del_attachment</dd>
                <dd id="Document.get_page" class="function">get_page</dd>
                <dd id="Document.new_page" class="function">new_page</dd>
                <dd id="Document.del_page" class="function">del_page</dd>
                <dd id="Document.import_pages" class="function">import_pages</dd>
                <dd id="Document.get_page_size" class="function">get_page_size</dd>
                <dd id="Document.get_page_label" class="function">get_page_label</dd>
                <dd id="Document.page_as_xobject" class="function">page_as_xobject</dd>
                <dd id="Document.get_toc" class="function">get_toc</dd>
                <dd id="Document.render" class="function">render</dd>

            </div>
            <div><dt>pypdfium2.internal.bases.AutoCloseable</dt>
                                <dd id="Document.close" class="function">close</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Page">
                            <input id="Page-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Page</span><wbr>(<span class="base">pypdfium2._helpers.page.PdfPage</span>):

                <label class="view-source-button" for="Page-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page-24"><a href="#Page-24"><span class="linenos"> 24</span></a><span class="k">class</span> <span class="nc">Page</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfPage</span><span class="p">):</span>
</span><span id="Page-25"><a href="#Page-25"><span class="linenos"> 25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page-26"><a href="#Page-26"><span class="linenos"> 26</span></a><span class="sd">    This class provides low-level access to graphics and characters of the page.</span>
</span><span id="Page-27"><a href="#Page-27"><span class="linenos"> 27</span></a><span class="sd">    It also fixes missing bounding boxes for rotates characters on page load,</span>
</span><span id="Page-28"><a href="#Page-28"><span class="linenos"> 28</span></a><span class="sd">    as well as allow searching for characters in an area instead of just text.</span>
</span><span id="Page-29"><a href="#Page-29"><span class="linenos"> 29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Page-30"><a href="#Page-30"><span class="linenos"> 30</span></a>
</span><span id="Page-31"><a href="#Page-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Document&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Page-32"><a href="#Page-32"><span class="linenos"> 32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page-33"><a href="#Page-33"><span class="linenos"> 33</span></a><span class="sd">        :param document: a PDF document.</span>
</span><span id="Page-34"><a href="#Page-34"><span class="linenos"> 34</span></a><span class="sd">        :param index: 0-index page number.</span>
</span><span id="Page-35"><a href="#Page-35"><span class="linenos"> 35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page-36"><a href="#Page-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="Page-37"><a href="#Page-37"><span class="linenos"> 37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;0-index page number.&quot;&quot;&quot;</span>
</span><span id="Page-38"><a href="#Page-38"><span class="linenos"> 38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Page-39"><a href="#Page-39"><span class="linenos"> 39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;1-index page number.&quot;&quot;&quot;</span>
</span><span id="Page-40"><a href="#Page-40"><span class="linenos"> 40</span></a>
</span><span id="Page-41"><a href="#Page-41"><span class="linenos"> 41</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LoadPage</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span> <span class="n">document</span><span class="p">,</span> <span class="n">document</span><span class="o">.</span><span class="n">formenv</span><span class="p">)</span>
</span><span id="Page-42"><a href="#Page-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_links</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page-43"><a href="#Page-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weblinks</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page-44"><a href="#Page-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Page-45"><a href="#Page-45"><span class="linenos"> 45</span></a>
</span><span id="Page-46"><a href="#Page-46"><span class="linenos"> 46</span></a>        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Page-47"><a href="#Page-47"><span class="linenos"> 47</span></a>
</span><span id="Page-48"><a href="#Page-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_textpage</span><span class="p">()</span>
</span><span id="Page-49"><a href="#Page-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_LoadWebLinks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">)</span>
</span><span id="Page-50"><a href="#Page-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_GetForPage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Page-51"><a href="#Page-51"><span class="linenos"> 51</span></a>        <span class="c1"># close them in reverse order</span>
</span><span id="Page-52"><a href="#Page-52"><span class="linenos"> 52</span></a>        <span class="n">weakref</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_Close</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">)</span>
</span><span id="Page-53"><a href="#Page-53"><span class="linenos"> 53</span></a>        <span class="n">weakref</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CloseWebLinks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span><span class="p">)</span>
</span><span id="Page-54"><a href="#Page-54"><span class="linenos"> 54</span></a>
</span><span id="Page-55"><a href="#Page-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_bboxes</span><span class="p">()</span>
</span><span id="Page-56"><a href="#Page-56"><span class="linenos"> 56</span></a>
</span><span id="Page-57"><a href="#Page-57"><span class="linenos"> 57</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-58"><a href="#Page-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Page-59"><a href="#Page-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page label.&quot;&quot;&quot;</span>
</span><span id="Page-60"><a href="#Page-60"><span class="linenos"> 60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">get_page_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="Page-61"><a href="#Page-61"><span class="linenos"> 61</span></a>
</span><span id="Page-62"><a href="#Page-62"><span class="linenos"> 62</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-63"><a href="#Page-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Page-64"><a href="#Page-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page width.&quot;&quot;&quot;</span>
</span><span id="Page-65"><a href="#Page-65"><span class="linenos"> 65</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
</span><span id="Page-66"><a href="#Page-66"><span class="linenos"> 66</span></a>
</span><span id="Page-67"><a href="#Page-67"><span class="linenos"> 67</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-68"><a href="#Page-68"><span class="linenos"> 68</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Page-69"><a href="#Page-69"><span class="linenos"> 69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page height.&quot;&quot;&quot;</span>
</span><span id="Page-70"><a href="#Page-70"><span class="linenos"> 70</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
</span><span id="Page-71"><a href="#Page-71"><span class="linenos"> 71</span></a>
</span><span id="Page-72"><a href="#Page-72"><span class="linenos"> 72</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-73"><a href="#Page-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Page-74"><a href="#Page-74"><span class="linenos"> 74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page rotation in degrees.&quot;&quot;&quot;</span>
</span><span id="Page-75"><a href="#Page-75"><span class="linenos"> 75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>
</span><span id="Page-76"><a href="#Page-76"><span class="linenos"> 76</span></a>
</span><span id="Page-77"><a href="#Page-77"><span class="linenos"> 77</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-78"><a href="#Page-78"><span class="linenos"> 78</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Page-79"><a href="#Page-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page bounding box.&quot;&quot;&quot;</span>
</span><span id="Page-80"><a href="#Page-80"><span class="linenos"> 80</span></a>        <span class="k">return</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">())</span>
</span><span id="Page-81"><a href="#Page-81"><span class="linenos"> 81</span></a>
</span><span id="Page-82"><a href="#Page-82"><span class="linenos"> 82</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-83"><a href="#Page-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">char_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Page-84"><a href="#Page-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The total count of characters.&quot;&quot;&quot;</span>
</span><span id="Page-85"><a href="#Page-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">count_chars</span><span class="p">()</span>
</span><span id="Page-86"><a href="#Page-86"><span class="linenos"> 86</span></a>
</span><span id="Page-87"><a href="#Page-87"><span class="linenos"> 87</span></a>    <span class="nd">@cache</span>
</span><span id="Page-88"><a href="#Page-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Character</span><span class="p">:</span>
</span><span id="Page-89"><a href="#Page-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;:return: The character at the 0-index.&quot;&quot;&quot;</span>
</span><span id="Page-90"><a href="#Page-90"><span class="linenos"> 90</span></a>        <span class="k">return</span> <span class="n">Character</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="Page-91"><a href="#Page-91"><span class="linenos"> 91</span></a>
</span><span id="Page-92"><a href="#Page-92"><span class="linenos"> 92</span></a>    <span class="nd">@property</span>
</span><span id="Page-93"><a href="#Page-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">chars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page-94"><a href="#Page-94"><span class="linenos"> 94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yields all characters.&quot;&quot;&quot;</span>
</span><span id="Page-95"><a href="#Page-95"><span class="linenos"> 95</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_count</span><span class="p">):</span>
</span><span id="Page-96"><a href="#Page-96"><span class="linenos"> 96</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span><span id="Page-97"><a href="#Page-97"><span class="linenos"> 97</span></a>
</span><span id="Page-98"><a href="#Page-98"><span class="linenos"> 98</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-99"><a href="#Page-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">objlinks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjLink</span><span class="p">]:</span>
</span><span id="Page-100"><a href="#Page-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All object links.&quot;&quot;&quot;</span>
</span><span id="Page-101"><a href="#Page-101"><span class="linenos">101</span></a>        <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-102"><a href="#Page-102"><span class="linenos">102</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Page-103"><a href="#Page-103"><span class="linenos">103</span></a>        <span class="n">link</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINK</span><span class="p">()</span>
</span><span id="Page-104"><a href="#Page-104"><span class="linenos">104</span></a>        <span class="k">while</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_Enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
</span><span id="Page-105"><a href="#Page-105"><span class="linenos">105</span></a>            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ObjLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">))</span>
</span><span id="Page-106"><a href="#Page-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">links</span>
</span><span id="Page-107"><a href="#Page-107"><span class="linenos">107</span></a>
</span><span id="Page-108"><a href="#Page-108"><span class="linenos">108</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-109"><a href="#Page-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">weblinks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">WebLink</span><span class="p">]:</span>
</span><span id="Page-110"><a href="#Page-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All web links.&quot;&quot;&quot;</span>
</span><span id="Page-111"><a href="#Page-111"><span class="linenos">111</span></a>        <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-112"><a href="#Page-112"><span class="linenos">112</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CountWebLinks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span><span class="p">)):</span>
</span><span id="Page-113"><a href="#Page-113"><span class="linenos">113</span></a>            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WebLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">))</span>
</span><span id="Page-114"><a href="#Page-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">links</span>
</span><span id="Page-115"><a href="#Page-115"><span class="linenos">115</span></a>
</span><span id="Page-116"><a href="#Page-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">chars_in_area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page-117"><a href="#Page-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page-118"><a href="#Page-118"><span class="linenos">118</span></a><span class="sd">        :param area: area to search for character in.</span>
</span><span id="Page-119"><a href="#Page-119"><span class="linenos">119</span></a><span class="sd">        :return: All characters found in the area.</span>
</span><span id="Page-120"><a href="#Page-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page-121"><a href="#Page-121"><span class="linenos">121</span></a>        <span class="n">found</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-122"><a href="#Page-122"><span class="linenos">122</span></a>        <span class="c1"># We perform binary searches of the lower and upper y-positions first</span>
</span><span id="Page-123"><a href="#Page-123"><span class="linenos">123</span></a>        <span class="c1"># lines are ordered by y-position</span>
</span><span id="Page-124"><a href="#Page-124"><span class="linenos">124</span></a>        <span class="n">ypositions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_charlines</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Page-125"><a href="#Page-125"><span class="linenos">125</span></a>        <span class="n">y_bottom</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">ypositions</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page-126"><a href="#Page-126"><span class="linenos">126</span></a>        <span class="n">y_top</span> <span class="o">=</span> <span class="n">bisect_right</span><span class="p">(</span><span class="n">ypositions</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">y_bottom</span><span class="p">)</span>
</span><span id="Page-127"><a href="#Page-127"><span class="linenos">127</span></a>
</span><span id="Page-128"><a href="#Page-128"><span class="linenos">128</span></a>        <span class="c1"># Then for every line we do another binary search for left and right</span>
</span><span id="Page-129"><a href="#Page-129"><span class="linenos">129</span></a>        <span class="k">for</span> <span class="n">ypos</span> <span class="ow">in</span> <span class="n">ypositions</span><span class="p">[</span><span class="n">y_bottom</span><span class="p">:</span><span class="n">y_top</span><span class="p">]:</span>
</span><span id="Page-130"><a href="#Page-130"><span class="linenos">130</span></a>            <span class="n">chars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_charlines</span><span class="p">[</span><span class="n">ypos</span><span class="p">]</span>
</span><span id="Page-131"><a href="#Page-131"><span class="linenos">131</span></a>            <span class="n">x_left</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Page-132"><a href="#Page-132"><span class="linenos">132</span></a>            <span class="n">x_right</span> <span class="o">=</span> <span class="n">bisect_right</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">x_left</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Page-133"><a href="#Page-133"><span class="linenos">133</span></a>            <span class="c1"># Finally we add all these characters</span>
</span><span id="Page-134"><a href="#Page-134"><span class="linenos">134</span></a>            <span class="n">found</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chars</span><span class="p">[</span><span class="n">x_left</span><span class="p">:</span><span class="n">x_right</span><span class="p">])</span>
</span><span id="Page-135"><a href="#Page-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">found</span>
</span><span id="Page-136"><a href="#Page-136"><span class="linenos">136</span></a>
</span><span id="Page-137"><a href="#Page-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">text_in_area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Page-138"><a href="#Page-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page-139"><a href="#Page-139"><span class="linenos">139</span></a><span class="sd">        :param area: area to search for text in.</span>
</span><span id="Page-140"><a href="#Page-140"><span class="linenos">140</span></a><span class="sd">        :return: Only the text found in the area.</span>
</span><span id="Page-141"><a href="#Page-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page-142"><a href="#Page-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_text_bounded</span><span class="p">(</span><span class="n">area</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span><span id="Page-143"><a href="#Page-143"><span class="linenos">143</span></a>
</span><span id="Page-144"><a href="#Page-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="Page-145"><a href="#Page-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">structures</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Structure</span><span class="p">]:</span>
</span><span id="Page-146"><a href="#Page-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PDF/UA tags.&quot;&quot;&quot;</span>
</span><span id="Page-147"><a href="#Page-147"><span class="linenos">147</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_CountChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">)</span>
</span><span id="Page-148"><a href="#Page-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span id="Page-149"><a href="#Page-149"><span class="linenos">149</span></a>            <span class="n">child</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_GetChildAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span>
</span><span id="Page-150"><a href="#Page-150"><span class="linenos">150</span></a>            <span class="k">yield</span> <span class="n">Structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
</span><span id="Page-151"><a href="#Page-151"><span class="linenos">151</span></a>
</span><span id="Page-152"><a href="#Page-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page-153"><a href="#Page-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page-154"><a href="#Page-154"><span class="linenos">154</span></a><span class="sd">        Searches for a match string as whole, consecutive words and yields the</span>
</span><span id="Page-155"><a href="#Page-155"><span class="linenos">155</span></a><span class="sd">        characters.</span>
</span><span id="Page-156"><a href="#Page-156"><span class="linenos">156</span></a>
</span><span id="Page-157"><a href="#Page-157"><span class="linenos">157</span></a><span class="sd">        :param string: The search string.</span>
</span><span id="Page-158"><a href="#Page-158"><span class="linenos">158</span></a><span class="sd">        :param case_sensitive: Ignore case if false.</span>
</span><span id="Page-159"><a href="#Page-159"><span class="linenos">159</span></a><span class="sd">        :return: yields the characters found.</span>
</span><span id="Page-160"><a href="#Page-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page-161"><a href="#Page-161"><span class="linenos">161</span></a>        <span class="n">searcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="n">case_sensitive</span><span class="p">,</span> <span class="n">match_whole_word</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">consecutive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Page-162"><a href="#Page-162"><span class="linenos">162</span></a>        <span class="k">while</span> <span class="n">idx</span> <span class="o">:=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">get_next</span><span class="p">():</span>
</span><span id="Page-163"><a href="#Page-163"><span class="linenos">163</span></a>            <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="Page-164"><a href="#Page-164"><span class="linenos">164</span></a>            <span class="k">yield</span> <span class="n">chars</span>
</span><span id="Page-165"><a href="#Page-165"><span class="linenos">165</span></a>
</span><span id="Page-166"><a href="#Page-166"><span class="linenos">166</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-167"><a href="#Page-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
</span><span id="Page-168"><a href="#Page-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All paths.&quot;&quot;&quot;</span>
</span><span id="Page-169"><a href="#Page-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_objects</span><span class="p">([</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span><span class="p">])]</span>
</span><span id="Page-170"><a href="#Page-170"><span class="linenos">170</span></a>
</span><span id="Page-171"><a href="#Page-171"><span class="linenos">171</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-172"><a href="#Page-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Image</span><span class="p">]:</span>
</span><span id="Page-173"><a href="#Page-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All images.&quot;&quot;&quot;</span>
</span><span id="Page-174"><a href="#Page-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">Image</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_objects</span><span class="p">([</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span><span class="p">])]</span>
</span><span id="Page-175"><a href="#Page-175"><span class="linenos">175</span></a>
</span><span id="Page-176"><a href="#Page-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">graphic_clusters</span><span class="p">(</span>
</span><span id="Page-177"><a href="#Page-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Path</span> <span class="o">|</span> <span class="n">Image</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page-178"><a href="#Page-178"><span class="linenos">178</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]]]:</span>
</span><span id="Page-179"><a href="#Page-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">absolute_tolerance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Page-180"><a href="#Page-180"><span class="linenos">180</span></a>            <span class="n">absolute_tolerance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>
</span><span id="Page-181"><a href="#Page-181"><span class="linenos">181</span></a>
</span><span id="Page-182"><a href="#Page-182"><span class="linenos">182</span></a>        <span class="c1"># First collect all vertical regions</span>
</span><span id="Page-183"><a href="#Page-183"><span class="linenos">183</span></a>        <span class="n">filtered_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-184"><a href="#Page-184"><span class="linenos">184</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
</span><span id="Page-185"><a href="#Page-185"><span class="linenos">185</span></a>            <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">predicate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="Page-186"><a href="#Page-186"><span class="linenos">186</span></a>                <span class="n">filtered_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page-187"><a href="#Page-187"><span class="linenos">187</span></a>        <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">:</span>
</span><span id="Page-188"><a href="#Page-188"><span class="linenos">188</span></a>            <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">predicate</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
</span><span id="Page-189"><a href="#Page-189"><span class="linenos">189</span></a>                <span class="n">filtered_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Page-190"><a href="#Page-190"><span class="linenos">190</span></a>
</span><span id="Page-191"><a href="#Page-191"><span class="linenos">191</span></a>        <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-192"><a href="#Page-192"><span class="linenos">192</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
</span><span id="Page-193"><a href="#Page-193"><span class="linenos">193</span></a>            <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page-194"><a href="#Page-194"><span class="linenos">194</span></a>                <span class="k">if</span> <span class="n">reg</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page-195"><a href="#Page-195"><span class="linenos">195</span></a>                    <span class="c1"># They overlap, so merge them</span>
</span><span id="Page-196"><a href="#Page-196"><span class="linenos">196</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page-197"><a href="#Page-197"><span class="linenos">197</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">v1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span><span id="Page-198"><a href="#Page-198"><span class="linenos">198</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page-199"><a href="#Page-199"><span class="linenos">199</span></a>                    <span class="k">break</span>
</span><span id="Page-200"><a href="#Page-200"><span class="linenos">200</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Page-201"><a href="#Page-201"><span class="linenos">201</span></a>                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Region</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="Page-202"><a href="#Page-202"><span class="linenos">202</span></a>
</span><span id="Page-203"><a href="#Page-203"><span class="linenos">203</span></a>        <span class="c1"># Now collect horizontal region inside each vertical region</span>
</span><span id="Page-204"><a href="#Page-204"><span class="linenos">204</span></a>        <span class="k">for</span> <span class="n">yreg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page-205"><a href="#Page-205"><span class="linenos">205</span></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
</span><span id="Page-206"><a href="#Page-206"><span class="linenos">206</span></a>                <span class="c1"># check if horizontal line is contained in vregion</span>
</span><span id="Page-207"><a href="#Page-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="n">yreg</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page-208"><a href="#Page-208"><span class="linenos">208</span></a>                    <span class="k">for</span> <span class="n">xreg</span> <span class="ow">in</span> <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">:</span>
</span><span id="Page-209"><a href="#Page-209"><span class="linenos">209</span></a>                        <span class="k">if</span> <span class="n">xreg</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page-210"><a href="#Page-210"><span class="linenos">210</span></a>                            <span class="c1"># They overlap so merge them</span>
</span><span id="Page-211"><a href="#Page-211"><span class="linenos">211</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span><span id="Page-212"><a href="#Page-212"><span class="linenos">212</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">v1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span><span id="Page-213"><a href="#Page-213"><span class="linenos">213</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page-214"><a href="#Page-214"><span class="linenos">214</span></a>                            <span class="k">break</span>
</span><span id="Page-215"><a href="#Page-215"><span class="linenos">215</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Page-216"><a href="#Page-216"><span class="linenos">216</span></a>                        <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Region</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="Page-217"><a href="#Page-217"><span class="linenos">217</span></a>
</span><span id="Page-218"><a href="#Page-218"><span class="linenos">218</span></a>        <span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-219"><a href="#Page-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">yreg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page-220"><a href="#Page-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">xreg</span> <span class="ow">in</span> <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">:</span>
</span><span id="Page-221"><a href="#Page-221"><span class="linenos">221</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Page-222"><a href="#Page-222"><span class="linenos">222</span></a>                    <span class="c1"># Strip down the height again for subregions</span>
</span><span id="Page-223"><a href="#Page-223"><span class="linenos">223</span></a>                    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Page-224"><a href="#Page-224"><span class="linenos">224</span></a>                    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="p">:</span>
</span><span id="Page-225"><a href="#Page-225"><span class="linenos">225</span></a>                        <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page-226"><a href="#Page-226"><span class="linenos">226</span></a>                        <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span><span id="Page-227"><a href="#Page-227"><span class="linenos">227</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Page-228"><a href="#Page-228"><span class="linenos">228</span></a>                    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">yreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">yreg</span><span class="o">.</span><span class="n">v1</span>
</span><span id="Page-229"><a href="#Page-229"><span class="linenos">229</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">xreg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="Page-230"><a href="#Page-230"><span class="linenos">230</span></a>                <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bbox</span><span class="p">,</span> <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="p">))</span>
</span><span id="Page-231"><a href="#Page-231"><span class="linenos">231</span></a>
</span><span id="Page-232"><a href="#Page-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
</span><span id="Page-233"><a href="#Page-233"><span class="linenos">233</span></a>
</span><span id="Page-234"><a href="#Page-234"><span class="linenos">234</span></a>    <span class="k">def</span> <span class="nf">_link_characters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Page-235"><a href="#Page-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span><span class="p">:</span>
</span><span id="Page-236"><a href="#Page-236"><span class="linenos">236</span></a>            <span class="k">return</span>
</span><span id="Page-237"><a href="#Page-237"><span class="linenos">237</span></a>        <span class="c1"># The in-document links only gives us rectangles and we must find the</span>
</span><span id="Page-238"><a href="#Page-238"><span class="linenos">238</span></a>        <span class="c1"># linked chars ourselves</span>
</span><span id="Page-239"><a href="#Page-239"><span class="linenos">239</span></a>        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objlinks</span><span class="p">:</span>
</span><span id="Page-240"><a href="#Page-240"><span class="linenos">240</span></a>            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chars_in_area</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">bbox</span><span class="p">):</span>
</span><span id="Page-241"><a href="#Page-241"><span class="linenos">241</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">objlink</span> <span class="o">=</span> <span class="n">link</span>
</span><span id="Page-242"><a href="#Page-242"><span class="linenos">242</span></a>        <span class="c1"># The weblinks give you an explicit char range, very convenient</span>
</span><span id="Page-243"><a href="#Page-243"><span class="linenos">243</span></a>        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weblinks</span><span class="p">:</span>
</span><span id="Page-244"><a href="#Page-244"><span class="linenos">244</span></a>            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">link</span><span class="o">.</span><span class="n">range</span><span class="p">):</span>
</span><span id="Page-245"><a href="#Page-245"><span class="linenos">245</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">.</span><span class="n">weblink</span> <span class="o">=</span> <span class="n">link</span>
</span><span id="Page-246"><a href="#Page-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Page-247"><a href="#Page-247"><span class="linenos">247</span></a>
</span><span id="Page-248"><a href="#Page-248"><span class="linenos">248</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page-249"><a href="#Page-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="nf">_charlines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Page-250"><a href="#Page-250"><span class="linenos">250</span></a>        <span class="n">charlines</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="Page-251"><a href="#Page-251"><span class="linenos">251</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chars</span><span class="p">:</span>
</span><span id="Page-252"><a href="#Page-252"><span class="linenos">252</span></a>            <span class="n">charlines</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</span><span id="Page-253"><a href="#Page-253"><span class="linenos">253</span></a>
</span><span id="Page-254"><a href="#Page-254"><span class="linenos">254</span></a>        <span class="n">orderedchars</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">charlines</span><span class="p">))</span>
</span><span id="Page-255"><a href="#Page-255"><span class="linenos">255</span></a>        <span class="k">for</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">chars</span> <span class="ow">in</span> <span class="n">charlines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Page-256"><a href="#Page-256"><span class="linenos">256</span></a>            <span class="n">orderedchars</span><span class="p">[</span><span class="n">ypos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Page-257"><a href="#Page-257"><span class="linenos">257</span></a>
</span><span id="Page-258"><a href="#Page-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="n">orderedchars</span>
</span><span id="Page-259"><a href="#Page-259"><span class="linenos">259</span></a>
</span><span id="Page-260"><a href="#Page-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">_fix_bboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Page-261"><a href="#Page-261"><span class="linenos">261</span></a>        <span class="k">def</span> <span class="nf">_key</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
</span><span id="Page-262"><a href="#Page-262"><span class="linenos">262</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Page-263"><a href="#Page-263"><span class="linenos">263</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Page-264"><a href="#Page-264"><span class="linenos">264</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">char</span><span class="o">.</span><span class="n">font</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">char</span><span class="o">.</span><span class="n">unicode</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Page-265"><a href="#Page-265"><span class="linenos">265</span></a>
</span><span id="Page-266"><a href="#Page-266"><span class="linenos">266</span></a>        <span class="n">fix_chars</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page-267"><a href="#Page-267"><span class="linenos">267</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chars</span><span class="p">:</span>
</span><span id="Page-268"><a href="#Page-268"><span class="linenos">268</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
</span><span id="Page-269"><a href="#Page-269"><span class="linenos">269</span></a>                <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">_rotation</span><span class="p">:</span>
</span><span id="Page-270"><a href="#Page-270"><span class="linenos">270</span></a>                    <span class="n">fix_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</span><span id="Page-271"><a href="#Page-271"><span class="linenos">271</span></a>                <span class="k">elif</span> <span class="n">char</span><span class="o">.</span><span class="n">unicode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mh">0xA</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">}:</span>
</span><span id="Page-272"><a href="#Page-272"><span class="linenos">272</span></a>                    <span class="n">fix_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</span><span id="Page-273"><a href="#Page-273"><span class="linenos">273</span></a>            <span class="k">elif</span> <span class="n">char</span><span class="o">.</span><span class="n">unicode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mh">0xA</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">}</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">_rotation</span> <span class="ow">and</span> <span class="n">_key</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">_bbox_cache</span><span class="p">:</span>
</span><span id="Page-274"><a href="#Page-274"><span class="linenos">274</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">char</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">translated</span><span class="p">(</span><span class="o">-</span><span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span><span class="o">.</span><span class="n">rotated</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">+</span> <span class="n">char</span><span class="o">.</span><span class="n">_rotation</span><span class="p">)</span>
</span><span id="Page-275"><a href="#Page-275"><span class="linenos">275</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">_bbox_cache</span><span class="p">[</span><span class="n">_key</span><span class="p">(</span><span class="n">char</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</span><span id="Page-276"><a href="#Page-276"><span class="linenos">276</span></a>                <span class="c1"># print(&quot;-&gt;&quot;, _key(char), char.descr(), char.height, char.rotation, char._rotation, self.rotation)</span>
</span><span id="Page-277"><a href="#Page-277"><span class="linenos">277</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">fix_chars</span><span class="p">:</span>
</span><span id="Page-278"><a href="#Page-278"><span class="linenos">278</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">_bbox_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_key</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>
</span><span id="Page-279"><a href="#Page-279"><span class="linenos">279</span></a>            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Page-280"><a href="#Page-280"><span class="linenos">280</span></a>                <span class="c1"># print(&quot;&lt;-&quot;, char.descr(), char._rotation, char.rotation, char.height)</span>
</span><span id="Page-281"><a href="#Page-281"><span class="linenos">281</span></a>                <span class="n">_</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span>
</span><span id="Page-282"><a href="#Page-282"><span class="linenos">282</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">rotated</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">-</span> <span class="n">char</span><span class="o">.</span><span class="n">_rotation</span><span class="p">)</span><span class="o">.</span><span class="n">translated</span><span class="p">(</span><span class="n">char</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
</span><span id="Page-283"><a href="#Page-283"><span class="linenos">283</span></a>                <span class="n">char</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">bbox</span>
</span><span id="Page-284"><a href="#Page-284"><span class="linenos">284</span></a>            <span class="k">elif</span> <span class="n">char</span><span class="o">.</span><span class="n">unicode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">}:</span>
</span><span id="Page-285"><a href="#Page-285"><span class="linenos">285</span></a>                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to fix bbox for </span><span class="si">{</span><span class="n">char</span><span class="o">.</span><span class="n">descr</span><span class="p">()</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This class provides low-level access to graphics and characters of the page.
It also fixes missing bounding boxes for rotates characters on page load,
as well as allow searching for characters in an area instead of just text.</p>
</div>


                            <div id="Page.__init__" class="classattr">
                                        <input id="Page.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Page</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">document</span><span class="p">:</span> <span class="n"><a href="#Document">Document</a></span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Page.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.__init__-31"><a href="#Page.__init__-31"><span class="linenos">31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Document&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Page.__init__-32"><a href="#Page.__init__-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page.__init__-33"><a href="#Page.__init__-33"><span class="linenos">33</span></a><span class="sd">        :param document: a PDF document.</span>
</span><span id="Page.__init__-34"><a href="#Page.__init__-34"><span class="linenos">34</span></a><span class="sd">        :param index: 0-index page number.</span>
</span><span id="Page.__init__-35"><a href="#Page.__init__-35"><span class="linenos">35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page.__init__-36"><a href="#Page.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="Page.__init__-37"><a href="#Page.__init__-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;0-index page number.&quot;&quot;&quot;</span>
</span><span id="Page.__init__-38"><a href="#Page.__init__-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Page.__init__-39"><a href="#Page.__init__-39"><span class="linenos">39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;1-index page number.&quot;&quot;&quot;</span>
</span><span id="Page.__init__-40"><a href="#Page.__init__-40"><span class="linenos">40</span></a>
</span><span id="Page.__init__-41"><a href="#Page.__init__-41"><span class="linenos">41</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LoadPage</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span> <span class="n">document</span><span class="p">,</span> <span class="n">document</span><span class="o">.</span><span class="n">formenv</span><span class="p">)</span>
</span><span id="Page.__init__-42"><a href="#Page.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_links</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page.__init__-43"><a href="#Page.__init__-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weblinks</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page.__init__-44"><a href="#Page.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Page.__init__-45"><a href="#Page.__init__-45"><span class="linenos">45</span></a>
</span><span id="Page.__init__-46"><a href="#Page.__init__-46"><span class="linenos">46</span></a>        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Page.__init__-47"><a href="#Page.__init__-47"><span class="linenos">47</span></a>
</span><span id="Page.__init__-48"><a href="#Page.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_textpage</span><span class="p">()</span>
</span><span id="Page.__init__-49"><a href="#Page.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_LoadWebLinks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">)</span>
</span><span id="Page.__init__-50"><a href="#Page.__init__-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_GetForPage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Page.__init__-51"><a href="#Page.__init__-51"><span class="linenos">51</span></a>        <span class="c1"># close them in reverse order</span>
</span><span id="Page.__init__-52"><a href="#Page.__init__-52"><span class="linenos">52</span></a>        <span class="n">weakref</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_Close</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">)</span>
</span><span id="Page.__init__-53"><a href="#Page.__init__-53"><span class="linenos">53</span></a>        <span class="n">weakref</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CloseWebLinks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span><span class="p">)</span>
</span><span id="Page.__init__-54"><a href="#Page.__init__-54"><span class="linenos">54</span></a>
</span><span id="Page.__init__-55"><a href="#Page.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_bboxes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>document</strong>:  a PDF document.</li>
<li><strong>index</strong>:  0-index page number.</li>
</ul>
</div>


                            </div>
                            <div id="Page.index" class="classattr">
                                <div class="attr variable">
            <span class="name">index</span>

        
    </div>
    <a class="headerlink" href="#Page.index"></a>
    
            <div class="docstring"><p>0-index page number.</p>
</div>


                            </div>
                            <div id="Page.number" class="classattr">
                                <div class="attr variable">
            <span class="name">number</span>

        
    </div>
    <a class="headerlink" href="#Page.number"></a>
    
            <div class="docstring"><p>1-index page number.</p>
</div>


                            </div>
                            <div id="Page.label" class="classattr">
                                        <input id="Page.label-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">label</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Page.label-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.label"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.label-57"><a href="#Page.label-57"><span class="linenos">57</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.label-58"><a href="#Page.label-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Page.label-59"><a href="#Page.label-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page label.&quot;&quot;&quot;</span>
</span><span id="Page.label-60"><a href="#Page.label-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">get_page_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The page label.</p>
</div>


                            </div>
                            <div id="Page.width" class="classattr">
                                        <input id="Page.width-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">width</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Page.width-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.width"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.width-62"><a href="#Page.width-62"><span class="linenos">62</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.width-63"><a href="#Page.width-63"><span class="linenos">63</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Page.width-64"><a href="#Page.width-64"><span class="linenos">64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page width.&quot;&quot;&quot;</span>
</span><span id="Page.width-65"><a href="#Page.width-65"><span class="linenos">65</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The page width.</p>
</div>


                            </div>
                            <div id="Page.height" class="classattr">
                                        <input id="Page.height-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">height</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Page.height-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.height"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.height-67"><a href="#Page.height-67"><span class="linenos">67</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.height-68"><a href="#Page.height-68"><span class="linenos">68</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Page.height-69"><a href="#Page.height-69"><span class="linenos">69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page height.&quot;&quot;&quot;</span>
</span><span id="Page.height-70"><a href="#Page.height-70"><span class="linenos">70</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The page height.</p>
</div>


                            </div>
                            <div id="Page.rotation" class="classattr">
                                        <input id="Page.rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rotation</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Page.rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.rotation-72"><a href="#Page.rotation-72"><span class="linenos">72</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.rotation-73"><a href="#Page.rotation-73"><span class="linenos">73</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Page.rotation-74"><a href="#Page.rotation-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page rotation in degrees.&quot;&quot;&quot;</span>
</span><span id="Page.rotation-75"><a href="#Page.rotation-75"><span class="linenos">75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The page rotation in degrees.</p>
</div>


                            </div>
                            <div id="Page.bbox" class="classattr">
                                        <input id="Page.bbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

                <label class="view-source-button" for="Page.bbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.bbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.bbox-77"><a href="#Page.bbox-77"><span class="linenos">77</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.bbox-78"><a href="#Page.bbox-78"><span class="linenos">78</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Page.bbox-79"><a href="#Page.bbox-79"><span class="linenos">79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The page bounding box.&quot;&quot;&quot;</span>
</span><span id="Page.bbox-80"><a href="#Page.bbox-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>The page bounding box.</p>
</div>


                            </div>
                            <div id="Page.char_count" class="classattr">
                                        <input id="Page.char_count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">char_count</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Page.char_count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.char_count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.char_count-82"><a href="#Page.char_count-82"><span class="linenos">82</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.char_count-83"><a href="#Page.char_count-83"><span class="linenos">83</span></a>    <span class="k">def</span> <span class="nf">char_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Page.char_count-84"><a href="#Page.char_count-84"><span class="linenos">84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The total count of characters.&quot;&quot;&quot;</span>
</span><span id="Page.char_count-85"><a href="#Page.char_count-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">count_chars</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The total count of characters.</p>
</div>


                            </div>
                            <div id="Page.char" class="classattr">
                                        <input id="Page.char-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cache</div>

        <span class="def">def</span>
        <span class="name">char</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Character">Character</a></span>:</span></span>

                <label class="view-source-button" for="Page.char-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.char"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.char-87"><a href="#Page.char-87"><span class="linenos">87</span></a>    <span class="nd">@cache</span>
</span><span id="Page.char-88"><a href="#Page.char-88"><span class="linenos">88</span></a>    <span class="k">def</span> <span class="nf">char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Character</span><span class="p">:</span>
</span><span id="Page.char-89"><a href="#Page.char-89"><span class="linenos">89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;:return: The character at the 0-index.&quot;&quot;&quot;</span>
</span><span id="Page.char-90"><a href="#Page.char-90"><span class="linenos">90</span></a>        <span class="k">return</span> <span class="n">Character</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="returns">Returns</h6>

<blockquote>
  <p>The character at the 0-index.</p>
</blockquote>
</div>


                            </div>
                            <div id="Page.chars" class="classattr">
                                        <input id="Page.chars-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">chars</span><span class="annotation">: Iterator[<a href="#Character">Character</a>]</span>

                <label class="view-source-button" for="Page.chars-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.chars"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.chars-92"><a href="#Page.chars-92"><span class="linenos">92</span></a>    <span class="nd">@property</span>
</span><span id="Page.chars-93"><a href="#Page.chars-93"><span class="linenos">93</span></a>    <span class="k">def</span> <span class="nf">chars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page.chars-94"><a href="#Page.chars-94"><span class="linenos">94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yields all characters.&quot;&quot;&quot;</span>
</span><span id="Page.chars-95"><a href="#Page.chars-95"><span class="linenos">95</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_count</span><span class="p">):</span>
</span><span id="Page.chars-96"><a href="#Page.chars-96"><span class="linenos">96</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Yields all characters.</p>
</div>


                            </div>
                            <div id="Page.objlinks" class="classattr">
                                        <input id="Page.objlinks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">objlinks</span><span class="annotation">: list[<a href="#ObjLink">ObjLink</a>]</span>

                <label class="view-source-button" for="Page.objlinks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.objlinks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.objlinks-98"><a href="#Page.objlinks-98"><span class="linenos"> 98</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.objlinks-99"><a href="#Page.objlinks-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">objlinks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjLink</span><span class="p">]:</span>
</span><span id="Page.objlinks-100"><a href="#Page.objlinks-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All object links.&quot;&quot;&quot;</span>
</span><span id="Page.objlinks-101"><a href="#Page.objlinks-101"><span class="linenos">101</span></a>        <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.objlinks-102"><a href="#Page.objlinks-102"><span class="linenos">102</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Page.objlinks-103"><a href="#Page.objlinks-103"><span class="linenos">103</span></a>        <span class="n">link</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINK</span><span class="p">()</span>
</span><span id="Page.objlinks-104"><a href="#Page.objlinks-104"><span class="linenos">104</span></a>        <span class="k">while</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_Enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
</span><span id="Page.objlinks-105"><a href="#Page.objlinks-105"><span class="linenos">105</span></a>            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ObjLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">))</span>
</span><span id="Page.objlinks-106"><a href="#Page.objlinks-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">links</span>
</span></pre></div>


            <div class="docstring"><p>All object links.</p>
</div>


                            </div>
                            <div id="Page.weblinks" class="classattr">
                                        <input id="Page.weblinks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weblinks</span><span class="annotation">: list[<a href="#WebLink">WebLink</a>]</span>

                <label class="view-source-button" for="Page.weblinks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.weblinks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.weblinks-108"><a href="#Page.weblinks-108"><span class="linenos">108</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.weblinks-109"><a href="#Page.weblinks-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">weblinks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">WebLink</span><span class="p">]:</span>
</span><span id="Page.weblinks-110"><a href="#Page.weblinks-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All web links.&quot;&quot;&quot;</span>
</span><span id="Page.weblinks-111"><a href="#Page.weblinks-111"><span class="linenos">111</span></a>        <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.weblinks-112"><a href="#Page.weblinks-112"><span class="linenos">112</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CountWebLinks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_linkpage</span><span class="p">)):</span>
</span><span id="Page.weblinks-113"><a href="#Page.weblinks-113"><span class="linenos">113</span></a>            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WebLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">))</span>
</span><span id="Page.weblinks-114"><a href="#Page.weblinks-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">links</span>
</span></pre></div>


            <div class="docstring"><p>All web links.</p>
</div>


                            </div>
                            <div id="Page.chars_in_area" class="classattr">
                                        <input id="Page.chars_in_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">chars_in_area</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">area</span><span class="p">:</span> <span class="n"><a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Character">Character</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Page.chars_in_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.chars_in_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.chars_in_area-116"><a href="#Page.chars_in_area-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">chars_in_area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page.chars_in_area-117"><a href="#Page.chars_in_area-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page.chars_in_area-118"><a href="#Page.chars_in_area-118"><span class="linenos">118</span></a><span class="sd">        :param area: area to search for character in.</span>
</span><span id="Page.chars_in_area-119"><a href="#Page.chars_in_area-119"><span class="linenos">119</span></a><span class="sd">        :return: All characters found in the area.</span>
</span><span id="Page.chars_in_area-120"><a href="#Page.chars_in_area-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page.chars_in_area-121"><a href="#Page.chars_in_area-121"><span class="linenos">121</span></a>        <span class="n">found</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.chars_in_area-122"><a href="#Page.chars_in_area-122"><span class="linenos">122</span></a>        <span class="c1"># We perform binary searches of the lower and upper y-positions first</span>
</span><span id="Page.chars_in_area-123"><a href="#Page.chars_in_area-123"><span class="linenos">123</span></a>        <span class="c1"># lines are ordered by y-position</span>
</span><span id="Page.chars_in_area-124"><a href="#Page.chars_in_area-124"><span class="linenos">124</span></a>        <span class="n">ypositions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_charlines</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Page.chars_in_area-125"><a href="#Page.chars_in_area-125"><span class="linenos">125</span></a>        <span class="n">y_bottom</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">ypositions</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page.chars_in_area-126"><a href="#Page.chars_in_area-126"><span class="linenos">126</span></a>        <span class="n">y_top</span> <span class="o">=</span> <span class="n">bisect_right</span><span class="p">(</span><span class="n">ypositions</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">y_bottom</span><span class="p">)</span>
</span><span id="Page.chars_in_area-127"><a href="#Page.chars_in_area-127"><span class="linenos">127</span></a>
</span><span id="Page.chars_in_area-128"><a href="#Page.chars_in_area-128"><span class="linenos">128</span></a>        <span class="c1"># Then for every line we do another binary search for left and right</span>
</span><span id="Page.chars_in_area-129"><a href="#Page.chars_in_area-129"><span class="linenos">129</span></a>        <span class="k">for</span> <span class="n">ypos</span> <span class="ow">in</span> <span class="n">ypositions</span><span class="p">[</span><span class="n">y_bottom</span><span class="p">:</span><span class="n">y_top</span><span class="p">]:</span>
</span><span id="Page.chars_in_area-130"><a href="#Page.chars_in_area-130"><span class="linenos">130</span></a>            <span class="n">chars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_charlines</span><span class="p">[</span><span class="n">ypos</span><span class="p">]</span>
</span><span id="Page.chars_in_area-131"><a href="#Page.chars_in_area-131"><span class="linenos">131</span></a>            <span class="n">x_left</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Page.chars_in_area-132"><a href="#Page.chars_in_area-132"><span class="linenos">132</span></a>            <span class="n">x_right</span> <span class="o">=</span> <span class="n">bisect_right</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">x_left</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">midpoint</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Page.chars_in_area-133"><a href="#Page.chars_in_area-133"><span class="linenos">133</span></a>            <span class="c1"># Finally we add all these characters</span>
</span><span id="Page.chars_in_area-134"><a href="#Page.chars_in_area-134"><span class="linenos">134</span></a>            <span class="n">found</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chars</span><span class="p">[</span><span class="n">x_left</span><span class="p">:</span><span class="n">x_right</span><span class="p">])</span>
</span><span id="Page.chars_in_area-135"><a href="#Page.chars_in_area-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">found</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>area</strong>:  area to search for character in.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>All characters found in the area.</p>
</blockquote>
</div>


                            </div>
                            <div id="Page.text_in_area" class="classattr">
                                        <input id="Page.text_in_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">text_in_area</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">area</span><span class="p">:</span> <span class="n"><a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Page.text_in_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.text_in_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.text_in_area-137"><a href="#Page.text_in_area-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">text_in_area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Page.text_in_area-138"><a href="#Page.text_in_area-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page.text_in_area-139"><a href="#Page.text_in_area-139"><span class="linenos">139</span></a><span class="sd">        :param area: area to search for text in.</span>
</span><span id="Page.text_in_area-140"><a href="#Page.text_in_area-140"><span class="linenos">140</span></a><span class="sd">        :return: Only the text found in the area.</span>
</span><span id="Page.text_in_area-141"><a href="#Page.text_in_area-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page.text_in_area-142"><a href="#Page.text_in_area-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_text_bounded</span><span class="p">(</span><span class="n">area</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">area</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>area</strong>:  area to search for text in.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Only the text found in the area.</p>
</blockquote>
</div>


                            </div>
                            <div id="Page.structures" class="classattr">
                                        <input id="Page.structures-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">structures</span><span class="annotation">: Iterator[<a href="#Structure">Structure</a>]</span>

                <label class="view-source-button" for="Page.structures-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.structures"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.structures-144"><a href="#Page.structures-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="Page.structures-145"><a href="#Page.structures-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">structures</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Structure</span><span class="p">]:</span>
</span><span id="Page.structures-146"><a href="#Page.structures-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The PDF/UA tags.&quot;&quot;&quot;</span>
</span><span id="Page.structures-147"><a href="#Page.structures-147"><span class="linenos">147</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_CountChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">)</span>
</span><span id="Page.structures-148"><a href="#Page.structures-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span id="Page.structures-149"><a href="#Page.structures-149"><span class="linenos">149</span></a>            <span class="n">child</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructTree_GetChildAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_structtree</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span>
</span><span id="Page.structures-150"><a href="#Page.structures-150"><span class="linenos">150</span></a>            <span class="k">yield</span> <span class="n">Structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The PDF/UA tags.</p>
</div>


                            </div>
                            <div id="Page.find" class="classattr">
                                        <input id="Page.find-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">string</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Iterator</span><span class="p">[</span><span class="n"><a href="#Character">Character</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Page.find-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.find"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.find-152"><a href="#Page.find-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Character</span><span class="p">]:</span>
</span><span id="Page.find-153"><a href="#Page.find-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Page.find-154"><a href="#Page.find-154"><span class="linenos">154</span></a><span class="sd">        Searches for a match string as whole, consecutive words and yields the</span>
</span><span id="Page.find-155"><a href="#Page.find-155"><span class="linenos">155</span></a><span class="sd">        characters.</span>
</span><span id="Page.find-156"><a href="#Page.find-156"><span class="linenos">156</span></a>
</span><span id="Page.find-157"><a href="#Page.find-157"><span class="linenos">157</span></a><span class="sd">        :param string: The search string.</span>
</span><span id="Page.find-158"><a href="#Page.find-158"><span class="linenos">158</span></a><span class="sd">        :param case_sensitive: Ignore case if false.</span>
</span><span id="Page.find-159"><a href="#Page.find-159"><span class="linenos">159</span></a><span class="sd">        :return: yields the characters found.</span>
</span><span id="Page.find-160"><a href="#Page.find-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Page.find-161"><a href="#Page.find-161"><span class="linenos">161</span></a>        <span class="n">searcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="n">case_sensitive</span><span class="p">,</span> <span class="n">match_whole_word</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">consecutive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Page.find-162"><a href="#Page.find-162"><span class="linenos">162</span></a>        <span class="k">while</span> <span class="n">idx</span> <span class="o">:=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">get_next</span><span class="p">():</span>
</span><span id="Page.find-163"><a href="#Page.find-163"><span class="linenos">163</span></a>            <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="Page.find-164"><a href="#Page.find-164"><span class="linenos">164</span></a>            <span class="k">yield</span> <span class="n">chars</span>
</span></pre></div>


            <div class="docstring"><p>Searches for a match string as whole, consecutive words and yields the
characters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>string</strong>:  The search string.</li>
<li><strong>case_sensitive</strong>:  Ignore case if false.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>yields the characters found.</p>
</blockquote>
</div>


                            </div>
                            <div id="Page.paths" class="classattr">
                                        <input id="Page.paths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">paths</span><span class="annotation">: list[<a href="#Path">Path</a>]</span>

                <label class="view-source-button" for="Page.paths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.paths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.paths-166"><a href="#Page.paths-166"><span class="linenos">166</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.paths-167"><a href="#Page.paths-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
</span><span id="Page.paths-168"><a href="#Page.paths-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All paths.&quot;&quot;&quot;</span>
</span><span id="Page.paths-169"><a href="#Page.paths-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_objects</span><span class="p">([</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>All paths.</p>
</div>


                            </div>
                            <div id="Page.images" class="classattr">
                                        <input id="Page.images-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">images</span><span class="annotation">: list[<a href="#Image">Image</a>]</span>

                <label class="view-source-button" for="Page.images-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.images"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.images-171"><a href="#Page.images-171"><span class="linenos">171</span></a>    <span class="nd">@cached_property</span>
</span><span id="Page.images-172"><a href="#Page.images-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Image</span><span class="p">]:</span>
</span><span id="Page.images-173"><a href="#Page.images-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All images.&quot;&quot;&quot;</span>
</span><span id="Page.images-174"><a href="#Page.images-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">Image</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_objects</span><span class="p">([</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>All images.</p>
</div>


                            </div>
                            <div id="Page.graphic_clusters" class="classattr">
                                        <input id="Page.graphic_clusters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">graphic_clusters</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n"><a href="#Path">Path</a></span> <span class="o">|</span> <span class="n"><a href="#Image">Image</a></span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n"><a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Path">Path</a></span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="Page.graphic_clusters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Page.graphic_clusters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Page.graphic_clusters-176"><a href="#Page.graphic_clusters-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">graphic_clusters</span><span class="p">(</span>
</span><span id="Page.graphic_clusters-177"><a href="#Page.graphic_clusters-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Path</span> <span class="o">|</span> <span class="n">Image</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Page.graphic_clusters-178"><a href="#Page.graphic_clusters-178"><span class="linenos">178</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]]]:</span>
</span><span id="Page.graphic_clusters-179"><a href="#Page.graphic_clusters-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">absolute_tolerance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-180"><a href="#Page.graphic_clusters-180"><span class="linenos">180</span></a>            <span class="n">absolute_tolerance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span>
</span><span id="Page.graphic_clusters-181"><a href="#Page.graphic_clusters-181"><span class="linenos">181</span></a>
</span><span id="Page.graphic_clusters-182"><a href="#Page.graphic_clusters-182"><span class="linenos">182</span></a>        <span class="c1"># First collect all vertical regions</span>
</span><span id="Page.graphic_clusters-183"><a href="#Page.graphic_clusters-183"><span class="linenos">183</span></a>        <span class="n">filtered_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.graphic_clusters-184"><a href="#Page.graphic_clusters-184"><span class="linenos">184</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-185"><a href="#Page.graphic_clusters-185"><span class="linenos">185</span></a>            <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">predicate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-186"><a href="#Page.graphic_clusters-186"><span class="linenos">186</span></a>                <span class="n">filtered_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-187"><a href="#Page.graphic_clusters-187"><span class="linenos">187</span></a>        <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-188"><a href="#Page.graphic_clusters-188"><span class="linenos">188</span></a>            <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">predicate</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-189"><a href="#Page.graphic_clusters-189"><span class="linenos">189</span></a>                <span class="n">filtered_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-190"><a href="#Page.graphic_clusters-190"><span class="linenos">190</span></a>
</span><span id="Page.graphic_clusters-191"><a href="#Page.graphic_clusters-191"><span class="linenos">191</span></a>        <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.graphic_clusters-192"><a href="#Page.graphic_clusters-192"><span class="linenos">192</span></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-193"><a href="#Page.graphic_clusters-193"><span class="linenos">193</span></a>            <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-194"><a href="#Page.graphic_clusters-194"><span class="linenos">194</span></a>                <span class="k">if</span> <span class="n">reg</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-195"><a href="#Page.graphic_clusters-195"><span class="linenos">195</span></a>                    <span class="c1"># They overlap, so merge them</span>
</span><span id="Page.graphic_clusters-196"><a href="#Page.graphic_clusters-196"><span class="linenos">196</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-197"><a href="#Page.graphic_clusters-197"><span class="linenos">197</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">v1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-198"><a href="#Page.graphic_clusters-198"><span class="linenos">198</span></a>                    <span class="n">reg</span><span class="o">.</span><span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-199"><a href="#Page.graphic_clusters-199"><span class="linenos">199</span></a>                    <span class="k">break</span>
</span><span id="Page.graphic_clusters-200"><a href="#Page.graphic_clusters-200"><span class="linenos">200</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-201"><a href="#Page.graphic_clusters-201"><span class="linenos">201</span></a>                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Region</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="Page.graphic_clusters-202"><a href="#Page.graphic_clusters-202"><span class="linenos">202</span></a>
</span><span id="Page.graphic_clusters-203"><a href="#Page.graphic_clusters-203"><span class="linenos">203</span></a>        <span class="c1"># Now collect horizontal region inside each vertical region</span>
</span><span id="Page.graphic_clusters-204"><a href="#Page.graphic_clusters-204"><span class="linenos">204</span></a>        <span class="k">for</span> <span class="n">yreg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-205"><a href="#Page.graphic_clusters-205"><span class="linenos">205</span></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_paths</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-206"><a href="#Page.graphic_clusters-206"><span class="linenos">206</span></a>                <span class="c1"># check if horizontal line is contained in vregion</span>
</span><span id="Page.graphic_clusters-207"><a href="#Page.graphic_clusters-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="n">yreg</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-208"><a href="#Page.graphic_clusters-208"><span class="linenos">208</span></a>                    <span class="k">for</span> <span class="n">xreg</span> <span class="ow">in</span> <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-209"><a href="#Page.graphic_clusters-209"><span class="linenos">209</span></a>                        <span class="k">if</span> <span class="n">xreg</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">absolute_tolerance</span><span class="p">):</span>
</span><span id="Page.graphic_clusters-210"><a href="#Page.graphic_clusters-210"><span class="linenos">210</span></a>                            <span class="c1"># They overlap so merge them</span>
</span><span id="Page.graphic_clusters-211"><a href="#Page.graphic_clusters-211"><span class="linenos">211</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-212"><a href="#Page.graphic_clusters-212"><span class="linenos">212</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">v1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-213"><a href="#Page.graphic_clusters-213"><span class="linenos">213</span></a>                            <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-214"><a href="#Page.graphic_clusters-214"><span class="linenos">214</span></a>                            <span class="k">break</span>
</span><span id="Page.graphic_clusters-215"><a href="#Page.graphic_clusters-215"><span class="linenos">215</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-216"><a href="#Page.graphic_clusters-216"><span class="linenos">216</span></a>                        <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Region</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</span><span id="Page.graphic_clusters-217"><a href="#Page.graphic_clusters-217"><span class="linenos">217</span></a>
</span><span id="Page.graphic_clusters-218"><a href="#Page.graphic_clusters-218"><span class="linenos">218</span></a>        <span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Page.graphic_clusters-219"><a href="#Page.graphic_clusters-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">yreg</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-220"><a href="#Page.graphic_clusters-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">xreg</span> <span class="ow">in</span> <span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-221"><a href="#Page.graphic_clusters-221"><span class="linenos">221</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">yreg</span><span class="o">.</span><span class="n">subregions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-222"><a href="#Page.graphic_clusters-222"><span class="linenos">222</span></a>                    <span class="c1"># Strip down the height again for subregions</span>
</span><span id="Page.graphic_clusters-223"><a href="#Page.graphic_clusters-223"><span class="linenos">223</span></a>                    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Page.graphic_clusters-224"><a href="#Page.graphic_clusters-224"><span class="linenos">224</span></a>                    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-225"><a href="#Page.graphic_clusters-225"><span class="linenos">225</span></a>                        <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-226"><a href="#Page.graphic_clusters-226"><span class="linenos">226</span></a>                        <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-227"><a href="#Page.graphic_clusters-227"><span class="linenos">227</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Page.graphic_clusters-228"><a href="#Page.graphic_clusters-228"><span class="linenos">228</span></a>                    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">yreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">yreg</span><span class="o">.</span><span class="n">v1</span>
</span><span id="Page.graphic_clusters-229"><a href="#Page.graphic_clusters-229"><span class="linenos">229</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">xreg</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">xreg</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</span><span id="Page.graphic_clusters-230"><a href="#Page.graphic_clusters-230"><span class="linenos">230</span></a>                <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bbox</span><span class="p">,</span> <span class="n">xreg</span><span class="o">.</span><span class="n">objs</span><span class="p">))</span>
</span><span id="Page.graphic_clusters-231"><a href="#Page.graphic_clusters-231"><span class="linenos">231</span></a>
</span><span id="Page.graphic_clusters-232"><a href="#Page.graphic_clusters-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pypdfium2._helpers.page.PdfPage</dt>
                                <dd id="Page.parent" class="variable">parent</dd>
                <dd id="Page.get_width" class="function">get_width</dd>
                <dd id="Page.get_height" class="function">get_height</dd>
                <dd id="Page.get_size" class="function">get_size</dd>
                <dd id="Page.get_rotation" class="function">get_rotation</dd>
                <dd id="Page.set_rotation" class="function">set_rotation</dd>
                <dd id="Page.get_mediabox" class="function">get_mediabox</dd>
                <dd id="Page.set_mediabox" class="function">set_mediabox</dd>
                <dd id="Page.get_cropbox" class="function">get_cropbox</dd>
                <dd id="Page.set_cropbox" class="function">set_cropbox</dd>
                <dd id="Page.get_bleedbox" class="function">get_bleedbox</dd>
                <dd id="Page.set_bleedbox" class="function">set_bleedbox</dd>
                <dd id="Page.get_trimbox" class="function">get_trimbox</dd>
                <dd id="Page.set_trimbox" class="function">set_trimbox</dd>
                <dd id="Page.get_artbox" class="function">get_artbox</dd>
                <dd id="Page.set_artbox" class="function">set_artbox</dd>
                <dd id="Page.get_bbox" class="function">get_bbox</dd>
                <dd id="Page.get_textpage" class="function">get_textpage</dd>
                <dd id="Page.insert_obj" class="function">insert_obj</dd>
                <dd id="Page.remove_obj" class="function">remove_obj</dd>
                <dd id="Page.gen_content" class="function">gen_content</dd>
                <dd id="Page.get_objects" class="function">get_objects</dd>
                <dd id="Page.render" class="function">render</dd>

            </div>
            <div><dt>pypdfium2.internal.bases.AutoCloseable</dt>
                                <dd id="Page.close" class="function">close</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Character">
                            <input id="Character-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Character</span>:

                <label class="view-source-button" for="Character-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character-13"><a href="#Character-13"><span class="linenos"> 13</span></a><span class="k">class</span> <span class="nc">Character</span><span class="p">:</span>
</span><span id="Character-14"><a href="#Character-14"><span class="linenos"> 14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Character-15"><a href="#Character-15"><span class="linenos"> 15</span></a><span class="sd">    Each character on the PDF page is represented by a character object,</span>
</span><span id="Character-16"><a href="#Character-16"><span class="linenos"> 16</span></a><span class="sd">    describing exactly where and how to render the associated glyph.</span>
</span><span id="Character-17"><a href="#Character-17"><span class="linenos"> 17</span></a>
</span><span id="Character-18"><a href="#Character-18"><span class="linenos"> 18</span></a><span class="sd">    While there are font flags, PDF files typically use entirely different fonts</span>
</span><span id="Character-19"><a href="#Character-19"><span class="linenos"> 19</span></a><span class="sd">    to render normal, bold, and italic characters.</span>
</span><span id="Character-20"><a href="#Character-20"><span class="linenos"> 20</span></a>
</span><span id="Character-21"><a href="#Character-21"><span class="linenos"> 21</span></a><span class="sd">    The character&#39;s loose bounding box may not always be available, since it</span>
</span><span id="Character-22"><a href="#Character-22"><span class="linenos"> 22</span></a><span class="sd">    must be explicitly provided by the font. The tight bounding box is only</span>
</span><span id="Character-23"><a href="#Character-23"><span class="linenos"> 23</span></a><span class="sd">    available as long as the glyph is renderable, so a space character may have</span>
</span><span id="Character-24"><a href="#Character-24"><span class="linenos"> 24</span></a><span class="sd">    a loose, but not a tight bounding box, or none at all.</span>
</span><span id="Character-25"><a href="#Character-25"><span class="linenos"> 25</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Character-26"><a href="#Character-26"><span class="linenos"> 26</span></a>
</span><span id="Character-27"><a href="#Character-27"><span class="linenos"> 27</span></a>    <span class="k">class</span> <span class="nc">RenderMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Character-28"><a href="#Character-28"><span class="linenos"> 28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tells the PDF viewer how to render this character glyph.&quot;&quot;&quot;</span>
</span><span id="Character-29"><a href="#Character-29"><span class="linenos"> 29</span></a>
</span><span id="Character-30"><a href="#Character-30"><span class="linenos"> 30</span></a>        <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Character-31"><a href="#Character-31"><span class="linenos"> 31</span></a>        <span class="n">FILL</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Character-32"><a href="#Character-32"><span class="linenos"> 32</span></a>        <span class="n">STROKE</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Character-33"><a href="#Character-33"><span class="linenos"> 33</span></a>        <span class="n">FILL_STROKE</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Character-34"><a href="#Character-34"><span class="linenos"> 34</span></a>        <span class="n">INVISIBLE</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Character-35"><a href="#Character-35"><span class="linenos"> 35</span></a>        <span class="n">FILL_CLIP</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="Character-36"><a href="#Character-36"><span class="linenos"> 36</span></a>        <span class="n">STROKE_CLIP</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Character-37"><a href="#Character-37"><span class="linenos"> 37</span></a>        <span class="n">FILL_STROKE_CLIP</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="Character-38"><a href="#Character-38"><span class="linenos"> 38</span></a>        <span class="n">CLIP</span> <span class="o">=</span> <span class="mi">7</span>
</span><span id="Character-39"><a href="#Character-39"><span class="linenos"> 39</span></a>
</span><span id="Character-40"><a href="#Character-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.page.Page&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character-41"><a href="#Character-41"><span class="linenos"> 41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Character-42"><a href="#Character-42"><span class="linenos"> 42</span></a><span class="sd">        :param page: The page containing the character.</span>
</span><span id="Character-43"><a href="#Character-43"><span class="linenos"> 43</span></a><span class="sd">        :param index: The index of the character.</span>
</span><span id="Character-44"><a href="#Character-44"><span class="linenos"> 44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Character-45"><a href="#Character-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="Character-46"><a href="#Character-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">_text</span>
</span><span id="Character-47"><a href="#Character-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="Character-48"><a href="#Character-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Character-49"><a href="#Character-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetCharAngle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)))</span>
</span><span id="Character-50"><a href="#Character-50"><span class="linenos"> 50</span></a>
</span><span id="Character-51"><a href="#Character-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetUnicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span><span id="Character-52"><a href="#Character-52"><span class="linenos"> 52</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The unicode value of the character.&quot;&quot;&quot;</span>
</span><span id="Character-53"><a href="#Character-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">objlink</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.link.ObjLink&quot;</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character-54"><a href="#Character-54"><span class="linenos"> 54</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The object link of this character or `None`&quot;&quot;&quot;</span>
</span><span id="Character-55"><a href="#Character-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weblink</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.link.WebLink&quot;</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character-56"><a href="#Character-56"><span class="linenos"> 56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The web link of this character or `None`&quot;&quot;&quot;</span>
</span><span id="Character-57"><a href="#Character-57"><span class="linenos"> 57</span></a>
</span><span id="Character-58"><a href="#Character-58"><span class="linenos"> 58</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_charbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">loose</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Character-59"><a href="#Character-59"><span class="linenos"> 59</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character-60"><a href="#Character-60"><span class="linenos"> 60</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Character-61"><a href="#Character-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">bbox</span>
</span><span id="Character-62"><a href="#Character-62"><span class="linenos"> 62</span></a>
</span><span id="Character-63"><a href="#Character-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">_font_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="Character-64"><a href="#Character-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Character-65"><a href="#Character-65"><span class="linenos"> 65</span></a>            <span class="n">font</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
</span><span id="Character-66"><a href="#Character-66"><span class="linenos"> 66</span></a>            <span class="n">flags</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">()</span>
</span><span id="Character-67"><a href="#Character-67"><span class="linenos"> 67</span></a>            <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFontInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
</span><span id="Character-68"><a href="#Character-68"><span class="linenos"> 68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="o">=</span> <span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">flags</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Character-69"><a href="#Character-69"><span class="linenos"> 69</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font</span>
</span><span id="Character-70"><a href="#Character-70"><span class="linenos"> 70</span></a>
</span><span id="Character-71"><a href="#Character-71"><span class="linenos"> 71</span></a>    <span class="nd">@property</span>
</span><span id="Character-72"><a href="#Character-72"><span class="linenos"> 72</span></a>    <span class="k">def</span> <span class="nf">char</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character-73"><a href="#Character-73"><span class="linenos"> 73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The printable string of the unicode value.&quot;&quot;&quot;</span>
</span><span id="Character-74"><a href="#Character-74"><span class="linenos"> 74</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character-75"><a href="#Character-75"><span class="linenos"> 75</span></a>        <span class="k">return</span> <span class="n">char</span> <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isprintable</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="Character-76"><a href="#Character-76"><span class="linenos"> 76</span></a>
</span><span id="Character-77"><a href="#Character-77"><span class="linenos"> 77</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-78"><a href="#Character-78"><span class="linenos"> 78</span></a>    <span class="k">def</span> <span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="Character-79"><a href="#Character-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The origin of the character.&quot;&quot;&quot;</span>
</span><span id="Character-80"><a href="#Character-80"><span class="linenos"> 80</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="Character-81"><a href="#Character-81"><span class="linenos"> 81</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetCharOrigin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Character-82"><a href="#Character-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character-83"><a href="#Character-83"><span class="linenos"> 83</span></a>            <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Character-84"><a href="#Character-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Character-85"><a href="#Character-85"><span class="linenos"> 85</span></a>
</span><span id="Character-86"><a href="#Character-86"><span class="linenos"> 86</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-87"><a href="#Character-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character-88"><a href="#Character-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The width of the character&#39;s bounding box.&quot;&quot;&quot;</span>
</span><span id="Character-89"><a href="#Character-89"><span class="linenos"> 89</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character-90"><a href="#Character-90"><span class="linenos"> 90</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="Character-91"><a href="#Character-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
</span><span id="Character-92"><a href="#Character-92"><span class="linenos"> 92</span></a>
</span><span id="Character-93"><a href="#Character-93"><span class="linenos"> 93</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-94"><a href="#Character-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character-95"><a href="#Character-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The height of the character&#39;s bounding box.&quot;&quot;&quot;</span>
</span><span id="Character-96"><a href="#Character-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character-97"><a href="#Character-97"><span class="linenos"> 97</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
</span><span id="Character-98"><a href="#Character-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="Character-99"><a href="#Character-99"><span class="linenos"> 99</span></a>
</span><span id="Character-100"><a href="#Character-100"><span class="linenos">100</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-101"><a href="#Character-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="nf">tbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Character-102"><a href="#Character-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The tight bounding box of the character.&quot;&quot;&quot;</span>
</span><span id="Character-103"><a href="#Character-103"><span class="linenos">103</span></a>        <span class="n">tbbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_charbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">))</span>
</span><span id="Character-104"><a href="#Character-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character-105"><a href="#Character-105"><span class="linenos">105</span></a>            <span class="n">tbbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">tbbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Character-106"><a href="#Character-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">tbbox</span>
</span><span id="Character-107"><a href="#Character-107"><span class="linenos">107</span></a>
</span><span id="Character-108"><a href="#Character-108"><span class="linenos">108</span></a>    <span class="nd">@property</span>
</span><span id="Character-109"><a href="#Character-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Character-110"><a href="#Character-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Character-111"><a href="#Character-111"><span class="linenos">111</span></a><span class="sd">        The loose bounding box of the character.</span>
</span><span id="Character-112"><a href="#Character-112"><span class="linenos">112</span></a><span class="sd">        .. note::</span>
</span><span id="Character-113"><a href="#Character-113"><span class="linenos">113</span></a><span class="sd">            If the loose bounding box is not available, the tight bounding box</span>
</span><span id="Character-114"><a href="#Character-114"><span class="linenos">114</span></a><span class="sd">            is used instead.</span>
</span><span id="Character-115"><a href="#Character-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Character-116"><a href="#Character-116"><span class="linenos">116</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
</span><span id="Character-117"><a href="#Character-117"><span class="linenos">117</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span>
</span><span id="Character-118"><a href="#Character-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>
</span><span id="Character-119"><a href="#Character-119"><span class="linenos">119</span></a>
</span><span id="Character-120"><a href="#Character-120"><span class="linenos">120</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-121"><a href="#Character-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">twidth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character-122"><a href="#Character-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The width of the character&#39;s tight bounding box.&quot;&quot;&quot;</span>
</span><span id="Character-123"><a href="#Character-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">width</span>
</span><span id="Character-124"><a href="#Character-124"><span class="linenos">124</span></a>
</span><span id="Character-125"><a href="#Character-125"><span class="linenos">125</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-126"><a href="#Character-126"><span class="linenos">126</span></a>    <span class="k">def</span> <span class="nf">theight</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character-127"><a href="#Character-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The height of the character&#39;s tight bounding box.&quot;&quot;&quot;</span>
</span><span id="Character-128"><a href="#Character-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="Character-129"><a href="#Character-129"><span class="linenos">129</span></a>
</span><span id="Character-130"><a href="#Character-130"><span class="linenos">130</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-131"><a href="#Character-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">render_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderMode</span><span class="p">:</span>
</span><span id="Character-132"><a href="#Character-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The render mode of the character.&quot;&quot;&quot;</span>
</span><span id="Character-133"><a href="#Character-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="n">Character</span><span class="o">.</span><span class="n">RenderMode</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetTextRenderMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">))</span>
</span><span id="Character-134"><a href="#Character-134"><span class="linenos">134</span></a>
</span><span id="Character-135"><a href="#Character-135"><span class="linenos">135</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-136"><a href="#Character-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character-137"><a href="#Character-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation of the character in degrees modulo 360.&quot;&quot;&quot;</span>
</span><span id="Character-138"><a href="#Character-138"><span class="linenos">138</span></a>        <span class="c1"># Special case for vertical text in rotated pages</span>
</span><span id="Character-139"><a href="#Character-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="o">==</span> <span class="mi">90</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">}:</span>
</span><span id="Character-140"><a href="#Character-140"><span class="linenos">140</span></a>            <span class="k">return</span> <span class="mi">90</span>
</span><span id="Character-141"><a href="#Character-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">:</span>
</span><span id="Character-142"><a href="#Character-142"><span class="linenos">142</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="Character-143"><a href="#Character-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span>
</span><span id="Character-144"><a href="#Character-144"><span class="linenos">144</span></a>
</span><span id="Character-145"><a href="#Character-145"><span class="linenos">145</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-146"><a href="#Character-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character-147"><a href="#Character-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font size of the character.&quot;&quot;&quot;</span>
</span><span id="Character-148"><a href="#Character-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFontSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span><span id="Character-149"><a href="#Character-149"><span class="linenos">149</span></a>
</span><span id="Character-150"><a href="#Character-150"><span class="linenos">150</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-151"><a href="#Character-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">weight</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character-152"><a href="#Character-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font weight of the character.&quot;&quot;&quot;</span>
</span><span id="Character-153"><a href="#Character-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFontWeight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span><span id="Character-154"><a href="#Character-154"><span class="linenos">154</span></a>
</span><span id="Character-155"><a href="#Character-155"><span class="linenos">155</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-156"><a href="#Character-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character-157"><a href="#Character-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The fill color of the character.&quot;&quot;&quot;</span>
</span><span id="Character-158"><a href="#Character-158"><span class="linenos">158</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Character-159"><a href="#Character-159"><span class="linenos">159</span></a>        <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFillColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Character-160"><a href="#Character-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span><span id="Character-161"><a href="#Character-161"><span class="linenos">161</span></a>
</span><span id="Character-162"><a href="#Character-162"><span class="linenos">162</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-163"><a href="#Character-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">stroke</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character-164"><a href="#Character-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke color of the character.&quot;&quot;&quot;</span>
</span><span id="Character-165"><a href="#Character-165"><span class="linenos">165</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Character-166"><a href="#Character-166"><span class="linenos">166</span></a>        <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetStrokeColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Character-167"><a href="#Character-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span><span id="Character-168"><a href="#Character-168"><span class="linenos">168</span></a>
</span><span id="Character-169"><a href="#Character-169"><span class="linenos">169</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-170"><a href="#Character-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">font</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character-171"><a href="#Character-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font name of the character.&quot;&quot;&quot;</span>
</span><span id="Character-172"><a href="#Character-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font_flags</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Character-173"><a href="#Character-173"><span class="linenos">173</span></a>
</span><span id="Character-174"><a href="#Character-174"><span class="linenos">174</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character-175"><a href="#Character-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character-176"><a href="#Character-176"><span class="linenos">176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font flags of the character.&quot;&quot;&quot;</span>
</span><span id="Character-177"><a href="#Character-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font_flags</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Character-178"><a href="#Character-178"><span class="linenos">178</span></a>
</span><span id="Character-179"><a href="#Character-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">descr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character-180"><a href="#Character-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Human-readable description of the character for debugging.&quot;&quot;&quot;</span>
</span><span id="Character-181"><a href="#Character-181"><span class="linenos">181</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character-182"><a href="#Character-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isprintable</span><span class="p">():</span>
</span><span id="Character-183"><a href="#Character-183"><span class="linenos">183</span></a>            <span class="n">char</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character-184"><a href="#Character-184"><span class="linenos">184</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Character-185"><a href="#Character-185"><span class="linenos">185</span></a>            <span class="sa">f</span><span class="s2">&quot;Chr(</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Character-186"><a href="#Character-186"><span class="linenos">186</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">render_mode</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Character-187"><a href="#Character-187"><span class="linenos">187</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Character-188"><a href="#Character-188"><span class="linenos">188</span></a>        <span class="p">)</span>
</span><span id="Character-189"><a href="#Character-189"><span class="linenos">189</span></a>
</span><span id="Character-190"><a href="#Character-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character-191"><a href="#Character-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">char</span>
</span><span id="Character-192"><a href="#Character-192"><span class="linenos">192</span></a>
</span><span id="Character-193"><a href="#Character-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character-194"><a href="#Character-194"><span class="linenos">194</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character-195"><a href="#Character-195"><span class="linenos">195</span></a>        <span class="n">escape</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xA</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">r&quot;</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t&quot;</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">:</span> <span class="s2">&quot;␣&quot;</span><span class="p">}</span>
</span><span id="Character-196"><a href="#Character-196"><span class="linenos">196</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="n">escape</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">,</span> <span class="n">char</span> <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isprintable</span><span class="p">()</span> <span class="k">else</span> <span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">))</span>
</span><span id="Character-197"><a href="#Character-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="n">char</span>
</span></pre></div>


            <div class="docstring"><p>Each character on the PDF page is represented by a character object,
describing exactly where and how to render the associated glyph.</p>

<p>While there are font flags, PDF files typically use entirely different fonts
to render normal, bold, and italic characters.</p>

<p>The character's loose bounding box may not always be available, since it
must be explicitly provided by the font. The tight bounding box is only
available as long as the glyph is renderable, so a space character may have
a loose, but not a tight bounding box, or none at all.</p>
</div>


                            <div id="Character.__init__" class="classattr">
                                        <input id="Character.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Character</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">page</span><span class="p">:</span> <span class="n"><a href="#Page">Page</a></span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Character.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.__init__-40"><a href="#Character.__init__-40"><span class="linenos">40</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.page.Page&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character.__init__-41"><a href="#Character.__init__-41"><span class="linenos">41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Character.__init__-42"><a href="#Character.__init__-42"><span class="linenos">42</span></a><span class="sd">        :param page: The page containing the character.</span>
</span><span id="Character.__init__-43"><a href="#Character.__init__-43"><span class="linenos">43</span></a><span class="sd">        :param index: The index of the character.</span>
</span><span id="Character.__init__-44"><a href="#Character.__init__-44"><span class="linenos">44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Character.__init__-45"><a href="#Character.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="Character.__init__-46"><a href="#Character.__init__-46"><span class="linenos">46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">_text</span>
</span><span id="Character.__init__-47"><a href="#Character.__init__-47"><span class="linenos">47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="Character.__init__-48"><a href="#Character.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Character.__init__-49"><a href="#Character.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetCharAngle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)))</span>
</span><span id="Character.__init__-50"><a href="#Character.__init__-50"><span class="linenos">50</span></a>
</span><span id="Character.__init__-51"><a href="#Character.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetUnicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span><span id="Character.__init__-52"><a href="#Character.__init__-52"><span class="linenos">52</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The unicode value of the character.&quot;&quot;&quot;</span>
</span><span id="Character.__init__-53"><a href="#Character.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">objlink</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.link.ObjLink&quot;</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character.__init__-54"><a href="#Character.__init__-54"><span class="linenos">54</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The object link of this character or `None`&quot;&quot;&quot;</span>
</span><span id="Character.__init__-55"><a href="#Character.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weblink</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.link.WebLink&quot;</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># noqa: F821</span>
</span><span id="Character.__init__-56"><a href="#Character.__init__-56"><span class="linenos">56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The web link of this character or `None`&quot;&quot;&quot;</span>
</span><span id="Character.__init__-57"><a href="#Character.__init__-57"><span class="linenos">57</span></a>
</span><span id="Character.__init__-58"><a href="#Character.__init__-58"><span class="linenos">58</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_charbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">loose</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Character.__init__-59"><a href="#Character.__init__-59"><span class="linenos">59</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character.__init__-60"><a href="#Character.__init__-60"><span class="linenos">60</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Character.__init__-61"><a href="#Character.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span> <span class="o">=</span> <span class="n">bbox</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>page</strong>:  The page containing the character.</li>
<li><strong>index</strong>:  The index of the character.</li>
</ul>
</div>


                            </div>
                            <div id="Character.unicode" class="classattr">
                                <div class="attr variable">
            <span class="name">unicode</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Character.unicode"></a>
    
            <div class="docstring"><p>The unicode value of the character.</p>
</div>


                            </div>
                            <div id="Character.objlink" class="classattr">
                                <div class="attr variable">
            <span class="name">objlink</span><span class="annotation">: <a href="#ObjLink">ObjLink</a></span>

        
    </div>
    <a class="headerlink" href="#Character.objlink"></a>
    
            <div class="docstring"><p>The object link of this character or <code>None</code></p>
</div>


                            </div>
                            <div id="Character.weblink" class="classattr">
                                <div class="attr variable">
            <span class="name">weblink</span><span class="annotation">: <a href="#WebLink">WebLink</a></span>

        
    </div>
    <a class="headerlink" href="#Character.weblink"></a>
    
            <div class="docstring"><p>The web link of this character or <code>None</code></p>
</div>


                            </div>
                            <div id="Character.char" class="classattr">
                                        <input id="Character.char-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">char</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Character.char-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.char"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.char-71"><a href="#Character.char-71"><span class="linenos">71</span></a>    <span class="nd">@property</span>
</span><span id="Character.char-72"><a href="#Character.char-72"><span class="linenos">72</span></a>    <span class="k">def</span> <span class="nf">char</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character.char-73"><a href="#Character.char-73"><span class="linenos">73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The printable string of the unicode value.&quot;&quot;&quot;</span>
</span><span id="Character.char-74"><a href="#Character.char-74"><span class="linenos">74</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character.char-75"><a href="#Character.char-75"><span class="linenos">75</span></a>        <span class="k">return</span> <span class="n">char</span> <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isprintable</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The printable string of the unicode value.</p>
</div>


                            </div>
                            <div id="Character.origin" class="classattr">
                                        <input id="Character.origin-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">origin</span><span class="annotation">: <a href="utils.html#Point">modm_data.utils.Point</a></span>

                <label class="view-source-button" for="Character.origin-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.origin"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.origin-77"><a href="#Character.origin-77"><span class="linenos">77</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.origin-78"><a href="#Character.origin-78"><span class="linenos">78</span></a>    <span class="k">def</span> <span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point</span><span class="p">:</span>
</span><span id="Character.origin-79"><a href="#Character.origin-79"><span class="linenos">79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The origin of the character.&quot;&quot;&quot;</span>
</span><span id="Character.origin-80"><a href="#Character.origin-80"><span class="linenos">80</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="Character.origin-81"><a href="#Character.origin-81"><span class="linenos">81</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetCharOrigin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Character.origin-82"><a href="#Character.origin-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character.origin-83"><a href="#Character.origin-83"><span class="linenos">83</span></a>            <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Character.origin-84"><a href="#Character.origin-84"><span class="linenos">84</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The origin of the character.</p>
</div>


                            </div>
                            <div id="Character.width" class="classattr">
                                        <input id="Character.width-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">width</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Character.width-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.width"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.width-86"><a href="#Character.width-86"><span class="linenos">86</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.width-87"><a href="#Character.width-87"><span class="linenos">87</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character.width-88"><a href="#Character.width-88"><span class="linenos">88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The width of the character&#39;s bounding box.&quot;&quot;&quot;</span>
</span><span id="Character.width-89"><a href="#Character.width-89"><span class="linenos">89</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character.width-90"><a href="#Character.width-90"><span class="linenos">90</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="Character.width-91"><a href="#Character.width-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
</span></pre></div>


            <div class="docstring"><p>The width of the character's bounding box.</p>
</div>


                            </div>
                            <div id="Character.height" class="classattr">
                                        <input id="Character.height-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">height</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Character.height-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.height"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.height-93"><a href="#Character.height-93"><span class="linenos">93</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.height-94"><a href="#Character.height-94"><span class="linenos">94</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character.height-95"><a href="#Character.height-95"><span class="linenos">95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The height of the character&#39;s bounding box.&quot;&quot;&quot;</span>
</span><span id="Character.height-96"><a href="#Character.height-96"><span class="linenos">96</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character.height-97"><a href="#Character.height-97"><span class="linenos">97</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
</span><span id="Character.height-98"><a href="#Character.height-98"><span class="linenos">98</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span></pre></div>


            <div class="docstring"><p>The height of the character's bounding box.</p>
</div>


                            </div>
                            <div id="Character.tbbox" class="classattr">
                                        <input id="Character.tbbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tbbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

                <label class="view-source-button" for="Character.tbbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.tbbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.tbbox-100"><a href="#Character.tbbox-100"><span class="linenos">100</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.tbbox-101"><a href="#Character.tbbox-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="nf">tbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Character.tbbox-102"><a href="#Character.tbbox-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The tight bounding box of the character.&quot;&quot;&quot;</span>
</span><span id="Character.tbbox-103"><a href="#Character.tbbox-103"><span class="linenos">103</span></a>        <span class="n">tbbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="o">.</span><span class="n">get_charbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">))</span>
</span><span id="Character.tbbox-104"><a href="#Character.tbbox-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Character.tbbox-105"><a href="#Character.tbbox-105"><span class="linenos">105</span></a>            <span class="n">tbbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">tbbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">tbbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Character.tbbox-106"><a href="#Character.tbbox-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">tbbox</span>
</span></pre></div>


            <div class="docstring"><p>The tight bounding box of the character.</p>
</div>


                            </div>
                            <div id="Character.bbox" class="classattr">
                                        <input id="Character.bbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

                <label class="view-source-button" for="Character.bbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.bbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.bbox-108"><a href="#Character.bbox-108"><span class="linenos">108</span></a>    <span class="nd">@property</span>
</span><span id="Character.bbox-109"><a href="#Character.bbox-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Character.bbox-110"><a href="#Character.bbox-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Character.bbox-111"><a href="#Character.bbox-111"><span class="linenos">111</span></a><span class="sd">        The loose bounding box of the character.</span>
</span><span id="Character.bbox-112"><a href="#Character.bbox-112"><span class="linenos">112</span></a><span class="sd">        .. note::</span>
</span><span id="Character.bbox-113"><a href="#Character.bbox-113"><span class="linenos">113</span></a><span class="sd">            If the loose bounding box is not available, the tight bounding box</span>
</span><span id="Character.bbox-114"><a href="#Character.bbox-114"><span class="linenos">114</span></a><span class="sd">            is used instead.</span>
</span><span id="Character.bbox-115"><a href="#Character.bbox-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Character.bbox-116"><a href="#Character.bbox-116"><span class="linenos">116</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
</span><span id="Character.bbox-117"><a href="#Character.bbox-117"><span class="linenos">117</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span>
</span><span id="Character.bbox-118"><a href="#Character.bbox-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox</span>
</span></pre></div>


            <div class="docstring"><p>The loose bounding box of the character.</p>

<div class="alert note">

<p>If the loose bounding box is not available, the tight bounding box
is used instead.</p>

</div>
</div>


                            </div>
                            <div id="Character.twidth" class="classattr">
                                        <input id="Character.twidth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">twidth</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Character.twidth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.twidth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.twidth-120"><a href="#Character.twidth-120"><span class="linenos">120</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.twidth-121"><a href="#Character.twidth-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">twidth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character.twidth-122"><a href="#Character.twidth-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The width of the character&#39;s tight bounding box.&quot;&quot;&quot;</span>
</span><span id="Character.twidth-123"><a href="#Character.twidth-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">width</span>
</span></pre></div>


            <div class="docstring"><p>The width of the character's tight bounding box.</p>
</div>


                            </div>
                            <div id="Character.theight" class="classattr">
                                        <input id="Character.theight-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">theight</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Character.theight-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.theight"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.theight-125"><a href="#Character.theight-125"><span class="linenos">125</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.theight-126"><a href="#Character.theight-126"><span class="linenos">126</span></a>    <span class="k">def</span> <span class="nf">theight</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character.theight-127"><a href="#Character.theight-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The height of the character&#39;s tight bounding box.&quot;&quot;&quot;</span>
</span><span id="Character.theight-128"><a href="#Character.theight-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbbox</span><span class="o">.</span><span class="n">height</span>
</span></pre></div>


            <div class="docstring"><p>The height of the character's tight bounding box.</p>
</div>


                            </div>
                            <div id="Character.render_mode" class="classattr">
                                        <input id="Character.render_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">render_mode</span><span class="annotation">: <a href="#Character.RenderMode">Character.RenderMode</a></span>

                <label class="view-source-button" for="Character.render_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.render_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.render_mode-130"><a href="#Character.render_mode-130"><span class="linenos">130</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.render_mode-131"><a href="#Character.render_mode-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">render_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RenderMode</span><span class="p">:</span>
</span><span id="Character.render_mode-132"><a href="#Character.render_mode-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The render mode of the character.&quot;&quot;&quot;</span>
</span><span id="Character.render_mode-133"><a href="#Character.render_mode-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="n">Character</span><span class="o">.</span><span class="n">RenderMode</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetTextRenderMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>The render mode of the character.</p>
</div>


                            </div>
                            <div id="Character.rotation" class="classattr">
                                        <input id="Character.rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rotation</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Character.rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.rotation-135"><a href="#Character.rotation-135"><span class="linenos">135</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.rotation-136"><a href="#Character.rotation-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character.rotation-137"><a href="#Character.rotation-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation of the character in degrees modulo 360.&quot;&quot;&quot;</span>
</span><span id="Character.rotation-138"><a href="#Character.rotation-138"><span class="linenos">138</span></a>        <span class="c1"># Special case for vertical text in rotated pages</span>
</span><span id="Character.rotation-139"><a href="#Character.rotation-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="o">==</span> <span class="mi">90</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">}:</span>
</span><span id="Character.rotation-140"><a href="#Character.rotation-140"><span class="linenos">140</span></a>            <span class="k">return</span> <span class="mi">90</span>
</span><span id="Character.rotation-141"><a href="#Character.rotation-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">:</span>
</span><span id="Character.rotation-142"><a href="#Character.rotation-142"><span class="linenos">142</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="Character.rotation-143"><a href="#Character.rotation-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span>
</span></pre></div>


            <div class="docstring"><p>The rotation of the character in degrees modulo 360.</p>
</div>


                            </div>
                            <div id="Character.size" class="classattr">
                                        <input id="Character.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">size</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Character.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.size-145"><a href="#Character.size-145"><span class="linenos">145</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.size-146"><a href="#Character.size-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Character.size-147"><a href="#Character.size-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font size of the character.&quot;&quot;&quot;</span>
</span><span id="Character.size-148"><a href="#Character.size-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFontSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The font size of the character.</p>
</div>


                            </div>
                            <div id="Character.weight" class="classattr">
                                        <input id="Character.weight-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weight</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Character.weight-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.weight"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.weight-150"><a href="#Character.weight-150"><span class="linenos">150</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.weight-151"><a href="#Character.weight-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">weight</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character.weight-152"><a href="#Character.weight-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font weight of the character.&quot;&quot;&quot;</span>
</span><span id="Character.weight-153"><a href="#Character.weight-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFontWeight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The font weight of the character.</p>
</div>


                            </div>
                            <div id="Character.fill" class="classattr">
                                        <input id="Character.fill-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">fill</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Character.fill-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.fill"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.fill-155"><a href="#Character.fill-155"><span class="linenos">155</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.fill-156"><a href="#Character.fill-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character.fill-157"><a href="#Character.fill-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The fill color of the character.&quot;&quot;&quot;</span>
</span><span id="Character.fill-158"><a href="#Character.fill-158"><span class="linenos">158</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Character.fill-159"><a href="#Character.fill-159"><span class="linenos">159</span></a>        <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetFillColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Character.fill-160"><a href="#Character.fill-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>The fill color of the character.</p>
</div>


                            </div>
                            <div id="Character.stroke" class="classattr">
                                        <input id="Character.stroke-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">stroke</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Character.stroke-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.stroke"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.stroke-162"><a href="#Character.stroke-162"><span class="linenos">162</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.stroke-163"><a href="#Character.stroke-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">stroke</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character.stroke-164"><a href="#Character.stroke-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke color of the character.&quot;&quot;&quot;</span>
</span><span id="Character.stroke-165"><a href="#Character.stroke-165"><span class="linenos">165</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Character.stroke-166"><a href="#Character.stroke-166"><span class="linenos">166</span></a>        <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFText_GetStrokeColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Character.stroke-167"><a href="#Character.stroke-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>The stroke color of the character.</p>
</div>


                            </div>
                            <div id="Character.font" class="classattr">
                                        <input id="Character.font-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">font</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Character.font-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.font"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.font-169"><a href="#Character.font-169"><span class="linenos">169</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.font-170"><a href="#Character.font-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">font</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character.font-171"><a href="#Character.font-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font name of the character.&quot;&quot;&quot;</span>
</span><span id="Character.font-172"><a href="#Character.font-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font_flags</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The font name of the character.</p>
</div>


                            </div>
                            <div id="Character.flags" class="classattr">
                                        <input id="Character.flags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">flags</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Character.flags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.flags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.flags-174"><a href="#Character.flags-174"><span class="linenos">174</span></a>    <span class="nd">@cached_property</span>
</span><span id="Character.flags-175"><a href="#Character.flags-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Character.flags-176"><a href="#Character.flags-176"><span class="linenos">176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The font flags of the character.&quot;&quot;&quot;</span>
</span><span id="Character.flags-177"><a href="#Character.flags-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font_flags</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The font flags of the character.</p>
</div>


                            </div>
                            <div id="Character.descr" class="classattr">
                                        <input id="Character.descr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">descr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Character.descr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.descr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.descr-179"><a href="#Character.descr-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">descr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Character.descr-180"><a href="#Character.descr-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Human-readable description of the character for debugging.&quot;&quot;&quot;</span>
</span><span id="Character.descr-181"><a href="#Character.descr-181"><span class="linenos">181</span></a>        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character.descr-182"><a href="#Character.descr-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isprintable</span><span class="p">():</span>
</span><span id="Character.descr-183"><a href="#Character.descr-183"><span class="linenos">183</span></a>            <span class="n">char</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unicode</span><span class="p">)</span>
</span><span id="Character.descr-184"><a href="#Character.descr-184"><span class="linenos">184</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="Character.descr-185"><a href="#Character.descr-185"><span class="linenos">185</span></a>            <span class="sa">f</span><span class="s2">&quot;Chr(</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Character.descr-186"><a href="#Character.descr-186"><span class="linenos">186</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">render_mode</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="Character.descr-187"><a href="#Character.descr-187"><span class="linenos">187</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Character.descr-188"><a href="#Character.descr-188"><span class="linenos">188</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Human-readable description of the character for debugging.</p>
</div>


                            </div>
                </section>
                <section id="Character.RenderMode">
                            <input id="Character.RenderMode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Character.RenderMode</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Character.RenderMode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Character.RenderMode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Character.RenderMode-27"><a href="#Character.RenderMode-27"><span class="linenos">27</span></a>    <span class="k">class</span> <span class="nc">RenderMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Character.RenderMode-28"><a href="#Character.RenderMode-28"><span class="linenos">28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tells the PDF viewer how to render this character glyph.&quot;&quot;&quot;</span>
</span><span id="Character.RenderMode-29"><a href="#Character.RenderMode-29"><span class="linenos">29</span></a>
</span><span id="Character.RenderMode-30"><a href="#Character.RenderMode-30"><span class="linenos">30</span></a>        <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Character.RenderMode-31"><a href="#Character.RenderMode-31"><span class="linenos">31</span></a>        <span class="n">FILL</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Character.RenderMode-32"><a href="#Character.RenderMode-32"><span class="linenos">32</span></a>        <span class="n">STROKE</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Character.RenderMode-33"><a href="#Character.RenderMode-33"><span class="linenos">33</span></a>        <span class="n">FILL_STROKE</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Character.RenderMode-34"><a href="#Character.RenderMode-34"><span class="linenos">34</span></a>        <span class="n">INVISIBLE</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Character.RenderMode-35"><a href="#Character.RenderMode-35"><span class="linenos">35</span></a>        <span class="n">FILL_CLIP</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="Character.RenderMode-36"><a href="#Character.RenderMode-36"><span class="linenos">36</span></a>        <span class="n">STROKE_CLIP</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Character.RenderMode-37"><a href="#Character.RenderMode-37"><span class="linenos">37</span></a>        <span class="n">FILL_STROKE_CLIP</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="Character.RenderMode-38"><a href="#Character.RenderMode-38"><span class="linenos">38</span></a>        <span class="n">CLIP</span> <span class="o">=</span> <span class="mi">7</span>
</span></pre></div>


            <div class="docstring"><p>Tells the PDF viewer how to render this character glyph.</p>
</div>


                            <div id="Character.RenderMode.UNKNOWN" class="classattr">
                                <div class="attr variable">
            <span class="name">UNKNOWN</span>        =
<span class="default_value">&lt;RenderMode.UNKNOWN: -1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.UNKNOWN"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.FILL" class="classattr">
                                <div class="attr variable">
            <span class="name">FILL</span>        =
<span class="default_value">&lt;RenderMode.FILL: 0&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.FILL"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.STROKE" class="classattr">
                                <div class="attr variable">
            <span class="name">STROKE</span>        =
<span class="default_value">&lt;RenderMode.STROKE: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.STROKE"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.FILL_STROKE" class="classattr">
                                <div class="attr variable">
            <span class="name">FILL_STROKE</span>        =
<span class="default_value">&lt;RenderMode.FILL_STROKE: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.FILL_STROKE"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.INVISIBLE" class="classattr">
                                <div class="attr variable">
            <span class="name">INVISIBLE</span>        =
<span class="default_value">&lt;RenderMode.INVISIBLE: 3&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.INVISIBLE"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.FILL_CLIP" class="classattr">
                                <div class="attr variable">
            <span class="name">FILL_CLIP</span>        =
<span class="default_value">&lt;RenderMode.FILL_CLIP: 4&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.FILL_CLIP"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.STROKE_CLIP" class="classattr">
                                <div class="attr variable">
            <span class="name">STROKE_CLIP</span>        =
<span class="default_value">&lt;RenderMode.STROKE_CLIP: 5&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.STROKE_CLIP"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.FILL_STROKE_CLIP" class="classattr">
                                <div class="attr variable">
            <span class="name">FILL_STROKE_CLIP</span>        =
<span class="default_value">&lt;RenderMode.FILL_STROKE_CLIP: 6&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.FILL_STROKE_CLIP"></a>
    
    

                            </div>
                            <div id="Character.RenderMode.CLIP" class="classattr">
                                <div class="attr variable">
            <span class="name">CLIP</span>        =
<span class="default_value">&lt;RenderMode.CLIP: 7&gt;</span>

        
    </div>
    <a class="headerlink" href="#Character.RenderMode.CLIP"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="Character.RenderMode.name" class="variable">name</dd>
                <dd id="Character.RenderMode.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Path">
                            <input id="Path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Path</span><wbr>(<span class="base">pypdfium2._helpers.pageobjects.PdfObject</span>):

                <label class="view-source-button" for="Path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path-12"><a href="#Path-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfObject</span><span class="p">):</span>
</span><span id="Path-13"><a href="#Path-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path-14"><a href="#Path-14"><span class="linenos"> 14</span></a><span class="sd">    PDF uses a subset of the PostScript graphics language, which draws vector</span>
</span><span id="Path-15"><a href="#Path-15"><span class="linenos"> 15</span></a><span class="sd">    paths with various rendering options. We are only interested in the basic</span>
</span><span id="Path-16"><a href="#Path-16"><span class="linenos"> 16</span></a><span class="sd">    properties, in particular, for recognizing table cell borders.</span>
</span><span id="Path-17"><a href="#Path-17"><span class="linenos"> 17</span></a>
</span><span id="Path-18"><a href="#Path-18"><span class="linenos"> 18</span></a><span class="sd">    This class specializes `pypdfium2.PdfObject` to add accessors for  graphics</span>
</span><span id="Path-19"><a href="#Path-19"><span class="linenos"> 19</span></a><span class="sd">    containing vector paths of various configurations.</span>
</span><span id="Path-20"><a href="#Path-20"><span class="linenos"> 20</span></a>
</span><span id="Path-21"><a href="#Path-21"><span class="linenos"> 21</span></a><span class="sd">    You must construct the paths by calling `modm_data.pdf.page.Page.paths`.</span>
</span><span id="Path-22"><a href="#Path-22"><span class="linenos"> 22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Path-23"><a href="#Path-23"><span class="linenos"> 23</span></a>
</span><span id="Path-24"><a href="#Path-24"><span class="linenos"> 24</span></a>    <span class="k">class</span> <span class="nc">Type</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path-25"><a href="#Path-25"><span class="linenos"> 25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Type&quot;&quot;&quot;</span>
</span><span id="Path-26"><a href="#Path-26"><span class="linenos"> 26</span></a>
</span><span id="Path-27"><a href="#Path-27"><span class="linenos"> 27</span></a>        <span class="n">LINE</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path-28"><a href="#Path-28"><span class="linenos"> 28</span></a>        <span class="n">BEZIER</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path-29"><a href="#Path-29"><span class="linenos"> 29</span></a>        <span class="n">MOVE</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Path-30"><a href="#Path-30"><span class="linenos"> 30</span></a>
</span><span id="Path-31"><a href="#Path-31"><span class="linenos"> 31</span></a>    <span class="k">class</span> <span class="nc">Cap</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path-32"><a href="#Path-32"><span class="linenos"> 32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Cap Type&quot;&quot;&quot;</span>
</span><span id="Path-33"><a href="#Path-33"><span class="linenos"> 33</span></a>
</span><span id="Path-34"><a href="#Path-34"><span class="linenos"> 34</span></a>        <span class="n">BUTT</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path-35"><a href="#Path-35"><span class="linenos"> 35</span></a>        <span class="n">ROUND</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path-36"><a href="#Path-36"><span class="linenos"> 36</span></a>        <span class="n">PROJECTING_SQUARE</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Path-37"><a href="#Path-37"><span class="linenos"> 37</span></a>
</span><span id="Path-38"><a href="#Path-38"><span class="linenos"> 38</span></a>    <span class="k">class</span> <span class="nc">Join</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path-39"><a href="#Path-39"><span class="linenos"> 39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Join Type&quot;&quot;&quot;</span>
</span><span id="Path-40"><a href="#Path-40"><span class="linenos"> 40</span></a>
</span><span id="Path-41"><a href="#Path-41"><span class="linenos"> 41</span></a>        <span class="n">MITER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path-42"><a href="#Path-42"><span class="linenos"> 42</span></a>        <span class="n">ROUND</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path-43"><a href="#Path-43"><span class="linenos"> 43</span></a>        <span class="n">BEVEL</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Path-44"><a href="#Path-44"><span class="linenos"> 44</span></a>
</span><span id="Path-45"><a href="#Path-45"><span class="linenos"> 45</span></a>    <span class="c1"># Overwrite the PdfPageObject.__new__ function</span>
</span><span id="Path-46"><a href="#Path-46"><span class="linenos"> 46</span></a>    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Path-47"><a href="#Path-47"><span class="linenos"> 47</span></a>        <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="Path-48"><a href="#Path-48"><span class="linenos"> 48</span></a>
</span><span id="Path-49"><a href="#Path-49"><span class="linenos"> 49</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Path-50"><a href="#Path-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path-51"><a href="#Path-51"><span class="linenos"> 51</span></a><span class="sd">        :param obj: PDF object of the path.</span>
</span><span id="Path-52"><a href="#Path-52"><span class="linenos"> 52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path-53"><a href="#Path-53"><span class="linenos"> 53</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
</span><span id="Path-54"><a href="#Path-54"><span class="linenos"> 54</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span> <span class="o">==</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span>
</span><span id="Path-55"><a href="#Path-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span>
</span><span id="Path-56"><a href="#Path-56"><span class="linenos"> 56</span></a>
</span><span id="Path-57"><a href="#Path-57"><span class="linenos"> 57</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-58"><a href="#Path-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfMatrix</span><span class="p">:</span>
</span><span id="Path-59"><a href="#Path-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transformation matrix.&quot;&quot;&quot;</span>
</span><span id="Path-60"><a href="#Path-60"><span class="linenos"> 60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span>
</span><span id="Path-61"><a href="#Path-61"><span class="linenos"> 61</span></a>
</span><span id="Path-62"><a href="#Path-62"><span class="linenos"> 62</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-63"><a href="#Path-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path-64"><a href="#Path-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of segments in this path.&quot;&quot;&quot;</span>
</span><span id="Path-65"><a href="#Path-65"><span class="linenos"> 65</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_CountSegments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Path-66"><a href="#Path-66"><span class="linenos"> 66</span></a>
</span><span id="Path-67"><a href="#Path-67"><span class="linenos"> 67</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-68"><a href="#Path-68"><span class="linenos"> 68</span></a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path-69"><a href="#Path-69"><span class="linenos"> 69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The fill color encoded as 32-bit RGBA.&quot;&quot;&quot;</span>
</span><span id="Path-70"><a href="#Path-70"><span class="linenos"> 70</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Path-71"><a href="#Path-71"><span class="linenos"> 71</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetFillColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Path-72"><a href="#Path-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span><span id="Path-73"><a href="#Path-73"><span class="linenos"> 73</span></a>
</span><span id="Path-74"><a href="#Path-74"><span class="linenos"> 74</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-75"><a href="#Path-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">stroke</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path-76"><a href="#Path-76"><span class="linenos"> 76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke color encoded as 32-bit RGBA.&quot;&quot;&quot;</span>
</span><span id="Path-77"><a href="#Path-77"><span class="linenos"> 77</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Path-78"><a href="#Path-78"><span class="linenos"> 78</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetStrokeColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Path-79"><a href="#Path-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span><span id="Path-80"><a href="#Path-80"><span class="linenos"> 80</span></a>
</span><span id="Path-81"><a href="#Path-81"><span class="linenos"> 81</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-82"><a href="#Path-82"><span class="linenos"> 82</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Path-83"><a href="#Path-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke width.&quot;&quot;&quot;</span>
</span><span id="Path-84"><a href="#Path-84"><span class="linenos"> 84</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path-85"><a href="#Path-85"><span class="linenos"> 85</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetStrokeWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
</span><span id="Path-86"><a href="#Path-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">width</span><span class="o">.</span><span class="n">value</span>
</span><span id="Path-87"><a href="#Path-87"><span class="linenos"> 87</span></a>
</span><span id="Path-88"><a href="#Path-88"><span class="linenos"> 88</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-89"><a href="#Path-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">cap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cap</span><span class="p">:</span>
</span><span id="Path-90"><a href="#Path-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line cap type.&quot;&quot;&quot;</span>
</span><span id="Path-91"><a href="#Path-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">Cap</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetLineCap</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Path-92"><a href="#Path-92"><span class="linenos"> 92</span></a>
</span><span id="Path-93"><a href="#Path-93"><span class="linenos"> 93</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-94"><a href="#Path-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Join</span><span class="p">:</span>
</span><span id="Path-95"><a href="#Path-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line join type.&quot;&quot;&quot;</span>
</span><span id="Path-96"><a href="#Path-96"><span class="linenos"> 96</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">Join</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetLineJoin</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Path-97"><a href="#Path-97"><span class="linenos"> 97</span></a>
</span><span id="Path-98"><a href="#Path-98"><span class="linenos"> 98</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-99"><a href="#Path-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Path-100"><a href="#Path-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path-101"><a href="#Path-101"><span class="linenos">101</span></a><span class="sd">        Bounding box of the path.</span>
</span><span id="Path-102"><a href="#Path-102"><span class="linenos">102</span></a><span class="sd">        .. warning::</span>
</span><span id="Path-103"><a href="#Path-103"><span class="linenos">103</span></a><span class="sd">            The bounding is only approximated using the control points!</span>
</span><span id="Path-104"><a href="#Path-104"><span class="linenos">104</span></a><span class="sd">            Therefore bezier curves will likely have a larger bounding box.</span>
</span><span id="Path-105"><a href="#Path-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path-106"><a href="#Path-106"><span class="linenos">106</span></a>        <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path-107"><a href="#Path-107"><span class="linenos">107</span></a>        <span class="n">right</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path-108"><a href="#Path-108"><span class="linenos">108</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
</span><span id="Path-109"><a href="#Path-109"><span class="linenos">109</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bottom</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Path-110"><a href="#Path-110"><span class="linenos">110</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Path-111"><a href="#Path-111"><span class="linenos">111</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Path-112"><a href="#Path-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="n">bbox</span>
</span><span id="Path-113"><a href="#Path-113"><span class="linenos">113</span></a>
</span><span id="Path-114"><a href="#Path-114"><span class="linenos">114</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-115"><a href="#Path-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Path-116"><a href="#Path-116"><span class="linenos">116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path-117"><a href="#Path-117"><span class="linenos">117</span></a><span class="sd">        List of points of the path. If the path is closed, the first point is</span>
</span><span id="Path-118"><a href="#Path-118"><span class="linenos">118</span></a><span class="sd">        added to the end of the list.</span>
</span><span id="Path-119"><a href="#Path-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path-120"><a href="#Path-120"><span class="linenos">120</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Path-121"><a href="#Path-121"><span class="linenos">121</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
</span><span id="Path-122"><a href="#Path-122"><span class="linenos">122</span></a>            <span class="n">seg</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_GetPathSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span>
</span><span id="Path-123"><a href="#Path-123"><span class="linenos">123</span></a>            <span class="n">ptype</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetType</span><span class="p">(</span><span class="n">seg</span><span class="p">))</span>
</span><span id="Path-124"><a href="#Path-124"><span class="linenos">124</span></a>            <span class="c1"># The first point should always be MOVETO</span>
</span><span id="Path-125"><a href="#Path-125"><span class="linenos">125</span></a>            <span class="k">assert</span> <span class="n">ii</span> <span class="ow">or</span> <span class="n">ptype</span> <span class="o">==</span> <span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">MOVE</span>
</span><span id="Path-126"><a href="#Path-126"><span class="linenos">126</span></a>
</span><span id="Path-127"><a href="#Path-127"><span class="linenos">127</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path-128"><a href="#Path-128"><span class="linenos">128</span></a>            <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetPoint</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Path-129"><a href="#Path-129"><span class="linenos">129</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">on_point</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Path-130"><a href="#Path-130"><span class="linenos">130</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">ptype</span><span class="p">))</span>
</span><span id="Path-131"><a href="#Path-131"><span class="linenos">131</span></a>
</span><span id="Path-132"><a href="#Path-132"><span class="linenos">132</span></a>            <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetClose</span><span class="p">(</span><span class="n">seg</span><span class="p">):</span>
</span><span id="Path-133"><a href="#Path-133"><span class="linenos">133</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">LINE</span><span class="p">))</span>
</span><span id="Path-134"><a href="#Path-134"><span class="linenos">134</span></a>
</span><span id="Path-135"><a href="#Path-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Path-136"><a href="#Path-136"><span class="linenos">136</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="Path-137"><a href="#Path-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">points</span>
</span><span id="Path-138"><a href="#Path-138"><span class="linenos">138</span></a>
</span><span id="Path-139"><a href="#Path-139"><span class="linenos">139</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path-140"><a href="#Path-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="Path-141"><a href="#Path-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of lines between the path points.&quot;&quot;&quot;</span>
</span><span id="Path-142"><a href="#Path-142"><span class="linenos">142</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span>
</span><span id="Path-143"><a href="#Path-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Path-144"><a href="#Path-144"><span class="linenos">144</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Path-145"><a href="#Path-145"><span class="linenos">145</span></a>            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Path-146"><a href="#Path-146"><span class="linenos">146</span></a>        <span class="p">]</span>
</span><span id="Path-147"><a href="#Path-147"><span class="linenos">147</span></a>
</span><span id="Path-148"><a href="#Path-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Path-149"><a href="#Path-149"><span class="linenos">149</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
</span><span id="Path-150"><a href="#Path-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;P</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">points</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>PDF uses a subset of the PostScript graphics language, which draws vector
paths with various rendering options. We are only interested in the basic
properties, in particular, for recognizing table cell borders.</p>

<p>This class specializes <code>pypdfium2.PdfObject</code> to add accessors for  graphics
containing vector paths of various configurations.</p>

<p>You must construct the paths by calling <code><a href="#Page.paths">modm_data.pdf.page.Page.paths</a></code>.</p>
</div>


                            <div id="Path.__init__" class="classattr">
                                        <input id="Path.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">obj</span></span>)</span>

                <label class="view-source-button" for="Path.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.__init__-49"><a href="#Path.__init__-49"><span class="linenos">49</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Path.__init__-50"><a href="#Path.__init__-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path.__init__-51"><a href="#Path.__init__-51"><span class="linenos">51</span></a><span class="sd">        :param obj: PDF object of the path.</span>
</span><span id="Path.__init__-52"><a href="#Path.__init__-52"><span class="linenos">52</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path.__init__-53"><a href="#Path.__init__-53"><span class="linenos">53</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
</span><span id="Path.__init__-54"><a href="#Path.__init__-54"><span class="linenos">54</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span> <span class="o">==</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span>
</span><span id="Path.__init__-55"><a href="#Path.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_PATH</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>obj</strong>:  PDF object of the path.</li>
</ul>
</div>


                            </div>
                            <div id="Path.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span>

        
    </div>
    <a class="headerlink" href="#Path.type"></a>
    
    

                            </div>
                            <div id="Path.matrix" class="classattr">
                                        <input id="Path.matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">matrix</span><span class="annotation">: pypdfium2._helpers.matrix.PdfMatrix</span>

                <label class="view-source-button" for="Path.matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.matrix-57"><a href="#Path.matrix-57"><span class="linenos">57</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.matrix-58"><a href="#Path.matrix-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfMatrix</span><span class="p">:</span>
</span><span id="Path.matrix-59"><a href="#Path.matrix-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transformation matrix.&quot;&quot;&quot;</span>
</span><span id="Path.matrix-60"><a href="#Path.matrix-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The transformation matrix.</p>
</div>


                            </div>
                            <div id="Path.count" class="classattr">
                                        <input id="Path.count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">count</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Path.count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.count-62"><a href="#Path.count-62"><span class="linenos">62</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.count-63"><a href="#Path.count-63"><span class="linenos">63</span></a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path.count-64"><a href="#Path.count-64"><span class="linenos">64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of segments in this path.&quot;&quot;&quot;</span>
</span><span id="Path.count-65"><a href="#Path.count-65"><span class="linenos">65</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_CountSegments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Number of segments in this path.</p>
</div>


                            </div>
                            <div id="Path.fill" class="classattr">
                                        <input id="Path.fill-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">fill</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Path.fill-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.fill"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.fill-67"><a href="#Path.fill-67"><span class="linenos">67</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.fill-68"><a href="#Path.fill-68"><span class="linenos">68</span></a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path.fill-69"><a href="#Path.fill-69"><span class="linenos">69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The fill color encoded as 32-bit RGBA.&quot;&quot;&quot;</span>
</span><span id="Path.fill-70"><a href="#Path.fill-70"><span class="linenos">70</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Path.fill-71"><a href="#Path.fill-71"><span class="linenos">71</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetFillColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Path.fill-72"><a href="#Path.fill-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>The fill color encoded as 32-bit RGBA.</p>
</div>


                            </div>
                            <div id="Path.stroke" class="classattr">
                                        <input id="Path.stroke-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">stroke</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Path.stroke-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.stroke"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.stroke-74"><a href="#Path.stroke-74"><span class="linenos">74</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.stroke-75"><a href="#Path.stroke-75"><span class="linenos">75</span></a>    <span class="k">def</span> <span class="nf">stroke</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Path.stroke-76"><a href="#Path.stroke-76"><span class="linenos">76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke color encoded as 32-bit RGBA.&quot;&quot;&quot;</span>
</span><span id="Path.stroke-77"><a href="#Path.stroke-77"><span class="linenos">77</span></a>        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span><span class="p">()</span>
</span><span id="Path.stroke-78"><a href="#Path.stroke-78"><span class="linenos">78</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetStrokeColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Path.stroke-79"><a href="#Path.stroke-79"><span class="linenos">79</span></a>        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">g</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>The stroke color encoded as 32-bit RGBA.</p>
</div>


                            </div>
                            <div id="Path.width" class="classattr">
                                        <input id="Path.width-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">width</span><span class="annotation">: float</span>

                <label class="view-source-button" for="Path.width-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.width"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.width-81"><a href="#Path.width-81"><span class="linenos">81</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.width-82"><a href="#Path.width-82"><span class="linenos">82</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Path.width-83"><a href="#Path.width-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The stroke width.&quot;&quot;&quot;</span>
</span><span id="Path.width-84"><a href="#Path.width-84"><span class="linenos">84</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path.width-85"><a href="#Path.width-85"><span class="linenos">85</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetStrokeWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
</span><span id="Path.width-86"><a href="#Path.width-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="n">width</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>The stroke width.</p>
</div>


                            </div>
                            <div id="Path.cap" class="classattr">
                                        <input id="Path.cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cap</span><span class="annotation">: <a href="#Path.Cap">Path.Cap</a></span>

                <label class="view-source-button" for="Path.cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.cap-88"><a href="#Path.cap-88"><span class="linenos">88</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.cap-89"><a href="#Path.cap-89"><span class="linenos">89</span></a>    <span class="k">def</span> <span class="nf">cap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cap</span><span class="p">:</span>
</span><span id="Path.cap-90"><a href="#Path.cap-90"><span class="linenos">90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line cap type.&quot;&quot;&quot;</span>
</span><span id="Path.cap-91"><a href="#Path.cap-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">Cap</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetLineCap</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Line cap type.</p>
</div>


                            </div>
                            <div id="Path.join" class="classattr">
                                        <input id="Path.join-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">join</span><span class="annotation">: <a href="#Path.Join">Path.Join</a></span>

                <label class="view-source-button" for="Path.join-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.join"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.join-93"><a href="#Path.join-93"><span class="linenos">93</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.join-94"><a href="#Path.join-94"><span class="linenos">94</span></a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Join</span><span class="p">:</span>
</span><span id="Path.join-95"><a href="#Path.join-95"><span class="linenos">95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Line join type.&quot;&quot;&quot;</span>
</span><span id="Path.join-96"><a href="#Path.join-96"><span class="linenos">96</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">Join</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetLineJoin</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Line join type.</p>
</div>


                            </div>
                            <div id="Path.bbox" class="classattr">
                                        <input id="Path.bbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

                <label class="view-source-button" for="Path.bbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.bbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.bbox-98"><a href="#Path.bbox-98"><span class="linenos"> 98</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.bbox-99"><a href="#Path.bbox-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Path.bbox-100"><a href="#Path.bbox-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path.bbox-101"><a href="#Path.bbox-101"><span class="linenos">101</span></a><span class="sd">        Bounding box of the path.</span>
</span><span id="Path.bbox-102"><a href="#Path.bbox-102"><span class="linenos">102</span></a><span class="sd">        .. warning::</span>
</span><span id="Path.bbox-103"><a href="#Path.bbox-103"><span class="linenos">103</span></a><span class="sd">            The bounding is only approximated using the control points!</span>
</span><span id="Path.bbox-104"><a href="#Path.bbox-104"><span class="linenos">104</span></a><span class="sd">            Therefore bezier curves will likely have a larger bounding box.</span>
</span><span id="Path.bbox-105"><a href="#Path.bbox-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path.bbox-106"><a href="#Path.bbox-106"><span class="linenos">106</span></a>        <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path.bbox-107"><a href="#Path.bbox-107"><span class="linenos">107</span></a>        <span class="n">right</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path.bbox-108"><a href="#Path.bbox-108"><span class="linenos">108</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
</span><span id="Path.bbox-109"><a href="#Path.bbox-109"><span class="linenos">109</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bottom</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Path.bbox-110"><a href="#Path.bbox-110"><span class="linenos">110</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Path.bbox-111"><a href="#Path.bbox-111"><span class="linenos">111</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Path.bbox-112"><a href="#Path.bbox-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="n">bbox</span>
</span></pre></div>


            <div class="docstring"><p>Bounding box of the path.</p>

<div class="alert warning">

<p>The bounding is only approximated using the control points!
Therefore bezier curves will likely have a larger bounding box.</p>

</div>
</div>


                            </div>
                            <div id="Path.points" class="classattr">
                                        <input id="Path.points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">points</span><span class="annotation">: list[<a href="utils.html#Point">modm_data.utils.Point</a>]</span>

                <label class="view-source-button" for="Path.points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.points-114"><a href="#Path.points-114"><span class="linenos">114</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.points-115"><a href="#Path.points-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Path.points-116"><a href="#Path.points-116"><span class="linenos">116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Path.points-117"><a href="#Path.points-117"><span class="linenos">117</span></a><span class="sd">        List of points of the path. If the path is closed, the first point is</span>
</span><span id="Path.points-118"><a href="#Path.points-118"><span class="linenos">118</span></a><span class="sd">        added to the end of the list.</span>
</span><span id="Path.points-119"><a href="#Path.points-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Path.points-120"><a href="#Path.points-120"><span class="linenos">120</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Path.points-121"><a href="#Path.points-121"><span class="linenos">121</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
</span><span id="Path.points-122"><a href="#Path.points-122"><span class="linenos">122</span></a>            <span class="n">seg</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPath_GetPathSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span>
</span><span id="Path.points-123"><a href="#Path.points-123"><span class="linenos">123</span></a>            <span class="n">ptype</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetType</span><span class="p">(</span><span class="n">seg</span><span class="p">))</span>
</span><span id="Path.points-124"><a href="#Path.points-124"><span class="linenos">124</span></a>            <span class="c1"># The first point should always be MOVETO</span>
</span><span id="Path.points-125"><a href="#Path.points-125"><span class="linenos">125</span></a>            <span class="k">assert</span> <span class="n">ii</span> <span class="ow">or</span> <span class="n">ptype</span> <span class="o">==</span> <span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">MOVE</span>
</span><span id="Path.points-126"><a href="#Path.points-126"><span class="linenos">126</span></a>
</span><span id="Path.points-127"><a href="#Path.points-127"><span class="linenos">127</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Path.points-128"><a href="#Path.points-128"><span class="linenos">128</span></a>            <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetPoint</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Path.points-129"><a href="#Path.points-129"><span class="linenos">129</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">on_point</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Path.points-130"><a href="#Path.points-130"><span class="linenos">130</span></a>            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">ptype</span><span class="p">))</span>
</span><span id="Path.points-131"><a href="#Path.points-131"><span class="linenos">131</span></a>
</span><span id="Path.points-132"><a href="#Path.points-132"><span class="linenos">132</span></a>            <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPathSegment_GetClose</span><span class="p">(</span><span class="n">seg</span><span class="p">):</span>
</span><span id="Path.points-133"><a href="#Path.points-133"><span class="linenos">133</span></a>                <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">LINE</span><span class="p">))</span>
</span><span id="Path.points-134"><a href="#Path.points-134"><span class="linenos">134</span></a>
</span><span id="Path.points-135"><a href="#Path.points-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Path.points-136"><a href="#Path.points-136"><span class="linenos">136</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="Path.points-137"><a href="#Path.points-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>List of points of the path. If the path is closed, the first point is
added to the end of the list.</p>
</div>


                            </div>
                            <div id="Path.lines" class="classattr">
                                        <input id="Path.lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">lines</span><span class="annotation">: list[<a href="utils.html#Line">modm_data.utils.Line</a>]</span>

                <label class="view-source-button" for="Path.lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.lines-139"><a href="#Path.lines-139"><span class="linenos">139</span></a>    <span class="nd">@cached_property</span>
</span><span id="Path.lines-140"><a href="#Path.lines-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="Path.lines-141"><a href="#Path.lines-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of lines between the path points.&quot;&quot;&quot;</span>
</span><span id="Path.lines-142"><a href="#Path.lines-142"><span class="linenos">142</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span>
</span><span id="Path.lines-143"><a href="#Path.lines-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Path.lines-144"><a href="#Path.lines-144"><span class="linenos">144</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Path.lines-145"><a href="#Path.lines-145"><span class="linenos">145</span></a>            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Path.lines-146"><a href="#Path.lines-146"><span class="linenos">146</span></a>        <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>List of lines between the path points.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pypdfium2._helpers.pageobjects.PdfObject</dt>
                                <dd id="Path.parent" class="variable">parent</dd>
                <dd id="Path.get_pos" class="function">get_pos</dd>
                <dd id="Path.get_matrix" class="function">get_matrix</dd>
                <dd id="Path.set_matrix" class="function">set_matrix</dd>
                <dd id="Path.transform" class="function">transform</dd>

            </div>
            <div><dt>pypdfium2.internal.bases.AutoCloseable</dt>
                                <dd id="Path.close" class="function">close</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Path.Type">
                            <input id="Path.Type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Path.Type</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Path.Type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.Type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.Type-24"><a href="#Path.Type-24"><span class="linenos">24</span></a>    <span class="k">class</span> <span class="nc">Type</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path.Type-25"><a href="#Path.Type-25"><span class="linenos">25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Type&quot;&quot;&quot;</span>
</span><span id="Path.Type-26"><a href="#Path.Type-26"><span class="linenos">26</span></a>
</span><span id="Path.Type-27"><a href="#Path.Type-27"><span class="linenos">27</span></a>        <span class="n">LINE</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path.Type-28"><a href="#Path.Type-28"><span class="linenos">28</span></a>        <span class="n">BEZIER</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path.Type-29"><a href="#Path.Type-29"><span class="linenos">29</span></a>        <span class="n">MOVE</span> <span class="o">=</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Path Type</p>
</div>


                            <div id="Path.Type.LINE" class="classattr">
                                <div class="attr variable">
            <span class="name">LINE</span>        =
<span class="default_value">&lt;Type.LINE: 0&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Type.LINE"></a>
    
    

                            </div>
                            <div id="Path.Type.BEZIER" class="classattr">
                                <div class="attr variable">
            <span class="name">BEZIER</span>        =
<span class="default_value">&lt;Type.BEZIER: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Type.BEZIER"></a>
    
    

                            </div>
                            <div id="Path.Type.MOVE" class="classattr">
                                <div class="attr variable">
            <span class="name">MOVE</span>        =
<span class="default_value">&lt;Type.MOVE: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Type.MOVE"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="Path.Type.name" class="variable">name</dd>
                <dd id="Path.Type.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Path.Cap">
                            <input id="Path.Cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Path.Cap</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Path.Cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.Cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.Cap-31"><a href="#Path.Cap-31"><span class="linenos">31</span></a>    <span class="k">class</span> <span class="nc">Cap</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path.Cap-32"><a href="#Path.Cap-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Cap Type&quot;&quot;&quot;</span>
</span><span id="Path.Cap-33"><a href="#Path.Cap-33"><span class="linenos">33</span></a>
</span><span id="Path.Cap-34"><a href="#Path.Cap-34"><span class="linenos">34</span></a>        <span class="n">BUTT</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path.Cap-35"><a href="#Path.Cap-35"><span class="linenos">35</span></a>        <span class="n">ROUND</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path.Cap-36"><a href="#Path.Cap-36"><span class="linenos">36</span></a>        <span class="n">PROJECTING_SQUARE</span> <span class="o">=</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Path Cap Type</p>
</div>


                            <div id="Path.Cap.BUTT" class="classattr">
                                <div class="attr variable">
            <span class="name">BUTT</span>        =
<span class="default_value">&lt;Cap.BUTT: 0&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Cap.BUTT"></a>
    
    

                            </div>
                            <div id="Path.Cap.ROUND" class="classattr">
                                <div class="attr variable">
            <span class="name">ROUND</span>        =
<span class="default_value">&lt;Cap.ROUND: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Cap.ROUND"></a>
    
    

                            </div>
                            <div id="Path.Cap.PROJECTING_SQUARE" class="classattr">
                                <div class="attr variable">
            <span class="name">PROJECTING_SQUARE</span>        =
<span class="default_value">&lt;Cap.PROJECTING_SQUARE: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Cap.PROJECTING_SQUARE"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="Path.Cap.name" class="variable">name</dd>
                <dd id="Path.Cap.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Path.Join">
                            <input id="Path.Join-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Path.Join</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Path.Join-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Path.Join"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Path.Join-38"><a href="#Path.Join-38"><span class="linenos">38</span></a>    <span class="k">class</span> <span class="nc">Join</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Path.Join-39"><a href="#Path.Join-39"><span class="linenos">39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path Join Type&quot;&quot;&quot;</span>
</span><span id="Path.Join-40"><a href="#Path.Join-40"><span class="linenos">40</span></a>
</span><span id="Path.Join-41"><a href="#Path.Join-41"><span class="linenos">41</span></a>        <span class="n">MITER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Path.Join-42"><a href="#Path.Join-42"><span class="linenos">42</span></a>        <span class="n">ROUND</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Path.Join-43"><a href="#Path.Join-43"><span class="linenos">43</span></a>        <span class="n">BEVEL</span> <span class="o">=</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Path Join Type</p>
</div>


                            <div id="Path.Join.MITER" class="classattr">
                                <div class="attr variable">
            <span class="name">MITER</span>        =
<span class="default_value">&lt;Join.MITER: 0&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Join.MITER"></a>
    
    

                            </div>
                            <div id="Path.Join.ROUND" class="classattr">
                                <div class="attr variable">
            <span class="name">ROUND</span>        =
<span class="default_value">&lt;Join.ROUND: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Join.ROUND"></a>
    
    

                            </div>
                            <div id="Path.Join.BEVEL" class="classattr">
                                <div class="attr variable">
            <span class="name">BEVEL</span>        =
<span class="default_value">&lt;Join.BEVEL: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#Path.Join.BEVEL"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="Path.Join.name" class="variable">name</dd>
                <dd id="Path.Join.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Image">
                            <input id="Image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Image</span><wbr>(<span class="base">pypdfium2._helpers.pageobjects.PdfImage</span>):

                <label class="view-source-button" for="Image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image-10"><a href="#Image-10"><span class="linenos">10</span></a><span class="k">class</span> <span class="nc">Image</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">PdfImage</span><span class="p">):</span>
</span><span id="Image-11"><a href="#Image-11"><span class="linenos">11</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image-12"><a href="#Image-12"><span class="linenos">12</span></a><span class="sd">    This class extends `pypdfium2.PdfImage` to align it with the interface of</span>
</span><span id="Image-13"><a href="#Image-13"><span class="linenos">13</span></a><span class="sd">    the `Path` class so that it can be used in the same</span>
</span><span id="Image-14"><a href="#Image-14"><span class="linenos">14</span></a><span class="sd">    algorithms without filtering.</span>
</span><span id="Image-15"><a href="#Image-15"><span class="linenos">15</span></a>
</span><span id="Image-16"><a href="#Image-16"><span class="linenos">16</span></a><span class="sd">    You must construct the images by calling `modm_data.pdf.page.Page.images`.</span>
</span><span id="Image-17"><a href="#Image-17"><span class="linenos">17</span></a>
</span><span id="Image-18"><a href="#Image-18"><span class="linenos">18</span></a><span class="sd">    .. note:: Images are currently ignored.</span>
</span><span id="Image-19"><a href="#Image-19"><span class="linenos">19</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Image-20"><a href="#Image-20"><span class="linenos">20</span></a>
</span><span id="Image-21"><a href="#Image-21"><span class="linenos">21</span></a>    <span class="c1"># Overwrite the PdfPageObject.__new__ function</span>
</span><span id="Image-22"><a href="#Image-22"><span class="linenos">22</span></a>    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Image-23"><a href="#Image-23"><span class="linenos">23</span></a>        <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="Image-24"><a href="#Image-24"><span class="linenos">24</span></a>
</span><span id="Image-25"><a href="#Image-25"><span class="linenos">25</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Image-26"><a href="#Image-26"><span class="linenos">26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image-27"><a href="#Image-27"><span class="linenos">27</span></a><span class="sd">        :param obj: Page object of the image.</span>
</span><span id="Image-28"><a href="#Image-28"><span class="linenos">28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image-29"><a href="#Image-29"><span class="linenos">29</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
</span><span id="Image-30"><a href="#Image-30"><span class="linenos">30</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span> <span class="o">==</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span>
</span><span id="Image-31"><a href="#Image-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span>
</span><span id="Image-32"><a href="#Image-32"><span class="linenos">32</span></a>
</span><span id="Image-33"><a href="#Image-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="Image-34"><a href="#Image-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of segments. Always 4 due to rectangular image form.</span>
</span><span id="Image-35"><a href="#Image-35"><span class="linenos">35</span></a><span class="sd">           (For compatibility with `Path.count`.)&quot;&quot;&quot;</span>
</span><span id="Image-36"><a href="#Image-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image-37"><a href="#Image-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The border stroke color. Always 0.</span>
</span><span id="Image-38"><a href="#Image-38"><span class="linenos">38</span></a><span class="sd">           (For compatibility with `Path.stroke`.)&quot;&quot;&quot;</span>
</span><span id="Image-39"><a href="#Image-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image-40"><a href="#Image-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The image fill color. Always 0.</span>
</span><span id="Image-41"><a href="#Image-41"><span class="linenos">41</span></a><span class="sd">           (For compatibility with `Path.fill`.)&quot;&quot;&quot;</span>
</span><span id="Image-42"><a href="#Image-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image-43"><a href="#Image-43"><span class="linenos">43</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The border line width. Always 0.</span>
</span><span id="Image-44"><a href="#Image-44"><span class="linenos">44</span></a><span class="sd">           (For compatibility with `Path.width`.)&quot;&quot;&quot;</span>
</span><span id="Image-45"><a href="#Image-45"><span class="linenos">45</span></a>
</span><span id="Image-46"><a href="#Image-46"><span class="linenos">46</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image-47"><a href="#Image-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfMatrix</span><span class="p">:</span>
</span><span id="Image-48"><a href="#Image-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transformation matrix.&quot;&quot;&quot;</span>
</span><span id="Image-49"><a href="#Image-49"><span class="linenos">49</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span>
</span><span id="Image-50"><a href="#Image-50"><span class="linenos">50</span></a>
</span><span id="Image-51"><a href="#Image-51"><span class="linenos">51</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image-52"><a href="#Image-52"><span class="linenos">52</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Image-53"><a href="#Image-53"><span class="linenos">53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding box of the image.&quot;&quot;&quot;</span>
</span><span id="Image-54"><a href="#Image-54"><span class="linenos">54</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos</span><span class="p">())</span>
</span><span id="Image-55"><a href="#Image-55"><span class="linenos">55</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Image-56"><a href="#Image-56"><span class="linenos">56</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Image-57"><a href="#Image-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">bbox</span>
</span><span id="Image-58"><a href="#Image-58"><span class="linenos">58</span></a>
</span><span id="Image-59"><a href="#Image-59"><span class="linenos">59</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image-60"><a href="#Image-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Image-61"><a href="#Image-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image-62"><a href="#Image-62"><span class="linenos">62</span></a><span class="sd">        The 4 points of the bounding box.</span>
</span><span id="Image-63"><a href="#Image-63"><span class="linenos">63</span></a><span class="sd">        (For compatibility with `Path.points`.)</span>
</span><span id="Image-64"><a href="#Image-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image-65"><a href="#Image-65"><span class="linenos">65</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">points</span>
</span><span id="Image-66"><a href="#Image-66"><span class="linenos">66</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Image-67"><a href="#Image-67"><span class="linenos">67</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="Image-68"><a href="#Image-68"><span class="linenos">68</span></a>        <span class="k">return</span> <span class="n">points</span>
</span><span id="Image-69"><a href="#Image-69"><span class="linenos">69</span></a>
</span><span id="Image-70"><a href="#Image-70"><span class="linenos">70</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image-71"><a href="#Image-71"><span class="linenos">71</span></a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="Image-72"><a href="#Image-72"><span class="linenos">72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image-73"><a href="#Image-73"><span class="linenos">73</span></a><span class="sd">        The 4 lines of the bounding box.</span>
</span><span id="Image-74"><a href="#Image-74"><span class="linenos">74</span></a><span class="sd">        (For compatibility with `Path.lines`.)</span>
</span><span id="Image-75"><a href="#Image-75"><span class="linenos">75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image-76"><a href="#Image-76"><span class="linenos">76</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span>
</span><span id="Image-77"><a href="#Image-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Image-78"><a href="#Image-78"><span class="linenos">78</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image-79"><a href="#Image-79"><span class="linenos">79</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image-80"><a href="#Image-80"><span class="linenos">80</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image-81"><a href="#Image-81"><span class="linenos">81</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image-82"><a href="#Image-82"><span class="linenos">82</span></a>        <span class="p">]</span>
</span><span id="Image-83"><a href="#Image-83"><span class="linenos">83</span></a>
</span><span id="Image-84"><a href="#Image-84"><span class="linenos">84</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Image-85"><a href="#Image-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;I</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>This class extends <code>pypdfium2.PdfImage</code> to align it with the interface of
the <code><a href="#Path">Path</a></code> class so that it can be used in the same
algorithms without filtering.</p>

<p>You must construct the images by calling <code><a href="#Page.images">modm_data.pdf.page.Page.images</a></code>.</p>

<div class="alert note">

<h6 id="images-are-currently-ignored">Images are currently ignored.</h6>

</div>
</div>


                            <div id="Image.__init__" class="classattr">
                                        <input id="Image.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Image</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">obj</span></span>)</span>

                <label class="view-source-button" for="Image.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image.__init__-25"><a href="#Image.__init__-25"><span class="linenos">25</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Image.__init__-26"><a href="#Image.__init__-26"><span class="linenos">26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image.__init__-27"><a href="#Image.__init__-27"><span class="linenos">27</span></a><span class="sd">        :param obj: Page object of the image.</span>
</span><span id="Image.__init__-28"><a href="#Image.__init__-28"><span class="linenos">28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image.__init__-29"><a href="#Image.__init__-29"><span class="linenos">29</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
</span><span id="Image.__init__-30"><a href="#Image.__init__-30"><span class="linenos">30</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFPageObj_GetType</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span> <span class="o">==</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span>
</span><span id="Image.__init__-31"><a href="#Image.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_PAGEOBJ_IMAGE</span>
</span><span id="Image.__init__-32"><a href="#Image.__init__-32"><span class="linenos">32</span></a>
</span><span id="Image.__init__-33"><a href="#Image.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="Image.__init__-34"><a href="#Image.__init__-34"><span class="linenos">34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of segments. Always 4 due to rectangular image form.</span>
</span><span id="Image.__init__-35"><a href="#Image.__init__-35"><span class="linenos">35</span></a><span class="sd">           (For compatibility with `Path.count`.)&quot;&quot;&quot;</span>
</span><span id="Image.__init__-36"><a href="#Image.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image.__init__-37"><a href="#Image.__init__-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The border stroke color. Always 0.</span>
</span><span id="Image.__init__-38"><a href="#Image.__init__-38"><span class="linenos">38</span></a><span class="sd">           (For compatibility with `Path.stroke`.)&quot;&quot;&quot;</span>
</span><span id="Image.__init__-39"><a href="#Image.__init__-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image.__init__-40"><a href="#Image.__init__-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The image fill color. Always 0.</span>
</span><span id="Image.__init__-41"><a href="#Image.__init__-41"><span class="linenos">41</span></a><span class="sd">           (For compatibility with `Path.fill`.)&quot;&quot;&quot;</span>
</span><span id="Image.__init__-42"><a href="#Image.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Image.__init__-43"><a href="#Image.__init__-43"><span class="linenos">43</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The border line width. Always 0.</span>
</span><span id="Image.__init__-44"><a href="#Image.__init__-44"><span class="linenos">44</span></a><span class="sd">           (For compatibility with `Path.width`.)&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>obj</strong>:  Page object of the image.</li>
</ul>
</div>


                            </div>
                            <div id="Image.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span>

        
    </div>
    <a class="headerlink" href="#Image.type"></a>
    
    

                            </div>
                            <div id="Image.count" class="classattr">
                                <div class="attr variable">
            <span class="name">count</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Image.count"></a>
    
            <div class="docstring"><p>Number of segments. Always 4 due to rectangular image form.
(For compatibility with <code><a href="#Path.count">Path.count</a></code>.)</p>
</div>


                            </div>
                            <div id="Image.stroke" class="classattr">
                                <div class="attr variable">
            <span class="name">stroke</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Image.stroke"></a>
    
            <div class="docstring"><p>The border stroke color. Always 0.
(For compatibility with <code><a href="#Path.stroke">Path.stroke</a></code>.)</p>
</div>


                            </div>
                            <div id="Image.fill" class="classattr">
                                <div class="attr variable">
            <span class="name">fill</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Image.fill"></a>
    
            <div class="docstring"><p>The image fill color. Always 0.
(For compatibility with <code><a href="#Path.fill">Path.fill</a></code>.)</p>
</div>


                            </div>
                            <div id="Image.width" class="classattr">
                                <div class="attr variable">
            <span class="name">width</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#Image.width"></a>
    
            <div class="docstring"><p>The border line width. Always 0.
(For compatibility with <code><a href="#Path.width">Path.width</a></code>.)</p>
</div>


                            </div>
                            <div id="Image.matrix" class="classattr">
                                        <input id="Image.matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">matrix</span><span class="annotation">: pypdfium2._helpers.matrix.PdfMatrix</span>

                <label class="view-source-button" for="Image.matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image.matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image.matrix-46"><a href="#Image.matrix-46"><span class="linenos">46</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image.matrix-47"><a href="#Image.matrix-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">PdfMatrix</span><span class="p">:</span>
</span><span id="Image.matrix-48"><a href="#Image.matrix-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The transformation matrix.&quot;&quot;&quot;</span>
</span><span id="Image.matrix-49"><a href="#Image.matrix-49"><span class="linenos">49</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matrix</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The transformation matrix.</p>
</div>


                            </div>
                            <div id="Image.bbox" class="classattr">
                                        <input id="Image.bbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

                <label class="view-source-button" for="Image.bbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image.bbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image.bbox-51"><a href="#Image.bbox-51"><span class="linenos">51</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image.bbox-52"><a href="#Image.bbox-52"><span class="linenos">52</span></a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rectangle</span><span class="p">:</span>
</span><span id="Image.bbox-53"><a href="#Image.bbox-53"><span class="linenos">53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding box of the image.&quot;&quot;&quot;</span>
</span><span id="Image.bbox-54"><a href="#Image.bbox-54"><span class="linenos">54</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pos</span><span class="p">())</span>
</span><span id="Image.bbox-55"><a href="#Image.bbox-55"><span class="linenos">55</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Image.bbox-56"><a href="#Image.bbox-56"><span class="linenos">56</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Image.bbox-57"><a href="#Image.bbox-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">bbox</span>
</span></pre></div>


            <div class="docstring"><p>The bounding box of the image.</p>
</div>


                            </div>
                            <div id="Image.points" class="classattr">
                                        <input id="Image.points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">points</span><span class="annotation">: list[<a href="utils.html#Point">modm_data.utils.Point</a>]</span>

                <label class="view-source-button" for="Image.points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image.points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image.points-59"><a href="#Image.points-59"><span class="linenos">59</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image.points-60"><a href="#Image.points-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">]:</span>
</span><span id="Image.points-61"><a href="#Image.points-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image.points-62"><a href="#Image.points-62"><span class="linenos">62</span></a><span class="sd">        The 4 points of the bounding box.</span>
</span><span id="Image.points-63"><a href="#Image.points-63"><span class="linenos">63</span></a><span class="sd">        (For compatibility with `Path.points`.)</span>
</span><span id="Image.points-64"><a href="#Image.points-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image.points-65"><a href="#Image.points-65"><span class="linenos">65</span></a>        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">points</span>
</span><span id="Image.points-66"><a href="#Image.points-66"><span class="linenos">66</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="Image.points-67"><a href="#Image.points-67"><span class="linenos">67</span></a>            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
</span><span id="Image.points-68"><a href="#Image.points-68"><span class="linenos">68</span></a>        <span class="k">return</span> <span class="n">points</span>
</span></pre></div>


            <div class="docstring"><p>The 4 points of the bounding box.
(For compatibility with <code><a href="#Path.points">Path.points</a></code>.)</p>
</div>


                            </div>
                            <div id="Image.lines" class="classattr">
                                        <input id="Image.lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">lines</span><span class="annotation">: list[<a href="utils.html#Line">modm_data.utils.Line</a>]</span>

                <label class="view-source-button" for="Image.lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Image.lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Image.lines-70"><a href="#Image.lines-70"><span class="linenos">70</span></a>    <span class="nd">@cached_property</span>
</span><span id="Image.lines-71"><a href="#Image.lines-71"><span class="linenos">71</span></a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line</span><span class="p">]:</span>
</span><span id="Image.lines-72"><a href="#Image.lines-72"><span class="linenos">72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Image.lines-73"><a href="#Image.lines-73"><span class="linenos">73</span></a><span class="sd">        The 4 lines of the bounding box.</span>
</span><span id="Image.lines-74"><a href="#Image.lines-74"><span class="linenos">74</span></a><span class="sd">        (For compatibility with `Path.lines`.)</span>
</span><span id="Image.lines-75"><a href="#Image.lines-75"><span class="linenos">75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Image.lines-76"><a href="#Image.lines-76"><span class="linenos">76</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span>
</span><span id="Image.lines-77"><a href="#Image.lines-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Image.lines-78"><a href="#Image.lines-78"><span class="linenos">78</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image.lines-79"><a href="#Image.lines-79"><span class="linenos">79</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image.lines-80"><a href="#Image.lines-80"><span class="linenos">80</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image.lines-81"><a href="#Image.lines-81"><span class="linenos">81</span></a>            <span class="n">Line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Image.lines-82"><a href="#Image.lines-82"><span class="linenos">82</span></a>        <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The 4 lines of the bounding box.
(For compatibility with <code><a href="#Path.lines">Path.lines</a></code>.)</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pypdfium2._helpers.pageobjects.PdfImage</dt>
                                <dd id="Image.SIMPLE_FILTERS" class="variable">SIMPLE_FILTERS</dd>
                <dd id="Image.new" class="function">new</dd>
                <dd id="Image.get_metadata" class="function">get_metadata</dd>
                <dd id="Image.get_size" class="function">get_size</dd>
                <dd id="Image.load_jpeg" class="function">load_jpeg</dd>
                <dd id="Image.set_bitmap" class="function">set_bitmap</dd>
                <dd id="Image.get_bitmap" class="function">get_bitmap</dd>
                <dd id="Image.get_data" class="function">get_data</dd>
                <dd id="Image.get_filters" class="function">get_filters</dd>
                <dd id="Image.extract" class="function">extract</dd>

            </div>
            <div><dt>pypdfium2._helpers.pageobjects.PdfObject</dt>
                                <dd id="Image.parent" class="variable">parent</dd>
                <dd id="Image.get_pos" class="function">get_pos</dd>
                <dd id="Image.get_matrix" class="function">get_matrix</dd>
                <dd id="Image.set_matrix" class="function">set_matrix</dd>
                <dd id="Image.transform" class="function">transform</dd>

            </div>
            <div><dt>pypdfium2.internal.bases.AutoCloseable</dt>
                                <dd id="Image.close" class="function">close</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ObjLink">
                            <input id="ObjLink-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ObjLink</span>:

                <label class="view-source-button" for="ObjLink-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObjLink"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObjLink-11"><a href="#ObjLink-11"><span class="linenos">11</span></a><span class="k">class</span> <span class="nc">ObjLink</span><span class="p">:</span>
</span><span id="ObjLink-12"><a href="#ObjLink-12"><span class="linenos">12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ObjLink-13"><a href="#ObjLink-13"><span class="linenos">13</span></a><span class="sd">    An internal reference to other objects by an identifier giving the bounding</span>
</span><span id="ObjLink-14"><a href="#ObjLink-14"><span class="linenos">14</span></a><span class="sd">    box and destination page. These links can be extracted by calling the</span>
</span><span id="ObjLink-15"><a href="#ObjLink-15"><span class="linenos">15</span></a><span class="sd">    `modm_data.pdf.page.Page.objlinks` property.</span>
</span><span id="ObjLink-16"><a href="#ObjLink-16"><span class="linenos">16</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ObjLink-17"><a href="#ObjLink-17"><span class="linenos">17</span></a>
</span><span id="ObjLink-18"><a href="#ObjLink-18"><span class="linenos">18</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Page&quot;</span><span class="p">,</span> <span class="n">link</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINK</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="ObjLink-19"><a href="#ObjLink-19"><span class="linenos">19</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ObjLink-20"><a href="#ObjLink-20"><span class="linenos">20</span></a><span class="sd">        :param page: Page containing the link, used to compute bounding box.</span>
</span><span id="ObjLink-21"><a href="#ObjLink-21"><span class="linenos">21</span></a><span class="sd">        :param link: Raw link object.</span>
</span><span id="ObjLink-22"><a href="#ObjLink-22"><span class="linenos">22</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ObjLink-23"><a href="#ObjLink-23"><span class="linenos">23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="ObjLink-24"><a href="#ObjLink-24"><span class="linenos">24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dest</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetDest</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
</span><span id="ObjLink-25"><a href="#ObjLink-25"><span class="linenos">25</span></a>
</span><span id="ObjLink-26"><a href="#ObjLink-26"><span class="linenos">26</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FS_RECTF</span><span class="p">()</span>
</span><span id="ObjLink-27"><a href="#ObjLink-27"><span class="linenos">27</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetAnnotRect</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</span><span id="ObjLink-28"><a href="#ObjLink-28"><span class="linenos">28</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="ObjLink-29"><a href="#ObjLink-29"><span class="linenos">29</span></a>        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="ObjLink-30"><a href="#ObjLink-30"><span class="linenos">30</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="ObjLink-31"><a href="#ObjLink-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">:</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="n">bbox</span>
</span><span id="ObjLink-32"><a href="#ObjLink-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding box of the link source&quot;&quot;&quot;</span>
</span><span id="ObjLink-33"><a href="#ObjLink-33"><span class="linenos">33</span></a>
</span><span id="ObjLink-34"><a href="#ObjLink-34"><span class="linenos">34</span></a>    <span class="nd">@cached_property</span>
</span><span id="ObjLink-35"><a href="#ObjLink-35"><span class="linenos">35</span></a>    <span class="k">def</span> <span class="nf">page_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ObjLink-36"><a href="#ObjLink-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;0-indexed page number of the link destination.&quot;&quot;&quot;</span>
</span><span id="ObjLink-37"><a href="#ObjLink-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFDest_GetDestPageIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dest</span><span class="p">)</span>
</span><span id="ObjLink-38"><a href="#ObjLink-38"><span class="linenos">38</span></a>
</span><span id="ObjLink-39"><a href="#ObjLink-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="ObjLink-40"><a href="#ObjLink-40"><span class="linenos">40</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Obj(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">page_index</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>An internal reference to other objects by an identifier giving the bounding
box and destination page. These links can be extracted by calling the
<code><a href="#Page.objlinks">modm_data.pdf.page.Page.objlinks</a></code> property.</p>
</div>


                            <div id="ObjLink.__init__" class="classattr">
                                        <input id="ObjLink.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ObjLink</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">page</span><span class="p">:</span> <span class="n"><a href="#Page">Page</a></span>,</span><span class="param">	<span class="n">link</span><span class="p">:</span> <span class="n">pypdfium2_raw</span><span class="o">.</span><span class="n">bindings</span><span class="o">.</span><span class="n">LP_struct_fpdf_link_t__</span></span>)</span>

                <label class="view-source-button" for="ObjLink.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObjLink.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObjLink.__init__-18"><a href="#ObjLink.__init__-18"><span class="linenos">18</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Page&quot;</span><span class="p">,</span> <span class="n">link</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_LINK</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="ObjLink.__init__-19"><a href="#ObjLink.__init__-19"><span class="linenos">19</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ObjLink.__init__-20"><a href="#ObjLink.__init__-20"><span class="linenos">20</span></a><span class="sd">        :param page: Page containing the link, used to compute bounding box.</span>
</span><span id="ObjLink.__init__-21"><a href="#ObjLink.__init__-21"><span class="linenos">21</span></a><span class="sd">        :param link: Raw link object.</span>
</span><span id="ObjLink.__init__-22"><a href="#ObjLink.__init__-22"><span class="linenos">22</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ObjLink.__init__-23"><a href="#ObjLink.__init__-23"><span class="linenos">23</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="ObjLink.__init__-24"><a href="#ObjLink.__init__-24"><span class="linenos">24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dest</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetDest</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
</span><span id="ObjLink.__init__-25"><a href="#ObjLink.__init__-25"><span class="linenos">25</span></a>
</span><span id="ObjLink.__init__-26"><a href="#ObjLink.__init__-26"><span class="linenos">26</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FS_RECTF</span><span class="p">()</span>
</span><span id="ObjLink.__init__-27"><a href="#ObjLink.__init__-27"><span class="linenos">27</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetAnnotRect</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
</span><span id="ObjLink.__init__-28"><a href="#ObjLink.__init__-28"><span class="linenos">28</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="ObjLink.__init__-29"><a href="#ObjLink.__init__-29"><span class="linenos">29</span></a>        <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="ObjLink.__init__-30"><a href="#ObjLink.__init__-30"><span class="linenos">30</span></a>            <span class="n">bbox</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="ObjLink.__init__-31"><a href="#ObjLink.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">:</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="n">bbox</span>
</span><span id="ObjLink.__init__-32"><a href="#ObjLink.__init__-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bounding box of the link source&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>page</strong>:  Page containing the link, used to compute bounding box.</li>
<li><strong>link</strong>:  Raw link object.</li>
</ul>
</div>


                            </div>
                            <div id="ObjLink.bbox" class="classattr">
                                <div class="attr variable">
            <span class="name">bbox</span><span class="annotation">: <a href="utils.html#Rectangle">modm_data.utils.Rectangle</a></span>

        
    </div>
    <a class="headerlink" href="#ObjLink.bbox"></a>
    
            <div class="docstring"><p>Bounding box of the link source</p>
</div>


                            </div>
                            <div id="ObjLink.page_index" class="classattr">
                                        <input id="ObjLink.page_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">page_index</span><span class="annotation">: int</span>

                <label class="view-source-button" for="ObjLink.page_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ObjLink.page_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ObjLink.page_index-34"><a href="#ObjLink.page_index-34"><span class="linenos">34</span></a>    <span class="nd">@cached_property</span>
</span><span id="ObjLink.page_index-35"><a href="#ObjLink.page_index-35"><span class="linenos">35</span></a>    <span class="k">def</span> <span class="nf">page_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ObjLink.page_index-36"><a href="#ObjLink.page_index-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;0-indexed page number of the link destination.&quot;&quot;&quot;</span>
</span><span id="ObjLink.page_index-37"><a href="#ObjLink.page_index-37"><span class="linenos">37</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFDest_GetDestPageIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dest</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>0-indexed page number of the link destination.</p>
</div>


                            </div>
                </section>
                <section id="WebLink">
                            <input id="WebLink-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">WebLink</span>:

                <label class="view-source-button" for="WebLink-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink-43"><a href="#WebLink-43"><span class="linenos">43</span></a><span class="k">class</span> <span class="nc">WebLink</span><span class="p">:</span>
</span><span id="WebLink-44"><a href="#WebLink-44"><span class="linenos">44</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="WebLink-45"><a href="#WebLink-45"><span class="linenos">45</span></a><span class="sd">    An external reference to URLs giving the bounding box and destination URL.</span>
</span><span id="WebLink-46"><a href="#WebLink-46"><span class="linenos">46</span></a><span class="sd">    These links can be extracted by calling the</span>
</span><span id="WebLink-47"><a href="#WebLink-47"><span class="linenos">47</span></a><span class="sd">    `modm_data.pdf.page.Page.weblinks` property.</span>
</span><span id="WebLink-48"><a href="#WebLink-48"><span class="linenos">48</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="WebLink-49"><a href="#WebLink-49"><span class="linenos">49</span></a>
</span><span id="WebLink-50"><a href="#WebLink-50"><span class="linenos">50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Page&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="WebLink-51"><a href="#WebLink-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="WebLink-52"><a href="#WebLink-52"><span class="linenos">52</span></a><span class="sd">        :param page: Page containing the link, used to compute bounding box.</span>
</span><span id="WebLink-53"><a href="#WebLink-53"><span class="linenos">53</span></a><span class="sd">        :param index: 0-index of the weblink object.</span>
</span><span id="WebLink-54"><a href="#WebLink-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WebLink-55"><a href="#WebLink-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="WebLink-56"><a href="#WebLink-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_link</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">_linkpage</span>
</span><span id="WebLink-57"><a href="#WebLink-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="WebLink-58"><a href="#WebLink-58"><span class="linenos">58</span></a>
</span><span id="WebLink-59"><a href="#WebLink-59"><span class="linenos">59</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink-60"><a href="#WebLink-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">bbox_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="WebLink-61"><a href="#WebLink-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of bounding boxes associated with this weblink.&quot;&quot;&quot;</span>
</span><span id="WebLink-62"><a href="#WebLink-62"><span class="linenos">62</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CountRects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span><span id="WebLink-63"><a href="#WebLink-63"><span class="linenos">63</span></a>
</span><span id="WebLink-64"><a href="#WebLink-64"><span class="linenos">64</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink-65"><a href="#WebLink-65"><span class="linenos">65</span></a>    <span class="k">def</span> <span class="nf">bboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">]:</span>
</span><span id="WebLink-66"><a href="#WebLink-66"><span class="linenos">66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding boxes associated with this weblink.&quot;&quot;&quot;</span>
</span><span id="WebLink-67"><a href="#WebLink-67"><span class="linenos">67</span></a>        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WebLink-68"><a href="#WebLink-68"><span class="linenos">68</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_count</span><span class="p">):</span>
</span><span id="WebLink-69"><a href="#WebLink-69"><span class="linenos">69</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="WebLink-70"><a href="#WebLink-70"><span class="linenos">70</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="WebLink-71"><a href="#WebLink-71"><span class="linenos">71</span></a>            <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="WebLink-72"><a href="#WebLink-72"><span class="linenos">72</span></a>            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y1</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="WebLink-73"><a href="#WebLink-73"><span class="linenos">73</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="WebLink-74"><a href="#WebLink-74"><span class="linenos">74</span></a>            <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="WebLink-75"><a href="#WebLink-75"><span class="linenos">75</span></a>                <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="WebLink-76"><a href="#WebLink-76"><span class="linenos">76</span></a>                <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span>
</span><span id="WebLink-77"><a href="#WebLink-77"><span class="linenos">77</span></a>            <span class="p">]</span>
</span><span id="WebLink-78"><a href="#WebLink-78"><span class="linenos">78</span></a>        <span class="k">return</span> <span class="n">bboxes</span>
</span><span id="WebLink-79"><a href="#WebLink-79"><span class="linenos">79</span></a>
</span><span id="WebLink-80"><a href="#WebLink-80"><span class="linenos">80</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink-81"><a href="#WebLink-81"><span class="linenos">81</span></a>    <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="WebLink-82"><a href="#WebLink-82"><span class="linenos">82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end index of the characters associated with this link.&quot;&quot;&quot;</span>
</span><span id="WebLink-83"><a href="#WebLink-83"><span class="linenos">83</span></a>        <span class="n">cstart</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">()</span>
</span><span id="WebLink-84"><a href="#WebLink-84"><span class="linenos">84</span></a>        <span class="n">ccount</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">()</span>
</span><span id="WebLink-85"><a href="#WebLink-85"><span class="linenos">85</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetTextRange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">cstart</span><span class="p">,</span> <span class="n">ccount</span><span class="p">)</span>
</span><span id="WebLink-86"><a href="#WebLink-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">cstart</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">cstart</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">ccount</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="WebLink-87"><a href="#WebLink-87"><span class="linenos">87</span></a>
</span><span id="WebLink-88"><a href="#WebLink-88"><span class="linenos">88</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink-89"><a href="#WebLink-89"><span class="linenos">89</span></a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="WebLink-90"><a href="#WebLink-90"><span class="linenos">90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The URL string of this link.&quot;&quot;&quot;</span>
</span><span id="WebLink-91"><a href="#WebLink-91"><span class="linenos">91</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="WebLink-92"><a href="#WebLink-92"><span class="linenos">92</span></a>        <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ushort</span> <span class="o">*</span> <span class="n">length</span>
</span><span id="WebLink-93"><a href="#WebLink-93"><span class="linenos">93</span></a>        <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">cbuffer</span><span class="p">()</span>
</span><span id="WebLink-94"><a href="#WebLink-94"><span class="linenos">94</span></a>        <span class="n">retlen</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetURL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">cbuffer</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
</span><span id="WebLink-95"><a href="#WebLink-95"><span class="linenos">95</span></a>        <span class="k">assert</span> <span class="n">retlen</span> <span class="o">&lt;</span> <span class="n">length</span>
</span><span id="WebLink-96"><a href="#WebLink-96"><span class="linenos">96</span></a>        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">cbuffer</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="WebLink-97"><a href="#WebLink-97"><span class="linenos">97</span></a>
</span><span id="WebLink-98"><a href="#WebLink-98"><span class="linenos">98</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="WebLink-99"><a href="#WebLink-99"><span class="linenos">99</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Url(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>An external reference to URLs giving the bounding box and destination URL.
These links can be extracted by calling the
<code><a href="#Page.weblinks">modm_data.pdf.page.Page.weblinks</a></code> property.</p>
</div>


                            <div id="WebLink.__init__" class="classattr">
                                        <input id="WebLink.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">WebLink</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">page</span><span class="p">:</span> <span class="n"><a href="#Page">Page</a></span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="WebLink.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink.__init__-50"><a href="#WebLink.__init__-50"><span class="linenos">50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.Page&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="WebLink.__init__-51"><a href="#WebLink.__init__-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="WebLink.__init__-52"><a href="#WebLink.__init__-52"><span class="linenos">52</span></a><span class="sd">        :param page: Page containing the link, used to compute bounding box.</span>
</span><span id="WebLink.__init__-53"><a href="#WebLink.__init__-53"><span class="linenos">53</span></a><span class="sd">        :param index: 0-index of the weblink object.</span>
</span><span id="WebLink.__init__-54"><a href="#WebLink.__init__-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WebLink.__init__-55"><a href="#WebLink.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="WebLink.__init__-56"><a href="#WebLink.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_link</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">_linkpage</span>
</span><span id="WebLink.__init__-57"><a href="#WebLink.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>page</strong>:  Page containing the link, used to compute bounding box.</li>
<li><strong>index</strong>:  0-index of the weblink object.</li>
</ul>
</div>


                            </div>
                            <div id="WebLink.bbox_count" class="classattr">
                                        <input id="WebLink.bbox_count-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bbox_count</span><span class="annotation">: int</span>

                <label class="view-source-button" for="WebLink.bbox_count-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink.bbox_count"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink.bbox_count-59"><a href="#WebLink.bbox_count-59"><span class="linenos">59</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink.bbox_count-60"><a href="#WebLink.bbox_count-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">bbox_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="WebLink.bbox_count-61"><a href="#WebLink.bbox_count-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of bounding boxes associated with this weblink.&quot;&quot;&quot;</span>
</span><span id="WebLink.bbox_count-62"><a href="#WebLink.bbox_count-62"><span class="linenos">62</span></a>        <span class="k">return</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_CountRects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The number of bounding boxes associated with this weblink.</p>
</div>


                            </div>
                            <div id="WebLink.bboxes" class="classattr">
                                        <input id="WebLink.bboxes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bboxes</span><span class="annotation">: list[<a href="utils.html#Rectangle">modm_data.utils.Rectangle</a>]</span>

                <label class="view-source-button" for="WebLink.bboxes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink.bboxes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink.bboxes-64"><a href="#WebLink.bboxes-64"><span class="linenos">64</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink.bboxes-65"><a href="#WebLink.bboxes-65"><span class="linenos">65</span></a>    <span class="k">def</span> <span class="nf">bboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">]:</span>
</span><span id="WebLink.bboxes-66"><a href="#WebLink.bboxes-66"><span class="linenos">66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The bounding boxes associated with this weblink.&quot;&quot;&quot;</span>
</span><span id="WebLink.bboxes-67"><a href="#WebLink.bboxes-67"><span class="linenos">67</span></a>        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WebLink.bboxes-68"><a href="#WebLink.bboxes-68"><span class="linenos">68</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_count</span><span class="p">):</span>
</span><span id="WebLink.bboxes-69"><a href="#WebLink.bboxes-69"><span class="linenos">69</span></a>            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="WebLink.bboxes-70"><a href="#WebLink.bboxes-70"><span class="linenos">70</span></a>            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">()</span>
</span><span id="WebLink.bboxes-71"><a href="#WebLink.bboxes-71"><span class="linenos">71</span></a>            <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
</span><span id="WebLink.bboxes-72"><a href="#WebLink.bboxes-72"><span class="linenos">72</span></a>            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y1</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="WebLink.bboxes-73"><a href="#WebLink.bboxes-73"><span class="linenos">73</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">rotation</span><span class="p">:</span>
</span><span id="WebLink.bboxes-74"><a href="#WebLink.bboxes-74"><span class="linenos">74</span></a>            <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="WebLink.bboxes-75"><a href="#WebLink.bboxes-75"><span class="linenos">75</span></a>                <span class="n">Rectangle</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="WebLink.bboxes-76"><a href="#WebLink.bboxes-76"><span class="linenos">76</span></a>                <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span>
</span><span id="WebLink.bboxes-77"><a href="#WebLink.bboxes-77"><span class="linenos">77</span></a>            <span class="p">]</span>
</span><span id="WebLink.bboxes-78"><a href="#WebLink.bboxes-78"><span class="linenos">78</span></a>        <span class="k">return</span> <span class="n">bboxes</span>
</span></pre></div>


            <div class="docstring"><p>The bounding boxes associated with this weblink.</p>
</div>


                            </div>
                            <div id="WebLink.range" class="classattr">
                                        <input id="WebLink.range-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">range</span><span class="annotation">: tuple[int, int]</span>

                <label class="view-source-button" for="WebLink.range-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink.range"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink.range-80"><a href="#WebLink.range-80"><span class="linenos">80</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink.range-81"><a href="#WebLink.range-81"><span class="linenos">81</span></a>    <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="WebLink.range-82"><a href="#WebLink.range-82"><span class="linenos">82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start and end index of the characters associated with this link.&quot;&quot;&quot;</span>
</span><span id="WebLink.range-83"><a href="#WebLink.range-83"><span class="linenos">83</span></a>        <span class="n">cstart</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">()</span>
</span><span id="WebLink.range-84"><a href="#WebLink.range-84"><span class="linenos">84</span></a>        <span class="n">ccount</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">()</span>
</span><span id="WebLink.range-85"><a href="#WebLink.range-85"><span class="linenos">85</span></a>        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetTextRange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">cstart</span><span class="p">,</span> <span class="n">ccount</span><span class="p">)</span>
</span><span id="WebLink.range-86"><a href="#WebLink.range-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">cstart</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">cstart</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">ccount</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Start and end index of the characters associated with this link.</p>
</div>


                            </div>
                            <div id="WebLink.url" class="classattr">
                                        <input id="WebLink.url-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">url</span><span class="annotation">: str</span>

                <label class="view-source-button" for="WebLink.url-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WebLink.url"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WebLink.url-88"><a href="#WebLink.url-88"><span class="linenos">88</span></a>    <span class="nd">@cached_property</span>
</span><span id="WebLink.url-89"><a href="#WebLink.url-89"><span class="linenos">89</span></a>    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="WebLink.url-90"><a href="#WebLink.url-90"><span class="linenos">90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The URL string of this link.&quot;&quot;&quot;</span>
</span><span id="WebLink.url-91"><a href="#WebLink.url-91"><span class="linenos">91</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="WebLink.url-92"><a href="#WebLink.url-92"><span class="linenos">92</span></a>        <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ushort</span> <span class="o">*</span> <span class="n">length</span>
</span><span id="WebLink.url-93"><a href="#WebLink.url-93"><span class="linenos">93</span></a>        <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">cbuffer</span><span class="p">()</span>
</span><span id="WebLink.url-94"><a href="#WebLink.url-94"><span class="linenos">94</span></a>        <span class="n">retlen</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDFLink_GetURL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_link</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">cbuffer</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
</span><span id="WebLink.url-95"><a href="#WebLink.url-95"><span class="linenos">95</span></a>        <span class="k">assert</span> <span class="n">retlen</span> <span class="o">&lt;</span> <span class="n">length</span>
</span><span id="WebLink.url-96"><a href="#WebLink.url-96"><span class="linenos">96</span></a>        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">cbuffer</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The URL string of this link.</p>
</div>


                            </div>
                </section>
                <section id="Structure">
                            <input id="Structure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Structure</span>:

                <label class="view-source-button" for="Structure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure-11"><a href="#Structure-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">Structure</span><span class="p">:</span>
</span><span id="Structure-12"><a href="#Structure-12"><span class="linenos"> 12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Structure-13"><a href="#Structure-13"><span class="linenos"> 13</span></a><span class="sd">    A tagged PDF/UA (Universal Accessibility) contains the structure of content</span>
</span><span id="Structure-14"><a href="#Structure-14"><span class="linenos"> 14</span></a><span class="sd">    as a tree data structure with similar semantics to HTML. Sadly, the quality</span>
</span><span id="Structure-15"><a href="#Structure-15"><span class="linenos"> 15</span></a><span class="sd">    of the tags depends heavily on the PDF creation software. See</span>
</span><span id="Structure-16"><a href="#Structure-16"><span class="linenos"> 16</span></a><span class="sd">    [Overview of PDF tags](https://accessible-pdf.info/en/basics/general/overview-of-the-pdf-tags/).</span>
</span><span id="Structure-17"><a href="#Structure-17"><span class="linenos"> 17</span></a>
</span><span id="Structure-18"><a href="#Structure-18"><span class="linenos"> 18</span></a><span class="sd">    An example of an accessible pdf that can be inspected via these classes:</span>
</span><span id="Structure-19"><a href="#Structure-19"><span class="linenos"> 19</span></a><span class="sd">    [Rock On, D.C. Music Festival](https://commonlook.com/wp-content/uploads/2020/04/accessible-pdf-example.pdf).</span>
</span><span id="Structure-20"><a href="#Structure-20"><span class="linenos"> 20</span></a>
</span><span id="Structure-21"><a href="#Structure-21"><span class="linenos"> 21</span></a><span class="sd">    This class is a convenience wrapper around [the pdfium structtree methods](</span>
</span><span id="Structure-22"><a href="#Structure-22"><span class="linenos"> 22</span></a><span class="sd">    https://pdfium.googlesource.com/pdfium/+/main/public/fpdf_structtree.h).</span>
</span><span id="Structure-23"><a href="#Structure-23"><span class="linenos"> 23</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Structure-24"><a href="#Structure-24"><span class="linenos"> 24</span></a>
</span><span id="Structure-25"><a href="#Structure-25"><span class="linenos"> 25</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.page.Page&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_STRUCTELEMENT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Structure&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Structure-26"><a href="#Structure-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="Structure-27"><a href="#Structure-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span> <span class="o">=</span> <span class="n">element</span>
</span><span id="Structure-28"><a href="#Structure-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">Structure</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Structure-29"><a href="#Structure-29"><span class="linenos"> 29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The parent node.&quot;&quot;&quot;</span>
</span><span id="Structure-30"><a href="#Structure-30"><span class="linenos"> 30</span></a>
</span><span id="Structure-31"><a href="#Structure-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="nf">_get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-32"><a href="#Structure-32"><span class="linenos"> 32</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Structure-33"><a href="#Structure-33"><span class="linenos"> 33</span></a>        <span class="n">clength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulong</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="Structure-34"><a href="#Structure-34"><span class="linenos"> 34</span></a>        <span class="n">cbuffer</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</span><span id="Structure-35"><a href="#Structure-35"><span class="linenos"> 35</span></a>        <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">cbuffer</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure-36"><a href="#Structure-36"><span class="linenos"> 36</span></a>        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">cbuffer</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="Structure-37"><a href="#Structure-37"><span class="linenos"> 37</span></a>
</span><span id="Structure-38"><a href="#Structure-38"><span class="linenos"> 38</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-39"><a href="#Structure-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-40"><a href="#Structure-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Title `/T`&quot;&quot;&quot;</span>
</span><span id="Structure-41"><a href="#Structure-41"><span class="linenos"> 41</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetTitle</span><span class="p">)</span>
</span><span id="Structure-42"><a href="#Structure-42"><span class="linenos"> 42</span></a>
</span><span id="Structure-43"><a href="#Structure-43"><span class="linenos"> 43</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-44"><a href="#Structure-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="nf">actual_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-45"><a href="#Structure-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The actual text.&quot;&quot;&quot;</span>
</span><span id="Structure-46"><a href="#Structure-46"><span class="linenos"> 46</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetActualText</span><span class="p">)</span>
</span><span id="Structure-47"><a href="#Structure-47"><span class="linenos"> 47</span></a>
</span><span id="Structure-48"><a href="#Structure-48"><span class="linenos"> 48</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-49"><a href="#Structure-49"><span class="linenos"> 49</span></a>    <span class="k">def</span> <span class="nf">alt_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-50"><a href="#Structure-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alternate Text&quot;&quot;&quot;</span>
</span><span id="Structure-51"><a href="#Structure-51"><span class="linenos"> 51</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAltText</span><span class="p">)</span>
</span><span id="Structure-52"><a href="#Structure-52"><span class="linenos"> 52</span></a>
</span><span id="Structure-53"><a href="#Structure-53"><span class="linenos"> 53</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-54"><a href="#Structure-54"><span class="linenos"> 54</span></a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-55"><a href="#Structure-55"><span class="linenos"> 55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Type `/S`&quot;&quot;&quot;</span>
</span><span id="Structure-56"><a href="#Structure-56"><span class="linenos"> 56</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetType</span><span class="p">)</span>
</span><span id="Structure-57"><a href="#Structure-57"><span class="linenos"> 57</span></a>
</span><span id="Structure-58"><a href="#Structure-58"><span class="linenos"> 58</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-59"><a href="#Structure-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="nf">obj_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-60"><a href="#Structure-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Object Type `/Type`&quot;&quot;&quot;</span>
</span><span id="Structure-61"><a href="#Structure-61"><span class="linenos"> 61</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetObjType</span><span class="p">)</span>
</span><span id="Structure-62"><a href="#Structure-62"><span class="linenos"> 62</span></a>
</span><span id="Structure-63"><a href="#Structure-63"><span class="linenos"> 63</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-64"><a href="#Structure-64"><span class="linenos"> 64</span></a>    <span class="k">def</span> <span class="nf">language</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-65"><a href="#Structure-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The case-insensitive IETF BCP 47 language code.&quot;&quot;&quot;</span>
</span><span id="Structure-66"><a href="#Structure-66"><span class="linenos"> 66</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetLang</span><span class="p">)</span>
</span><span id="Structure-67"><a href="#Structure-67"><span class="linenos"> 67</span></a>
</span><span id="Structure-68"><a href="#Structure-68"><span class="linenos"> 68</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-69"><a href="#Structure-69"><span class="linenos"> 69</span></a>    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-70"><a href="#Structure-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identifier&quot;&quot;&quot;</span>
</span><span id="Structure-71"><a href="#Structure-71"><span class="linenos"> 71</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetID</span><span class="p">)</span>
</span><span id="Structure-72"><a href="#Structure-72"><span class="linenos"> 72</span></a>
</span><span id="Structure-73"><a href="#Structure-73"><span class="linenos"> 73</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-74"><a href="#Structure-74"><span class="linenos"> 74</span></a>    <span class="k">def</span> <span class="nf">marked_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Structure-75"><a href="#Structure-75"><span class="linenos"> 75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of marked content identifiers&quot;&quot;&quot;</span>
</span><span id="Structure-76"><a href="#Structure-76"><span class="linenos"> 76</span></a>        <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Structure-77"><a href="#Structure-77"><span class="linenos"> 77</span></a>        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetMarkedContentIdCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)):</span>
</span><span id="Structure-78"><a href="#Structure-78"><span class="linenos"> 78</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">mcid</span> <span class="o">:=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetMarkedContentIdAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Structure-79"><a href="#Structure-79"><span class="linenos"> 79</span></a>                <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mcid</span><span class="p">)</span>
</span><span id="Structure-80"><a href="#Structure-80"><span class="linenos"> 80</span></a>        <span class="k">return</span> <span class="n">ids</span>
</span><span id="Structure-81"><a href="#Structure-81"><span class="linenos"> 81</span></a>
</span><span id="Structure-82"><a href="#Structure-82"><span class="linenos"> 82</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure-83"><a href="#Structure-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="Structure-84"><a href="#Structure-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Structure-85"><a href="#Structure-85"><span class="linenos"> 85</span></a><span class="sd">        All attributes of this structure element as a dictionary.</span>
</span><span id="Structure-86"><a href="#Structure-86"><span class="linenos"> 86</span></a>
</span><span id="Structure-87"><a href="#Structure-87"><span class="linenos"> 87</span></a><span class="sd">        .. note::</span>
</span><span id="Structure-88"><a href="#Structure-88"><span class="linenos"> 88</span></a><span class="sd">            Due to limitations of the pdfium API, attribute arrays cannot be</span>
</span><span id="Structure-89"><a href="#Structure-89"><span class="linenos"> 89</span></a><span class="sd">            extracted! The values are marked as `[?]` in the dictionary.</span>
</span><span id="Structure-90"><a href="#Structure-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Structure-91"><a href="#Structure-91"><span class="linenos"> 91</span></a>        <span class="n">kv</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Structure-92"><a href="#Structure-92"><span class="linenos"> 92</span></a>        <span class="k">for</span> <span class="n">eindex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAttributeCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)):</span>
</span><span id="Structure-93"><a href="#Structure-93"><span class="linenos"> 93</span></a>            <span class="n">attr</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAttributeAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">eindex</span><span class="p">)</span>
</span><span id="Structure-94"><a href="#Structure-94"><span class="linenos"> 94</span></a>            <span class="k">for</span> <span class="n">aindex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetCount</span><span class="p">(</span><span class="n">attr</span><span class="p">)):</span>
</span><span id="Structure-95"><a href="#Structure-95"><span class="linenos"> 95</span></a>                <span class="c1"># Get the name</span>
</span><span id="Structure-96"><a href="#Structure-96"><span class="linenos"> 96</span></a>                <span class="n">clength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Structure-97"><a href="#Structure-97"><span class="linenos"> 97</span></a>                <span class="n">cname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># workaround to get length</span>
</span><span id="Structure-98"><a href="#Structure-98"><span class="linenos"> 98</span></a>                <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetName</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">aindex</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure-99"><a href="#Structure-99"><span class="linenos"> 99</span></a>                <span class="n">cname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">clength</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Structure-100"><a href="#Structure-100"><span class="linenos">100</span></a>                <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetName</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">aindex</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">clength</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure-101"><a href="#Structure-101"><span class="linenos">101</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">cname</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="Structure-102"><a href="#Structure-102"><span class="linenos">102</span></a>
</span><span id="Structure-103"><a href="#Structure-103"><span class="linenos">103</span></a>                <span class="c1"># Get the type</span>
</span><span id="Structure-104"><a href="#Structure-104"><span class="linenos">104</span></a>                <span class="n">atype</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetType</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">)</span>
</span><span id="Structure-105"><a href="#Structure-105"><span class="linenos">105</span></a>                <span class="k">assert</span> <span class="n">atype</span> <span class="o">!=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_UNKNOWN</span>
</span><span id="Structure-106"><a href="#Structure-106"><span class="linenos">106</span></a>
</span><span id="Structure-107"><a href="#Structure-107"><span class="linenos">107</span></a>                <span class="c1"># Then get each type individually</span>
</span><span id="Structure-108"><a href="#Structure-108"><span class="linenos">108</span></a>                <span class="k">match</span> <span class="n">atype</span><span class="p">:</span>
</span><span id="Structure-109"><a href="#Structure-109"><span class="linenos">109</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_BOOLEAN</span><span class="p">:</span>
</span><span id="Structure-110"><a href="#Structure-110"><span class="linenos">110</span></a>                        <span class="n">cbool</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
</span><span id="Structure-111"><a href="#Structure-111"><span class="linenos">111</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetBooleanValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cbool</span><span class="p">)</span>
</span><span id="Structure-112"><a href="#Structure-112"><span class="linenos">112</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbool</span><span class="o">.</span><span class="n">value</span>
</span><span id="Structure-113"><a href="#Structure-113"><span class="linenos">113</span></a>
</span><span id="Structure-114"><a href="#Structure-114"><span class="linenos">114</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_NUMBER</span><span class="p">:</span>
</span><span id="Structure-115"><a href="#Structure-115"><span class="linenos">115</span></a>                        <span class="n">cfloat</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Structure-116"><a href="#Structure-116"><span class="linenos">116</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetNumberValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cfloat</span><span class="p">)</span>
</span><span id="Structure-117"><a href="#Structure-117"><span class="linenos">117</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfloat</span><span class="o">.</span><span class="n">value</span>
</span><span id="Structure-118"><a href="#Structure-118"><span class="linenos">118</span></a>
</span><span id="Structure-119"><a href="#Structure-119"><span class="linenos">119</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_STRING</span> <span class="o">|</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_NAME</span><span class="p">:</span>
</span><span id="Structure-120"><a href="#Structure-120"><span class="linenos">120</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetStringValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure-121"><a href="#Structure-121"><span class="linenos">121</span></a>                        <span class="n">cattrname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Structure-122"><a href="#Structure-122"><span class="linenos">122</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetStringValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cattrname</span><span class="p">,</span> <span class="n">clength</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure-123"><a href="#Structure-123"><span class="linenos">123</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cattrname</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)[:</span> <span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Structure-124"><a href="#Structure-124"><span class="linenos">124</span></a>
</span><span id="Structure-125"><a href="#Structure-125"><span class="linenos">125</span></a>                    <span class="c1"># FIXME: FPDF_OBJECT_ARRAY is not a blob, but no other APIs are exposed?</span>
</span><span id="Structure-126"><a href="#Structure-126"><span class="linenos">126</span></a>                    <span class="c1"># case pp.raw.FPDF_OBJECT_ARRAY:</span>
</span><span id="Structure-127"><a href="#Structure-127"><span class="linenos">127</span></a>                    <span class="c1">#     assert pp.raw.FPDF_StructElement_Attr_GetBlobValue(attr, cname, 0, 0, clength)</span>
</span><span id="Structure-128"><a href="#Structure-128"><span class="linenos">128</span></a>                    <span class="c1">#     cblob = ctypes.create_string_buffer(clength.value)</span>
</span><span id="Structure-129"><a href="#Structure-129"><span class="linenos">129</span></a>                    <span class="c1">#     assert pp.raw.FPDF_StructElement_Attr_GetBlobValue(attr, cname, cblob, clength, clength)</span>
</span><span id="Structure-130"><a href="#Structure-130"><span class="linenos">130</span></a>                    <span class="c1">#     kv[name] = cblob.raw</span>
</span><span id="Structure-131"><a href="#Structure-131"><span class="linenos">131</span></a>
</span><span id="Structure-132"><a href="#Structure-132"><span class="linenos">132</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_ARRAY</span><span class="p">:</span>
</span><span id="Structure-133"><a href="#Structure-133"><span class="linenos">133</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;[?]&quot;</span>
</span><span id="Structure-134"><a href="#Structure-134"><span class="linenos">134</span></a>
</span><span id="Structure-135"><a href="#Structure-135"><span class="linenos">135</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="Structure-136"><a href="#Structure-136"><span class="linenos">136</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[unknown=</span><span class="si">{</span><span class="n">atype</span><span class="si">}</span><span class="s2">?]&quot;</span>
</span><span id="Structure-137"><a href="#Structure-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">kv</span>
</span><span id="Structure-138"><a href="#Structure-138"><span class="linenos">138</span></a>
</span><span id="Structure-139"><a href="#Structure-139"><span class="linenos">139</span></a>    <span class="nd">@cache</span>
</span><span id="Structure-140"><a href="#Structure-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
</span><span id="Structure-141"><a href="#Structure-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Structure-142"><a href="#Structure-142"><span class="linenos">142</span></a><span class="sd">        :param index: 0-index of child.</span>
</span><span id="Structure-143"><a href="#Structure-143"><span class="linenos">143</span></a><span class="sd">        :return: Child structure.</span>
</span><span id="Structure-144"><a href="#Structure-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Structure-145"><a href="#Structure-145"><span class="linenos">145</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetChildAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="Structure-146"><a href="#Structure-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Structure-147"><a href="#Structure-147"><span class="linenos">147</span></a>
</span><span id="Structure-148"><a href="#Structure-148"><span class="linenos">148</span></a>    <span class="nd">@property</span>
</span><span id="Structure-149"><a href="#Structure-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="Structure-150"><a href="#Structure-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All child structures.&quot;&quot;&quot;</span>
</span><span id="Structure-151"><a href="#Structure-151"><span class="linenos">151</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_CountChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)</span>
</span><span id="Structure-152"><a href="#Structure-152"><span class="linenos">152</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span id="Structure-153"><a href="#Structure-153"><span class="linenos">153</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span><span id="Structure-154"><a href="#Structure-154"><span class="linenos">154</span></a>
</span><span id="Structure-155"><a href="#Structure-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">descr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-156"><a href="#Structure-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Description including all children via indentation.&quot;&quot;&quot;</span>
</span><span id="Structure-157"><a href="#Structure-157"><span class="linenos">157</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Structure-158"><a href="#Structure-158"><span class="linenos">158</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
</span><span id="Structure-159"><a href="#Structure-159"><span class="linenos">159</span></a>            <span class="n">string</span> <span class="o">+=</span> <span class="n">child</span><span class="o">.</span><span class="n">descr</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="Structure-160"><a href="#Structure-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">string</span>
</span><span id="Structure-161"><a href="#Structure-161"><span class="linenos">161</span></a>
</span><span id="Structure-162"><a href="#Structure-162"><span class="linenos">162</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure-163"><a href="#Structure-163"><span class="linenos">163</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Structure-164"><a href="#Structure-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
</span><span id="Structure-165"><a href="#Structure-165"><span class="linenos">165</span></a>            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Structure-166"><a href="#Structure-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">:</span>
</span><span id="Structure-167"><a href="#Structure-167"><span class="linenos">167</span></a>            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;title=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Structure-168"><a href="#Structure-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_text</span><span class="p">:</span>
</span><span id="Structure-169"><a href="#Structure-169"><span class="linenos">169</span></a>            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;act_text=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Structure-170"><a href="#Structure-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alt_text</span><span class="p">:</span>
</span><span id="Structure-171"><a href="#Structure-171"><span class="linenos">171</span></a>            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alt_text=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alt_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Structure-172"><a href="#Structure-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
</span><span id="Structure-173"><a href="#Structure-173"><span class="linenos">173</span></a>            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Structure-174"><a href="#Structure-174"><span class="linenos">174</span></a>        <span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mid=</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">marked_ids</span><span class="p">]</span>
</span><span id="Structure-175"><a href="#Structure-175"><span class="linenos">175</span></a>        <span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</span><span id="Structure-176"><a href="#Structure-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;S(</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>A tagged PDF/UA (Universal Accessibility) contains the structure of content
as a tree data structure with similar semantics to HTML. Sadly, the quality
of the tags depends heavily on the PDF creation software. See
<a href="https://accessible-pdf.info/en/basics/general/overview-of-the-pdf-tags/">Overview of PDF tags</a>.</p>

<p>An example of an accessible pdf that can be inspected via these classes:
<a href="https://commonlook.com/wp-content/uploads/2020/04/accessible-pdf-example.pdf">Rock On, D.C. Music Festival</a>.</p>

<p>This class is a convenience wrapper around <a href="https://pdfium.googlesource.com/pdfium/+/main/public/fpdf_structtree.h">the pdfium structtree methods</a>.</p>
</div>


                            <div id="Structure.__init__" class="classattr">
                                        <input id="Structure.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Structure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">page</span><span class="p">:</span> <span class="n"><a href="#Page">Page</a></span>,</span><span class="param">	<span class="n">element</span><span class="p">:</span> <span class="n">pypdfium2_raw</span><span class="o">.</span><span class="n">bindings</span><span class="o">.</span><span class="n">LP_struct_fpdf_structelement_t__</span>,</span><span class="param">	<span class="n">parent</span><span class="p">:</span> <span class="n"><a href="#Structure">Structure</a></span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Structure.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.__init__-25"><a href="#Structure.__init__-25"><span class="linenos">25</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="s2">&quot;modm_data.pdf.page.Page&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_STRUCTELEMENT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;Structure&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># noqa: F821</span>
</span><span id="Structure.__init__-26"><a href="#Structure.__init__-26"><span class="linenos">26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_page</span> <span class="o">=</span> <span class="n">page</span>
</span><span id="Structure.__init__-27"><a href="#Structure.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span> <span class="o">=</span> <span class="n">element</span>
</span><span id="Structure.__init__-28"><a href="#Structure.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">Structure</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Structure.__init__-29"><a href="#Structure.__init__-29"><span class="linenos">29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The parent node.&quot;&quot;&quot;</span>
</span></pre></div>


    

                            </div>
                            <div id="Structure.parent" class="classattr">
                                <div class="attr variable">
            <span class="name">parent</span><span class="annotation">: <a href="#Structure">Structure</a></span>

        
    </div>
    <a class="headerlink" href="#Structure.parent"></a>
    
            <div class="docstring"><p>The parent node.</p>
</div>


                            </div>
                            <div id="Structure.title" class="classattr">
                                        <input id="Structure.title-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">title</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.title-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.title"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.title-38"><a href="#Structure.title-38"><span class="linenos">38</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.title-39"><a href="#Structure.title-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.title-40"><a href="#Structure.title-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Title `/T`&quot;&quot;&quot;</span>
</span><span id="Structure.title-41"><a href="#Structure.title-41"><span class="linenos">41</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetTitle</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Title <code>/T</code></p>
</div>


                            </div>
                            <div id="Structure.actual_text" class="classattr">
                                        <input id="Structure.actual_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">actual_text</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.actual_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.actual_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.actual_text-43"><a href="#Structure.actual_text-43"><span class="linenos">43</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.actual_text-44"><a href="#Structure.actual_text-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="nf">actual_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.actual_text-45"><a href="#Structure.actual_text-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The actual text.&quot;&quot;&quot;</span>
</span><span id="Structure.actual_text-46"><a href="#Structure.actual_text-46"><span class="linenos">46</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetActualText</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The actual text.</p>
</div>


                            </div>
                            <div id="Structure.alt_text" class="classattr">
                                        <input id="Structure.alt_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">alt_text</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.alt_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.alt_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.alt_text-48"><a href="#Structure.alt_text-48"><span class="linenos">48</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.alt_text-49"><a href="#Structure.alt_text-49"><span class="linenos">49</span></a>    <span class="k">def</span> <span class="nf">alt_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.alt_text-50"><a href="#Structure.alt_text-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alternate Text&quot;&quot;&quot;</span>
</span><span id="Structure.alt_text-51"><a href="#Structure.alt_text-51"><span class="linenos">51</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAltText</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Alternate Text</p>
</div>


                            </div>
                            <div id="Structure.type" class="classattr">
                                        <input id="Structure.type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">type</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.type-53"><a href="#Structure.type-53"><span class="linenos">53</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.type-54"><a href="#Structure.type-54"><span class="linenos">54</span></a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.type-55"><a href="#Structure.type-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Type `/S`&quot;&quot;&quot;</span>
</span><span id="Structure.type-56"><a href="#Structure.type-56"><span class="linenos">56</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetType</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Type <code>/S</code></p>
</div>


                            </div>
                            <div id="Structure.obj_type" class="classattr">
                                        <input id="Structure.obj_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">obj_type</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.obj_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.obj_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.obj_type-58"><a href="#Structure.obj_type-58"><span class="linenos">58</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.obj_type-59"><a href="#Structure.obj_type-59"><span class="linenos">59</span></a>    <span class="k">def</span> <span class="nf">obj_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.obj_type-60"><a href="#Structure.obj_type-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Object Type `/Type`&quot;&quot;&quot;</span>
</span><span id="Structure.obj_type-61"><a href="#Structure.obj_type-61"><span class="linenos">61</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetObjType</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Object Type <code>/Type</code></p>
</div>


                            </div>
                            <div id="Structure.language" class="classattr">
                                        <input id="Structure.language-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">language</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.language-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.language"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.language-63"><a href="#Structure.language-63"><span class="linenos">63</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.language-64"><a href="#Structure.language-64"><span class="linenos">64</span></a>    <span class="k">def</span> <span class="nf">language</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.language-65"><a href="#Structure.language-65"><span class="linenos">65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The case-insensitive IETF BCP 47 language code.&quot;&quot;&quot;</span>
</span><span id="Structure.language-66"><a href="#Structure.language-66"><span class="linenos">66</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetLang</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The case-insensitive IETF BCP 47 language code.</p>
</div>


                            </div>
                            <div id="Structure.id" class="classattr">
                                        <input id="Structure.id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">id</span><span class="annotation">: str</span>

                <label class="view-source-button" for="Structure.id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.id-68"><a href="#Structure.id-68"><span class="linenos">68</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.id-69"><a href="#Structure.id-69"><span class="linenos">69</span></a>    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.id-70"><a href="#Structure.id-70"><span class="linenos">70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identifier&quot;&quot;&quot;</span>
</span><span id="Structure.id-71"><a href="#Structure.id-71"><span class="linenos">71</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetID</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Identifier</p>
</div>


                            </div>
                            <div id="Structure.marked_ids" class="classattr">
                                        <input id="Structure.marked_ids-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">marked_ids</span><span class="annotation">: list[int]</span>

                <label class="view-source-button" for="Structure.marked_ids-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.marked_ids"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.marked_ids-73"><a href="#Structure.marked_ids-73"><span class="linenos">73</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.marked_ids-74"><a href="#Structure.marked_ids-74"><span class="linenos">74</span></a>    <span class="k">def</span> <span class="nf">marked_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Structure.marked_ids-75"><a href="#Structure.marked_ids-75"><span class="linenos">75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of marked content identifiers&quot;&quot;&quot;</span>
</span><span id="Structure.marked_ids-76"><a href="#Structure.marked_ids-76"><span class="linenos">76</span></a>        <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Structure.marked_ids-77"><a href="#Structure.marked_ids-77"><span class="linenos">77</span></a>        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetMarkedContentIdCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)):</span>
</span><span id="Structure.marked_ids-78"><a href="#Structure.marked_ids-78"><span class="linenos">78</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">mcid</span> <span class="o">:=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetMarkedContentIdAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Structure.marked_ids-79"><a href="#Structure.marked_ids-79"><span class="linenos">79</span></a>                <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mcid</span><span class="p">)</span>
</span><span id="Structure.marked_ids-80"><a href="#Structure.marked_ids-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="n">ids</span>
</span></pre></div>


            <div class="docstring"><p>List of marked content identifiers</p>
</div>


                            </div>
                            <div id="Structure.attributes" class="classattr">
                                        <input id="Structure.attributes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">attributes</span><span class="annotation">: dict[str, str | bool | float]</span>

                <label class="view-source-button" for="Structure.attributes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.attributes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.attributes-82"><a href="#Structure.attributes-82"><span class="linenos"> 82</span></a>    <span class="nd">@cached_property</span>
</span><span id="Structure.attributes-83"><a href="#Structure.attributes-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="Structure.attributes-84"><a href="#Structure.attributes-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Structure.attributes-85"><a href="#Structure.attributes-85"><span class="linenos"> 85</span></a><span class="sd">        All attributes of this structure element as a dictionary.</span>
</span><span id="Structure.attributes-86"><a href="#Structure.attributes-86"><span class="linenos"> 86</span></a>
</span><span id="Structure.attributes-87"><a href="#Structure.attributes-87"><span class="linenos"> 87</span></a><span class="sd">        .. note::</span>
</span><span id="Structure.attributes-88"><a href="#Structure.attributes-88"><span class="linenos"> 88</span></a><span class="sd">            Due to limitations of the pdfium API, attribute arrays cannot be</span>
</span><span id="Structure.attributes-89"><a href="#Structure.attributes-89"><span class="linenos"> 89</span></a><span class="sd">            extracted! The values are marked as `[?]` in the dictionary.</span>
</span><span id="Structure.attributes-90"><a href="#Structure.attributes-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Structure.attributes-91"><a href="#Structure.attributes-91"><span class="linenos"> 91</span></a>        <span class="n">kv</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Structure.attributes-92"><a href="#Structure.attributes-92"><span class="linenos"> 92</span></a>        <span class="k">for</span> <span class="n">eindex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAttributeCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)):</span>
</span><span id="Structure.attributes-93"><a href="#Structure.attributes-93"><span class="linenos"> 93</span></a>            <span class="n">attr</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetAttributeAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">eindex</span><span class="p">)</span>
</span><span id="Structure.attributes-94"><a href="#Structure.attributes-94"><span class="linenos"> 94</span></a>            <span class="k">for</span> <span class="n">aindex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetCount</span><span class="p">(</span><span class="n">attr</span><span class="p">)):</span>
</span><span id="Structure.attributes-95"><a href="#Structure.attributes-95"><span class="linenos"> 95</span></a>                <span class="c1"># Get the name</span>
</span><span id="Structure.attributes-96"><a href="#Structure.attributes-96"><span class="linenos"> 96</span></a>                <span class="n">clength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Structure.attributes-97"><a href="#Structure.attributes-97"><span class="linenos"> 97</span></a>                <span class="n">cname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># workaround to get length</span>
</span><span id="Structure.attributes-98"><a href="#Structure.attributes-98"><span class="linenos"> 98</span></a>                <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetName</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">aindex</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure.attributes-99"><a href="#Structure.attributes-99"><span class="linenos"> 99</span></a>                <span class="n">cname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">clength</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="Structure.attributes-100"><a href="#Structure.attributes-100"><span class="linenos">100</span></a>                <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetName</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">aindex</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">clength</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure.attributes-101"><a href="#Structure.attributes-101"><span class="linenos">101</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">cname</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="Structure.attributes-102"><a href="#Structure.attributes-102"><span class="linenos">102</span></a>
</span><span id="Structure.attributes-103"><a href="#Structure.attributes-103"><span class="linenos">103</span></a>                <span class="c1"># Get the type</span>
</span><span id="Structure.attributes-104"><a href="#Structure.attributes-104"><span class="linenos">104</span></a>                <span class="n">atype</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetType</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">)</span>
</span><span id="Structure.attributes-105"><a href="#Structure.attributes-105"><span class="linenos">105</span></a>                <span class="k">assert</span> <span class="n">atype</span> <span class="o">!=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_UNKNOWN</span>
</span><span id="Structure.attributes-106"><a href="#Structure.attributes-106"><span class="linenos">106</span></a>
</span><span id="Structure.attributes-107"><a href="#Structure.attributes-107"><span class="linenos">107</span></a>                <span class="c1"># Then get each type individually</span>
</span><span id="Structure.attributes-108"><a href="#Structure.attributes-108"><span class="linenos">108</span></a>                <span class="k">match</span> <span class="n">atype</span><span class="p">:</span>
</span><span id="Structure.attributes-109"><a href="#Structure.attributes-109"><span class="linenos">109</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_BOOLEAN</span><span class="p">:</span>
</span><span id="Structure.attributes-110"><a href="#Structure.attributes-110"><span class="linenos">110</span></a>                        <span class="n">cbool</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
</span><span id="Structure.attributes-111"><a href="#Structure.attributes-111"><span class="linenos">111</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetBooleanValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cbool</span><span class="p">)</span>
</span><span id="Structure.attributes-112"><a href="#Structure.attributes-112"><span class="linenos">112</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbool</span><span class="o">.</span><span class="n">value</span>
</span><span id="Structure.attributes-113"><a href="#Structure.attributes-113"><span class="linenos">113</span></a>
</span><span id="Structure.attributes-114"><a href="#Structure.attributes-114"><span class="linenos">114</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_NUMBER</span><span class="p">:</span>
</span><span id="Structure.attributes-115"><a href="#Structure.attributes-115"><span class="linenos">115</span></a>                        <span class="n">cfloat</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">()</span>
</span><span id="Structure.attributes-116"><a href="#Structure.attributes-116"><span class="linenos">116</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetNumberValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cfloat</span><span class="p">)</span>
</span><span id="Structure.attributes-117"><a href="#Structure.attributes-117"><span class="linenos">117</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfloat</span><span class="o">.</span><span class="n">value</span>
</span><span id="Structure.attributes-118"><a href="#Structure.attributes-118"><span class="linenos">118</span></a>
</span><span id="Structure.attributes-119"><a href="#Structure.attributes-119"><span class="linenos">119</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_STRING</span> <span class="o">|</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_NAME</span><span class="p">:</span>
</span><span id="Structure.attributes-120"><a href="#Structure.attributes-120"><span class="linenos">120</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetStringValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure.attributes-121"><a href="#Structure.attributes-121"><span class="linenos">121</span></a>                        <span class="n">cattrname</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Structure.attributes-122"><a href="#Structure.attributes-122"><span class="linenos">122</span></a>                        <span class="k">assert</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_Attr_GetStringValue</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cattrname</span><span class="p">,</span> <span class="n">clength</span><span class="p">,</span> <span class="n">clength</span><span class="p">)</span>
</span><span id="Structure.attributes-123"><a href="#Structure.attributes-123"><span class="linenos">123</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cattrname</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)[:</span> <span class="n">clength</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Structure.attributes-124"><a href="#Structure.attributes-124"><span class="linenos">124</span></a>
</span><span id="Structure.attributes-125"><a href="#Structure.attributes-125"><span class="linenos">125</span></a>                    <span class="c1"># FIXME: FPDF_OBJECT_ARRAY is not a blob, but no other APIs are exposed?</span>
</span><span id="Structure.attributes-126"><a href="#Structure.attributes-126"><span class="linenos">126</span></a>                    <span class="c1"># case pp.raw.FPDF_OBJECT_ARRAY:</span>
</span><span id="Structure.attributes-127"><a href="#Structure.attributes-127"><span class="linenos">127</span></a>                    <span class="c1">#     assert pp.raw.FPDF_StructElement_Attr_GetBlobValue(attr, cname, 0, 0, clength)</span>
</span><span id="Structure.attributes-128"><a href="#Structure.attributes-128"><span class="linenos">128</span></a>                    <span class="c1">#     cblob = ctypes.create_string_buffer(clength.value)</span>
</span><span id="Structure.attributes-129"><a href="#Structure.attributes-129"><span class="linenos">129</span></a>                    <span class="c1">#     assert pp.raw.FPDF_StructElement_Attr_GetBlobValue(attr, cname, cblob, clength, clength)</span>
</span><span id="Structure.attributes-130"><a href="#Structure.attributes-130"><span class="linenos">130</span></a>                    <span class="c1">#     kv[name] = cblob.raw</span>
</span><span id="Structure.attributes-131"><a href="#Structure.attributes-131"><span class="linenos">131</span></a>
</span><span id="Structure.attributes-132"><a href="#Structure.attributes-132"><span class="linenos">132</span></a>                    <span class="k">case</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_OBJECT_ARRAY</span><span class="p">:</span>
</span><span id="Structure.attributes-133"><a href="#Structure.attributes-133"><span class="linenos">133</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;[?]&quot;</span>
</span><span id="Structure.attributes-134"><a href="#Structure.attributes-134"><span class="linenos">134</span></a>
</span><span id="Structure.attributes-135"><a href="#Structure.attributes-135"><span class="linenos">135</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="Structure.attributes-136"><a href="#Structure.attributes-136"><span class="linenos">136</span></a>                        <span class="n">kv</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[unknown=</span><span class="si">{</span><span class="n">atype</span><span class="si">}</span><span class="s2">?]&quot;</span>
</span><span id="Structure.attributes-137"><a href="#Structure.attributes-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="n">kv</span>
</span></pre></div>


            <div class="docstring"><p>All attributes of this structure element as a dictionary.</p>

<div class="alert note">

<p>Due to limitations of the pdfium API, attribute arrays cannot be
extracted! The values are marked as <code>[?]</code> in the dictionary.</p>

</div>
</div>


                            </div>
                            <div id="Structure.child" class="classattr">
                                        <input id="Structure.child-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cache</div>

        <span class="def">def</span>
        <span class="name">child</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Structure">Structure</a></span>:</span></span>

                <label class="view-source-button" for="Structure.child-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.child"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.child-139"><a href="#Structure.child-139"><span class="linenos">139</span></a>    <span class="nd">@cache</span>
</span><span id="Structure.child-140"><a href="#Structure.child-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
</span><span id="Structure.child-141"><a href="#Structure.child-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Structure.child-142"><a href="#Structure.child-142"><span class="linenos">142</span></a><span class="sd">        :param index: 0-index of child.</span>
</span><span id="Structure.child-143"><a href="#Structure.child-143"><span class="linenos">143</span></a><span class="sd">        :return: Child structure.</span>
</span><span id="Structure.child-144"><a href="#Structure.child-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Structure.child-145"><a href="#Structure.child-145"><span class="linenos">145</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_GetChildAtIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="Structure.child-146"><a href="#Structure.child-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>index</strong>:  0-index of child.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Child structure.</p>
</blockquote>
</div>


                            </div>
                            <div id="Structure.children" class="classattr">
                                        <input id="Structure.children-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">children</span><span class="annotation">: list</span>

                <label class="view-source-button" for="Structure.children-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.children"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.children-148"><a href="#Structure.children-148"><span class="linenos">148</span></a>    <span class="nd">@property</span>
</span><span id="Structure.children-149"><a href="#Structure.children-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="Structure.children-150"><a href="#Structure.children-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All child structures.&quot;&quot;&quot;</span>
</span><span id="Structure.children-151"><a href="#Structure.children-151"><span class="linenos">151</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">FPDF_StructElement_CountChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_element</span><span class="p">)</span>
</span><span id="Structure.children-152"><a href="#Structure.children-152"><span class="linenos">152</span></a>        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span><span id="Structure.children-153"><a href="#Structure.children-153"><span class="linenos">153</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>All child structures.</p>
</div>


                            </div>
                            <div id="Structure.descr" class="classattr">
                                        <input id="Structure.descr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">descr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">indent</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Structure.descr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Structure.descr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Structure.descr-155"><a href="#Structure.descr-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">descr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Structure.descr-156"><a href="#Structure.descr-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Description including all children via indentation.&quot;&quot;&quot;</span>
</span><span id="Structure.descr-157"><a href="#Structure.descr-157"><span class="linenos">157</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Structure.descr-158"><a href="#Structure.descr-158"><span class="linenos">158</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
</span><span id="Structure.descr-159"><a href="#Structure.descr-159"><span class="linenos">159</span></a>            <span class="n">string</span> <span class="o">+=</span> <span class="n">child</span><span class="o">.</span><span class="n">descr</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="Structure.descr-160"><a href="#Structure.descr-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">string</span>
</span></pre></div>


            <div class="docstring"><p>Description including all children via indentation.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>